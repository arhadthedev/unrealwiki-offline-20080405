<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- headlinks removed -->
	<link rel="shortcut icon" href="../../../../misc/uewiki-favicon.png"/>
    <title>Legacy:Setting Up VCPlusPlus/The CPP File - Unreal Wiki</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../../skins/offline/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/md5.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/utf8.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/lookup.js"></script>
    <script type="text/javascript" src="../../../../articles/-/_/_/-.html"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../../articles/c/o/m/MediaWiki%7ECommon.css_d42e.html";
@import "../../../../articles/m/o/n/MediaWiki%7EMonobook.css_fb19.html";
@import "../../../../articles/-/_/_/-.html";
/*]]>*/</style>          </head>
  <body
    class="ns-100">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Legacy:Setting Up VCPlusPlus/The CPP File</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</h3>
	    <div id="contentSub"><span class="subpages">&lt; <a href="../../../../articles/s/e/t/Legacy%7ESetting_Up_VCPlusPlus_c515.html" title="Legacy:Setting Up VCPlusPlus">Legacy:Setting Up VCPlusPlus</a></span></div>
	    	    	    <!-- start content -->
	    <p>In your C file, include the following:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
# both from the unreal public sources
<span class="kw2">#include</span> <span class="st0">"core.h"</span>
<span class="kw2">#include</span> <span class="st0">"engine.h"</span>
 
# the include that was generated by ucc
<span class="kw2">#include</span> <span class="st0">"$UNREALDIR<span class="es0">\S</span>QLite<span class="es0">\I</span>nc<span class="es0">\S</span>QLiteClasses.h"</span>
</pre></div>
<p>Strangely enough, the macro IMPLEMENT_PACKAGE doesn't do what it's supposed to do. Instead, add the following line next: (replacing HCSQLIB with the name of your package)</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
extern <span class="st0">"C"</span> DLL_EXPORT TCHAR GPackage<span class="br0">[</span><span class="br0">]</span>;
DLL_EXPORT TCHAR GPackage<span class="br0">[</span><span class="br0">]</span> = TEXT<span class="br0">(</span><span class="st0">"HCSQLIB"</span><span class="br0">)</span>;
</pre></div>
<p>Then, tell unreal which class(es) this file is implementing. Use</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
IMPLEMENT_CLASS<span class="br0">(</span>ASQLITEFile<span class="br0">)</span>;
</pre></div>
<p>Third, tell unreal which functions you're implementing:</p>
<p>Replace PACKAGE with the name of your package, ID with a UNIQUE number for static functions, or -1 for non-static functions. FUNCTION is the name of your function, prefixed with <b>exec</b>.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
IMPLEMENT_FUNCTION<span class="br0">(</span>PACKAGE, ID, <span class="kw5">FUNCTION</span><span class="br0">)</span>;
</pre></div>
<p>Next, since you didn't use IMPLEMENT_PACKAGE (which doesn't work), you'll have to define your own DLL entry point yourself.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw4">BOOL</span> __stdcall DllMain<span class="br0">(</span>HINSTANCE hInInstance, DWORD dwCallType, LPVOID lpPretendIDontExist<span class="br0">)</span>
<span class="br0">{</span>
  <span class="kw1">if</span><span class="br0">(</span>dwCallType == DLL_PROCESS_ATTACH<span class="br0">)</span>
  <span class="br0">{</span>
    <span class="co1">// initialize your dll</span>
    hInstance = hInInstance;
  <span class="br0">}</span>
  <span class="kw1">else</span> <span class="kw1">if</span><span class="br0">(</span>dwCallType == DLL_PROCESS_DETACH<span class="br0">)</span>
  <span class="br0">{</span>
    <span class="co1">// do some cleanup</span>
  <span class="br0">}</span>
  <span class="kw1">return</span> <span class="kw9">TRUE</span>;
</pre></div>
<p>Finally, your function:</p>
<p>Note that the parameters are the same for all functions, no matter what parameters are defined in the corresponding .uc file. See the native coding reference for more information about how to obtain parameters. Also note that the variables <b>s1</b>, <b>i1</b> and <b>i2</b> are defined by the macros P_GET_STR and P_GET_INT automatically. The <i>guard</i> and <i>unguardexec</i> macros actually create a try..catch block.</p>
<p>This function takes a string and two integers as parameters and returns the product of the two integers.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
void
MyPackage::<span class="me2">execTest</span><span class="br0">(</span>FFrame&amp; Stack, RESULT_DECL<span class="br0">)</span>
<span class="br0">{</span>
  guard<span class="br0">(</span>MyPackage::<span class="me2">execTest</span><span class="br0">)</span>;
  P_GET_STR<span class="br0">(</span>s1<span class="br0">)</span>;
  P_GET_INT<span class="br0">(</span>i1<span class="br0">)</span>;
  P_GET_INT<span class="br0">(</span>i2<span class="br0">)</span>;
  P_FINISH;
 
  <span class="br0">(</span>*<span class="br0">(</span>DWORD*<span class="br0">)</span>Result<span class="br0">)</span> = i1 * i2;
 
  unguardexec;
 
 
<span class="br0">}</span>
</pre></div>
<p>The according unrealscript function would look like this:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw6">native</span> <span class="kw5">function</span> <span class="kw4">int</span> Test<span class="br0">(</span><span class="kw4">string</span> sStringThatIsIgnored, <span class="kw4">int</span> iFactor1, <span class="kw4">int</span> iFactor2<span class="br0">)</span>;
</pre></div>

<!-- 
NewPP limit report
Preprocessor node count: 22/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
#ifexist count: 0/100
-->
<div class="printfooter">
</div>
	    	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-legacy"
	       class="selected"	       ><a href="../../../../articles/s/e/t/Legacy%7ESetting_Up_VCPlusPlus_The_CPP_File_b276.html">Legacy</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../../articles/s/e/t/Legacy_talk%7ESetting_Up_VCPlusPlus_The_CPP_File_c2ca.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://wiki.beyondunreal.com/Legacy:Setting_Up_VCPlusPlus/The_CPP_File">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../../misc/uewiki.png);"
	    href="../../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-mainpage"><a href="../../../../index.html">Main Page</a></li>
	     	      <li id="n-portal"><a href="../../../../articles/c/o/m/Unreal_Wiki%7ECommunity_Portal_3311.html">Community portal</a></li>
	     	      <li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt='Attribution-Noncommercial-Share Alike 3.0' /></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 16:58, 29 March 2006 by Anonymous user(s) of Unreal Wiki. </li>	  <li id="f-copyright">Licensed as <a href="../../../../articles/c/o/p/Unreal_Wiki%7ECopyrights_e561.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>	  <li id="f-about"><a href="../../../../articles/a/b/o/Unreal_Wiki%7EAbout_9ce6.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>	  <li id="f-disclaimer"><a href="../../../../articles/g/e/n/Unreal_Wiki%7EGeneral_disclaimer_a0a2.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
