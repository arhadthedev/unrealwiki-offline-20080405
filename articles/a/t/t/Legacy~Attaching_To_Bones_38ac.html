<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- headlinks removed -->
	<link rel="shortcut icon" href="../../../../misc/uewiki-favicon.png"/>
    <title>Legacy:Attaching To Bones - Unreal Wiki</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../../skins/offline/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/md5.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/utf8.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/lookup.js"></script>
    <script type="text/javascript" src="../../../../articles/-/_/_/-.html"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../../articles/c/o/m/MediaWiki%7ECommon.css_d42e.html";
@import "../../../../articles/m/o/n/MediaWiki%7EMonobook.css_fb19.html";
@import "../../../../articles/-/_/_/-.html";
/*]]>*/</style>          </head>
  <body
    class="ns-100">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Legacy:Attaching To Bones</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</h3>
	    <div id="contentSub"></div>
	    	    	    <!-- start content -->
	    <p>A bone is part of a <a href="../../../../articles/s/k/e/Legacy%7ESkeletal_Mesh_3f4a.html" title="Legacy:Skeletal Mesh">skeletal mesh</a>. The standard skeletal mesh for the <a href="../../../../articles/p/a/w/Legacy%7EPawn_d11f.html" title="Legacy:Pawn">pawn</a> includes the head, right leg, left leg, right foot, left foot, right hand, left hand, right shoulder, left shoulder, and the spine. Using <a href="../../../../articles/u/n/r/Legacy%7EUnrealScript_a9c5.html" title="Legacy:UnrealScript">UnrealScript</a>, you can attach almost anything to any bone of a given mesh.</p>
<p>Here, we'll discuss how you can attach actors to bones. For instance if you wanted an actor to follow a pawn around, you could attach it to a bone of that pawn. Or, if you wanted to attach emitters to the legs of a pawn, you would have to attach the emitters to both leg bones. An example of this is the Speed Combo in <a href="../../../../articles/u/t/2/Legacy%7EUT2003_f97b.html" class="mw-redirect" title="Legacy:UT2003">UT2003</a>.</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1"><a href="#Step_One"><span class="tocnumber">2</span> <span class="toctext">Step One</span></a></li>
<li class="toclevel-1"><a href="#Step_Two"><span class="tocnumber">3</span> <span class="toctext">Step Two</span></a></li>
<li class="toclevel-1"><a href="#Step_Three"><span class="tocnumber">4</span> <span class="toctext">Step Three</span></a></li>
<li class="toclevel-1"><a href="#Step_Four"><span class="tocnumber">5</span> <span class="toctext">Step Four</span></a></li>
<li class="toclevel-1"><a href="#Related_Topics"><span class="tocnumber">6</span> <span class="toctext">Related Topics</span></a></li>
<li class="toclevel-1"><a href="#Discussion"><span class="tocnumber">7</span> <span class="toctext">Discussion</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Introduction" id="Introduction"></a></p>
<h2><span class="mw-headline">Introduction</span></h2>
<p>We'll start by putting you through a very basic walkthrough. We'll spawn a custom trigger, attach it to the 'spine' of the pawn and then we will spawn Emitters and attach them to both legs. I suggest making a new package and call it AttachingToBones or something easy (see <a href="../../../../articles/s/e/t/Legacy%7ESet_Up_Package_Folders_6a30.html" title="Legacy:Set Up Package Folders">Set Up Package Folders</a> for help with this).</p>
<p><a name="Step_One" id="Step_One"></a></p>
<h2><span class="mw-headline">Step One</span></h2>
<p>First, we need to create the custom trigger. Create the following:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">class</span> SpineTrigger <span class="kw5">extends</span> Trigger;
 
<span class="co1">//We aren't going to make this do anything because</span>
<span class="co1">//this is just a walkthrough on how you can attach something to a bone</span>
 
<span class="kw1">DefaultProperties</span>
<span class="br0">{</span>
      bHidden=<span class="kw9">False</span> <span class="co1">//We want this false so you can see that it actually attached itself to the spine.</span>
<span class="br0">}</span>
</pre></div>
<p><a name="Step_Two" id="Step_Two"></a></p>
<h2><span class="mw-headline">Step Two</span></h2>
<p>Now we need to spawn this trigger and attach it to the pawn. The following mutator code should do this with no problem at all.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">class</span> MutAttachToBones <span class="kw5">extends</span> <a href="/Mutator"><span class="kw10">Mutator</span></a>;
 
<span class="kw5">var</span> trigger BoneTrigger; <span class="co1">//We need this variable or, it won't recognize what your trying to attach.</span>
 
<span class="kw5">function</span> ModifyPlayer<span class="br0">(</span><a href="/Pawn"><span class="kw10">Pawn</span></a> Other<span class="br0">)</span>
<span class="br0">{</span>
  <span class="kw5">local</span> xPawn x;
   x = xPawn<span class="br0">(</span>Other<span class="br0">)</span>;
 
  BoneTrigger = Spawn<span class="br0">(</span><span class="kw5">class</span><span class="st0">'SpineTrigger'</span>, x,, x.<span class="me1">Location</span>, x.<span class="me1">Rotation</span><span class="br0">)</span>;
  x.<span class="me1">AttachToBone</span><span class="br0">(</span>BoneTrigger, <span class="st0">'spine'</span><span class="br0">)</span>; <span class="co1">//AttachToBone I believe is a native function so it can work in all actors.</span>
                             <span class="co1">//'spine' is the bone name.  If you wanted you could replace this with any other bone name.</span>
<span class="br0">}</span>
 
<span class="kw1">DefaultProperties</span>
<span class="br0">{</span>
GroupName=<span class="st0">"AttachingStuffToBone"</span>
FriendlyName=<span class="st0">"AttachingStuffToBone"</span>
Description=<span class="st0">"Attaching Stuff ToBone.|| This will attach the triggers and the emitters to the pawn.."</span>
<span class="br0">}</span>
</pre></div>
<p><a name="Step_Three" id="Step_Three"></a></p>
<h2><span class="mw-headline">Step Three</span></h2>
<p>Next, we will put attaching emitters into the mix. Add the following bits of code. (pulled from the SpeedCombo source)</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">var</span> xEmitter LeftTrail, RightTrail; <span class="co1">//Put this line just under the first variable</span>
 
    <span class="co1">//Put these lines of code just under your BoneTrigger lines of code.</span>
    LeftTrail = Spawn<span class="br0">(</span><span class="kw5">class</span><span class="st0">'SpeedTrail'</span>, x,, x.<span class="me1">Location</span>, x.<span class="me1">Rotation</span><span class="br0">)</span>; <span class="co1">//SpeedTrail is already created :).</span>
    x.<span class="me1">AttachToBone</span><span class="br0">(</span>LeftTrail, <span class="st0">'lfoot'</span><span class="br0">)</span>; <span class="co1">//lfoot = Left Foot</span>
 
    RightTrail = Spawn<span class="br0">(</span><span class="kw5">class</span><span class="st0">'SpeedTrail'</span>, x,, x.<span class="me1">Location</span>, x.<span class="me1">Rotation</span><span class="br0">)</span>;
    x.<span class="me1">AttachToBone</span><span class="br0">(</span>RightTrail, <span class="st0">'rfoot'</span><span class="br0">)</span>;<span class="co1">//rfoot = Right Foot</span>
</pre></div>
<p><a name="Step_Four" id="Step_Four"></a></p>
<h2><span class="mw-headline">Step Four</span></h2>
<p>Compile&#160;:). Your basically done now. All you have to do is create our .INT file for the mutator and the package that you put the code in. When all is well, load up <a href="../../../../articles/u/t/2/Legacy%7EUT2003_f97b.html" class="mw-redirect" title="Legacy:UT2003">UT2003</a>. Start a match with your Mutator selected. When the match starts, go to your console and type <b>behindview 1</b>. Now walk around. You should see the trigger attached to your spine and the emitters attached to your feet.</p>
<p><a name="Related_Topics" id="Related_Topics"></a></p>
<h2><span class="mw-headline">Related Topics</span></h2>
<ul>
<li><a href="../../../../articles/b/o/n/Legacy%7EBone_Names_89fb.html" title="Legacy:Bone Names">Bone Names</a></li>
</ul>
<p><a name="Discussion" id="Discussion"></a></p>
<h2><span class="mw-headline">Discussion</span></h2>
<p><b>EricBlade:</b> I'm attempting to attach a beam emitter to a player, which works great, using the normal bHardAttach and SetBase(), however, I wanted a little more realism for attachment, so I attached it to the player's Right Hand bone. This works great, as long as I'm not in first person view. If I'm in first person view, the emitter is invisible. Is this because the player pawn isn't drawn, while in first person? Is there a way around that?</p>
<p><b>SuperApe:</b> You guessed it. Third-person view draws the xPawn just like you see other teammates and enemies. But, First-person view draws entirely different meshes for your weapons and turns off your xPawn. If you want your beam emitter to be on the "weapon hand", first I'd make sure you know which one it is (since you can configure it to be Right, Left, Center or Hidden in UT200x), then I'd try two things: 1) try to "piggy back" on the First-Person Weapon mesh so you automatically get it's walk/run bobbing motion, then if not that, 2) try attaching your beam emitter to the Controller instead and make your own bobbing to try and match the First-Person weapon meshes. It seems #2 would be decidedly more difficult, but it's something to try.</p>
<p><b>Xian:</b> Not sure how it works in UE2, since UE1 doesn't have bones (well it does, but no support for it from UScript), but I for one would keep a pointer to the attachemnt then use RenderOverlays and Canvas.DrawActor();</p>
<p>OK this is how I'd do it in UE1, IF I had bone support:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">function</span> AttachIt <span class="br0">(</span>PlayerController Other<span class="br0">)</span> <span class="co1">// at least I think the PalyerController is the main "player" in UE2</span>
<span class="br0">{</span>
  <span class="kw5">local</span> <a href="/Actor"><span class="kw10">Actor</span></a> MyAttachment; <span class="co1">// Obviously &lt;Actor&gt; here would be replaced by your Object type</span>
 
  MyAttachment = Spawn<span class="br0">(</span><span class="kw5">class</span><span class="st0">'Actor'</span>, Other,, Other.<span class="me1">Location</span>, Other.<span class="me1">Rotation</span><span class="br0">)</span>;
  Other.<span class="me1">AttachToBone</span><span class="br0">(</span>MyAttachment,<span class="st0">'whatever'</span><span class="br0">)</span>;
  Xian<span class="br0">(</span>Other<span class="br0">)</span>.<span class="me1">MyAttachment</span> = MyAttachment;
<span class="br0">}</span>
</pre></div>
<p>Ok that'd be the basic attachment (small reference, I didn't get the point of the xPawn conversion... it's just useless code since the function is available to all Actor class... anyway...)</p>
<p>And this is in a your PlayerPawn (I assume it's the PlayerController in UE2):</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">function</span> RenderOverlays <span class="br0">(</span>Canvas Canvas<span class="br0">)</span> <span class="co1">// if this function doesn't exist in UE2 use PostRender</span>
<span class="br0">{</span>
  <span class="kw1">if</span> <span class="br0">(</span>MyAttachment != <span class="kw9">None</span><span class="br0">)</span>
     Canvas.<span class="me1">DrawActor</span><span class="br0">(</span>MyAttachment,<span class="kw9">False</span><span class="br0">)</span>;
 
  <span class="co1">// don't forget to call the super :)</span>
<span class="br0">}</span>
</pre></div>
<p>I'm sorry I can't give you a detailed enough example but if you worked with both engines you'll know how to port what I showed you properly. Although I doubt it's the case but if it still doesn't work try setting bHidden to False in your attachment(s)&#160;:)</p>
<p><b>SuperApe:</b> I see the economy of this suggestion. I think it depends on the detail you'd want from this attachment. If you want it to interact with the world in 3D, as a beam emitter shooting from the arm might, a HUDOverlay may not do it.</p>
<p><b>Xian:</b> well Canvas.DrawActor() is limited to drawing ONLY the mesh itself. However... there are ways around it. Remember the Pulse Gun from UT&#160;? It has the beam sprite/model, the green long one. You could use that in another effect or a "fake" projectile which would have 0 damage with a bit of adjusted code. This approach might work in UE2 if you have such a firing animation/sprite/model. So what I am saying is use DrawActor() for the mesh but the firing effect or whatever it does would be a separate thing... although you could prolly use a PostRender() call in that as well if it is all just texture drawing and not real animation (where Actor-&gt;Effects classes should be used). But I think you get the idea&#160;:) Such code "hacks" are quite efficient if done properly. Engine limitations should not stop you.</p>
<p><b>EricBlade:</b> What I ended up doing is, since I'm moving a projector and emitter and light around every tick, anyway, I just made it so that the emitter gets reset to GetBoneCoords('rhand',1).Origin as it's position, and that works just about as well&#160;:)</p>

<!-- 
NewPP limit report
Preprocessor node count: 23/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
#ifexist count: 0/100
-->
<div class="printfooter">
</div>
	    	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-legacy"
	       class="selected"	       ><a href="../../../../articles/a/t/t/Legacy%7EAttaching_To_Bones_38ac.html">Legacy</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../../articles/a/t/t/Legacy_talk%7EAttaching_To_Bones_4cf0.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://wiki.beyondunreal.com/Legacy:Attaching_To_Bones">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../../misc/uewiki.png);"
	    href="../../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-mainpage"><a href="../../../../index.html">Main Page</a></li>
	     	      <li id="n-portal"><a href="../../../../articles/c/o/m/Unreal_Wiki%7ECommunity_Portal_3311.html">Community portal</a></li>
	     	      <li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt='Attribution-Noncommercial-Share Alike 3.0' /></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 21:34, 14 April 2006 by Anonymous user(s) of Unreal Wiki. </li>	  <li id="f-copyright">Licensed as <a href="../../../../articles/c/o/p/Unreal_Wiki%7ECopyrights_e561.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>	  <li id="f-about"><a href="../../../../articles/a/b/o/Unreal_Wiki%7EAbout_9ce6.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>	  <li id="f-disclaimer"><a href="../../../../articles/g/e/n/Unreal_Wiki%7EGeneral_disclaimer_a0a2.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
