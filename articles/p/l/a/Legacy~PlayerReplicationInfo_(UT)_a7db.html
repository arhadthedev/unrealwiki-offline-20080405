<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- headlinks removed -->
	<link rel="shortcut icon" href="../../../../misc/uewiki-favicon.png"/>
    <title>Legacy:PlayerReplicationInfo (UT) - Unreal Wiki</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../../skins/offline/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/md5.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/utf8.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/lookup.js"></script>
    <script type="text/javascript" src="../../../../articles/-/_/_/-.html"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../../articles/c/o/m/MediaWiki%7ECommon.css_d42e.html";
@import "../../../../articles/m/o/n/MediaWiki%7EMonobook.css_fb19.html";
@import "../../../../articles/-/_/_/-.html";
/*]]>*/</style>          </head>
  <body
    class="ns-100">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Legacy:PlayerReplicationInfo (UT)</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</h3>
	    <div id="contentSub"></div>
	    	    	    <!-- start content -->
	    <div class="infobox infobox-class infobox-legacy"><a href="../../../../articles/u/t/_/Legacy%7EUT_9cbd.html" class="mw-redirect" title="Legacy:UT">UT</a>&#160;:: <a href="../../../../articles/a/c/t/Legacy%7EActor_%28UT%29_b661.html" title="Legacy:Actor (UT)">Actor (UT)</a> &gt;&gt; <a href="../../../../articles/i/n/f/Legacy%7EInfo_%28UT%29_c293.html" title="Legacy:Info (UT)">Info (UT)</a> &gt;&gt; <a href="../../../../articles/r/e/p/Legacy%7EReplicationInfo_5a4c.html" title="Legacy:ReplicationInfo">ReplicationInfo</a> &gt;&gt; PlayerReplicationInfo (Package: Engine)</div>
<p>This class is responsible for replicating information about a player to all clients in a network game.</p>
<p>You'll find PRI as short version of PlayerReplicationInfo in the names of many variables and functions that deal with PlayerReplicationInfos.</p>
<p>See <a href="../../../../articles/p/l/a/Legacy%7EPlayerReplicationInfo_be80.html" title="Legacy:PlayerReplicationInfo">PlayerReplicationInfo</a> for the UT2003 version of this class.</p>
<p><a name="Properties" id="Properties"></a></p>
<h2><span class="mw-headline">Properties</span></h2>
<p>All properties are replicated unless the description tells something different.</p>
<dl>
<dt>string PlayerName&#160;</dt>
<dd>Player name, or blank if none.</dd>
<dt>string OldName&#160;</dt>
<dd>Temporary value.</dd>
<dt>int PlayerID&#160;</dt>
<dd>Unique id number.</dd>
<dt>string TeamName&#160;</dt>
<dd>Team name, or blank if none.</dd>
<dt>byte Team&#160;</dt>
<dd>The player's team. (0 = red, 1 = blue, 2 = green, 3 = gold, 255 = none)</dd>
<dt>int TeamID&#160;</dt>
<dd>Player position in team.</dd>
<dt>float Score&#160;</dt>
<dd>The player's current score.</dd>
<dt>float Deaths&#160;</dt>
<dd>How often the player died.</dd>
<dt>class&lt;VoicePack&gt; VoiceType&#160;</dt>
<dd>The voice pack used by the player.</dd>
<dt><a href="../../../../articles/d/e/c/Legacy%7EDecoration_%28UT%29_d072.html" title="Legacy:Decoration (UT)">Decoration (UT)</a> HasFlag&#160;</dt>
<dd>Any kind of decorative actor, e.g. the flags in CTF or the ball in Frag*Ball, currently held by the player.</dd>
<dt>int Ping&#160;</dt>
<dd>The players ping as detected by the server.</dd>
<dt>byte PacketLoss&#160;</dt>
<dt>bool bIsFemale&#160;</dt>
<dd>The player is female.</dd>
<dt>bool bIsABot&#160;</dt>
<dd>The player is a <a href="../../../../articles/b/o/t/Legacy%7EBot_%28UT%29_6150.html" title="Legacy:Bot (UT)">Bot (UT)</a>.</dd>
<dt>bool bFeigningDeath&#160;</dt>
<dd>The player currently feighs death.</dd>
<dt>bool bIsSpectator&#160;</dt>
<dd>The player just spectates.</dd>
<dt>bool bWaitingPlayer&#160;</dt>
<dt>bool bAdmin&#160;</dt>
<dd>The player is logged in as an admin.</dd>
<dt>Texture TalkTexture&#160;</dt>
<dt><a href="../../../../articles/z/o/n/Legacy%7EZoneInfo_%28UT%29_a8ec.html" title="Legacy:ZoneInfo (UT)">ZoneInfo (UT)</a> PlayerZone&#160;</dt>
<dd>The zone the player currently is in.</dd>
<dt><a href="../../../../articles/l/o/c/Legacy%7ELocationID_6e34.html" title="Legacy:LocationID">LocationID</a> PlayerLocation&#160;</dt>
<dd>A more detailed description of the player's location within a big zone.</dd>
<dt>int StartTime&#160;</dt>
<dt>int TimeAcc&#160;</dt>
<dd>(not replicated)</dd>
</dl>
<p><b>Mychaeel:</b> On an admittedly futile note, I wish Epic had provided a means to chain PlayerReplicationInfo with custom <a href="../../../../articles/r/e/p/Legacy%7EReplicationInfo_5a4c.html" title="Legacy:ReplicationInfo">ReplicationInfo</a> subclasses via a linked list... that would save so much trouble when dealing with custom replicated information. (Even subclassing PlayerReplicationInfo or <a href="../../../../articles/b/o/t/Legacy%7EBotReplicationInfo_9831.html" title="Legacy:BotReplicationInfo">BotReplicationInfo</a> and replacing the normal one by means of modifying <a href="../../../../articles/p/a/w/Legacy%7EPawn_%28UT%29_69ef.html" title="Legacy:Pawn (UT)">Pawn (UT)</a>.PlayerReplicationInfoClass or anything else is a rather cumbersome hack on most cases.)</p>
<p><b>Wormbo:</b> They could have created linked lists in many places like e.g. <a href="../../../../articles/w/e/a/Legacy%7EWeapon_%28UT%29_cf18.html" title="Legacy:Weapon (UT)">Weapon (UT)</a> affectors, but they also missed something important like the <a href="../../../../articles/h/u/d/Legacy%7EHUD_%28UT%29_e73f.html" title="Legacy:HUD (UT)">HUD (UT)</a> mutator chain and now we have to mess around with those relics-compatible HUD mutators...</p>
<p><b>Csimbi:</b> Finally I managed to work out a network-proof (and working) replication.</p>
<p>All codes below are directly copied from the rifle I am making - You will need to rename the actors so there won't be a conflict.</p>
<p>First of all, You need and actor. Here it is:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="co1">//=============================================================================</span>
<span class="co1">// ClanRifleReplicationInfo.</span>
<span class="co1">//=============================================================================</span>
<span class="co1">// Initial version : v3.0 (Csimbi&lt;csimbicsimbi@hotmail.com&gt;)</span>
<span class="co1">//=============================================================================</span>
<span class="kw5">class</span> ClanRifleReplicationInfo <span class="kw5">extends</span> <a href="/Actor"><span class="kw10">Actor</span></a>;
 
<span class="kw5">var</span> <span class="kw4">bool</span> bIsSpawn;             <span class="co1">// Is it spawn protected?</span>
<span class="kw5">var</span> <span class="kw4">bool</span> bPlayHeadShotSound;   <span class="co1">// Headshot sound toggle for clients.</span>
<span class="kw5">var</span> <span class="kw4">int</span> iReticle;              <span class="co1">// ID of the current reticle</span>
<span class="kw5">var</span> <span class="kw4">int</span> iBulletsFiredTotal;    <span class="co1">// Total number of bullets fired.</span>
<span class="kw5">var</span> <span class="kw4">int</span> iBulletTeamMateHits;   <span class="co1">// Number of bullets that hit a team mate.</span>
<span class="kw5">var</span> <span class="kw4">int</span> iBulletBodyHits;       <span class="co1">// Number of bullets that hit the body of an enemy.</span>
<span class="kw5">var</span> <span class="kw4">int</span> iBulletHeadHits;       <span class="co1">// Number of bullets that hit the head of an enemy.</span>
<span class="kw5">var</span> <span class="kw4">int</span> iBulletSpawnHits;      <span class="co1">// Number of bullets that hit a spawn.</span>
<span class="kw5">var</span> <span class="kw4">int</span> iBulletSpawnFirstHits; <span class="co1">// Number of bullets that hit a spawn for the first time.</span>
<span class="kw5">var</span> <span class="kw4">int</span> iBulletSpawnerHits;    <span class="co1">// Number of bullets that hit while spawn.</span>
<span class="kw5">var</span> <span class="kw4">int</span> iSpawnPunishCount;     <span class="co1">// Number of times the player was punished (Spawnprotect).</span>
<span class="kw5">var</span> <span class="kw4">int</span> iTelefragPunishCount;  <span class="co1">// Number of times the player was punished (Telefrag).</span>
<span class="kw5">var</span> <span class="kw4">int</span> iOutOfAmmoCount;       <span class="co1">// Number of times the player has been out of ammo.</span>
 
<span class="kw5">var</span> ClanRifleReplicationInfo prevCRRI; <span class="co1">// Previous item in the list</span>
<span class="kw5">var</span> ClanRifleReplicationInfo nextCRRI; <span class="co1">// Next item in the list</span>
 
<span class="kw1">replication</span>
<span class="br0">{</span>
        <span class="co1">// Things the server should send to the client.</span>
        <span class="kw6">reliable</span> <span class="kw1">if</span> <span class="br0">(</span><span class="kw8">Role</span>==<span class="kw9">ROLE_Authority</span><span class="br0">)</span>
                prevCRRI, nextCRRI, bIsSpawn, iReticle, bPlayHeadShotSound, iBulletBodyHits, iBulletHeadHits, iBulletSpawnHits, iBulletSpawnFirstHits, iBulletSpawnerHits, iSpawnPunishCount, iTelefragPunishCount, iBulletTeamMateHits;
        <span class="co1">// Things the client should send to the client.</span>
        <span class="kw6">reliable</span> <span class="kw1">if</span> <span class="br0">(</span>Role&lt;ROLE_Authority<span class="br0">)</span>
                iBulletsFiredTotal, iOutOfAmmoCount;
        <span class="kw6">reliable</span> <span class="kw1">if</span> <span class="br0">(</span><span class="kw8">Role</span>==<span class="kw9">ROLE_Authority</span><span class="br0">)</span>
                GetCRRI;
<span class="br0">}</span>
 
<span class="kw5">event</span> Spawned <span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        AddToList<span class="br0">(</span><span class="br0">)</span>;
        SetTimer<span class="br0">(</span><span class="nu0">1.0</span>, <span class="kw9">true</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw5">function</span> AddToList<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw5">local</span> ClanRifleReplicationInfo C;
 
        <span class="kw1">ForEach</span> AllActors<span class="br0">(</span><span class="kw5">class</span><span class="st0">'ClanRifleReplicationInfo'</span>, C<span class="br0">)</span> <span class="kw1">break</span>;
        <span class="kw1">if</span><span class="br0">(</span>C==<span class="kw9">None</span><span class="br0">)</span>
        <span class="br0">{</span>
                prevCRRI=<span class="kw9">None</span>;
                nextCRRI=<span class="kw9">None</span>;
        <span class="br0">}</span>
        <span class="kw1">else</span>
        <span class="br0">{</span>
                C=C.<span class="me1">GetLast</span><span class="br0">(</span><span class="br0">)</span>;
                <span class="kw1">if</span><span class="br0">(</span>C==<span class="kw9">None</span> || C==<span class="kw8">Self</span><span class="br0">)</span>
                <span class="br0">{</span>
                        prevCRRI=<span class="kw9">None</span>;
                        nextCRRI=<span class="kw9">None</span>;
                <span class="br0">}</span>
                <span class="kw1">else</span>
                <span class="br0">{</span>
                        C.<span class="me1">nextCRRI</span>=<span class="kw8">Self</span>;
                        prevCRRI=C;
                        nextCRRI=<span class="kw9">None</span>;
                <span class="br0">}</span>
        <span class="br0">}</span>
<span class="br0">}</span>
 
<span class="kw5">function</span> ClanRifleReplicationInfo GetNext<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw1">return</span> nextCRRI;
<span class="br0">}</span>
 
<span class="kw5">function</span> ClanRifleReplicationInfo GetPrevious<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw1">return</span> prevCRRI;
<span class="br0">}</span>
 
<span class="kw5">function</span> ClanRifleReplicationInfo GetFirst<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw5">local</span> <span class="kw4">bool</span> done;
        <span class="kw5">local</span> ClanRifleReplicationInfo C;
 
        done=<span class="kw9">false</span>;
        <span class="kw1">ForEach</span> AllActors<span class="br0">(</span><span class="kw5">class</span><span class="st0">'ClanRifleReplicationInfo'</span>, C<span class="br0">)</span> <span class="kw1">break</span>;
        <span class="kw1">while</span><span class="br0">(</span>!done &amp;&amp; C!=<span class="kw9">None</span><span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw1">if</span><span class="br0">(</span>C.<span class="me1">prevCRRI</span>==<span class="kw9">None</span><span class="br0">)</span>
                <span class="br0">{</span>
                        done=<span class="kw9">true</span>;
                        <span class="kw1">return</span> C;
                <span class="br0">}</span>
                C=C.<span class="me1">GetPrevious</span><span class="br0">(</span><span class="br0">)</span>;
        <span class="br0">}</span>
        <span class="kw1">return</span> <span class="kw9">None</span>;
<span class="br0">}</span>
 
<span class="kw5">function</span> ClanRifleReplicationInfo GetLast<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw5">local</span> <span class="kw4">bool</span> done;
        <span class="kw5">local</span> ClanRifleReplicationInfo C;
 
        done=<span class="kw9">false</span>;
        <span class="kw1">ForEach</span> AllActors<span class="br0">(</span><span class="kw5">class</span><span class="st0">'ClanRifleReplicationInfo'</span>, C<span class="br0">)</span> <span class="kw1">break</span>;
        <span class="kw1">while</span><span class="br0">(</span>!done &amp;&amp; C!=<span class="kw9">None</span><span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw1">if</span><span class="br0">(</span>C.<span class="me1">nextCRRI</span>==<span class="kw9">None</span><span class="br0">)</span>
                <span class="br0">{</span>
                        done=<span class="kw9">true</span>;
                        <span class="kw1">return</span> C;
                <span class="br0">}</span>
                C=C.<span class="me1">GetNext</span><span class="br0">(</span><span class="br0">)</span>;
        <span class="br0">}</span>
        <span class="kw1">return</span> <span class="kw9">None</span>;
<span class="br0">}</span>
 
<span class="kw5">function</span> RemoveFromList<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="co1">// Lot of extra checks here in case someone from outside manipulates the list and messes it up.</span>
        <span class="kw1">if</span><span class="br0">(</span>prevCRRI==<span class="kw9">None</span><span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw1">if</span><span class="br0">(</span>nextCRRI!=<span class="kw9">None</span><span class="br0">)</span> nextCRRI.<span class="me1">prevCRRI</span>=<span class="kw9">None</span>;
        <span class="br0">}</span>
        <span class="kw1">else</span>
        <span class="br0">{</span>
                prevCRRI.<span class="me1">nextCRRI</span>=nextCRRI;
        <span class="br0">}</span>
        <span class="kw1">if</span><span class="br0">(</span>nextCRRI==<span class="kw9">None</span><span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw1">if</span><span class="br0">(</span>prevCRRI!=<span class="kw9">None</span><span class="br0">)</span> prevCRRI.<span class="me1">nextCRRI</span>=<span class="kw9">None</span>;
        <span class="br0">}</span>
        <span class="kw1">else</span>
        <span class="br0">{</span>
                nextCRRI.<span class="me1">prevCRRI</span>=prevCRRI;
        <span class="br0">}</span>
        nextCRRI=<span class="kw9">None</span>;
        prevCRRI=<span class="kw9">None</span>;
<span class="br0">}</span>
 
<span class="kw5">function</span> ClanRifleReplicationInfo GetCRRI <span class="br0">(</span><a href="/Pawn"><span class="kw10">Pawn</span></a> P<span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw5">local</span> <span class="kw4">bool</span> found;
        <span class="kw5">local</span> ClanRifleReplicationInfo C;
 
        <span class="kw1">ForEach</span> AllActors<span class="br0">(</span><span class="kw5">class</span><span class="st0">'ClanRifleReplicationInfo'</span>, C<span class="br0">)</span>
        <span class="br0">{</span>
                found=<span class="kw9">true</span>;
                <span class="kw1">break</span>;
        <span class="br0">}</span>
        <span class="kw1">if</span><span class="br0">(</span>found<span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw1">for</span><span class="br0">(</span>C.<span class="me1">GetFirst</span><span class="br0">(</span><span class="br0">)</span>;C!=<span class="kw9">None</span>;C=C.<span class="me1">GetNext</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>
                <span class="br0">{</span>
                        <span class="kw1">if</span><span class="br0">(</span><a href="/Pawn"><span class="kw10">Pawn</span></a><span class="br0">(</span>C.<span class="me1">Owner</span><span class="br0">)</span>==P<span class="br0">)</span>
                        <span class="br0">{</span>
                                <span class="kw1">return</span> C;
                        <span class="br0">}</span>
                <span class="br0">}</span>
        <span class="br0">}</span>
        <span class="kw1">return</span> <span class="kw9">None</span>;
<span class="br0">}</span>
 
<span class="kw5">event</span> Timer<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw1">if</span><span class="br0">(</span><a href="/Pawn"><span class="kw10">Pawn</span></a><span class="br0">(</span>Owner<span class="br0">)</span>==<span class="kw9">None</span><span class="br0">)</span>
        <span class="br0">{</span>
                RemoveFromList<span class="br0">(</span><span class="br0">)</span>;
                Destroy<span class="br0">(</span><span class="br0">)</span>;
        <span class="br0">}</span>
<span class="br0">}</span>
 
<span class="kw5">function</span> DumpList<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw5">local</span> ClanRifleReplicationInfo C;
 
        <span class="kw7">log</span> <span class="br0">(</span><span class="st0">"___________Dumped list begin_________________"</span><span class="br0">)</span>;
        C=GetFirst<span class="br0">(</span><span class="br0">)</span>;
        <span class="kw1">while</span><span class="br0">(</span>C!=<span class="kw9">None</span><span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw7">log</span><span class="br0">(</span><span class="st0">"Prev: "</span>$C.<span class="me1">prevCRRI</span><span class="br0">)</span>;
                <span class="kw7">log</span><span class="br0">(</span><span class="st0">"Item: "</span>$C<span class="br0">)</span>;
                <span class="kw7">log</span><span class="br0">(</span><span class="st0">"Next: "</span>$C.<span class="me1">nextCRRI</span><span class="br0">)</span>;
                C=C.<span class="me1">nextCRRI</span>;
                <span class="kw1">if</span> <span class="br0">(</span>C!=<span class="kw9">None</span><span class="br0">)</span> <span class="kw7">log</span> <span class="br0">(</span><span class="st0">"___________"</span><span class="br0">)</span>;
        <span class="br0">}</span>
        <span class="kw7">log</span> <span class="br0">(</span><span class="st0">"___________Dumped list end___________________"</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw1">defaultproperties</span>
<span class="br0">{</span>
        bHidden=<span class="kw9">true</span>;
        NetUpdateFrequency=<span class="nu0">2.00</span>;
        bAlwaysRelevant=<span class="kw9">true</span>;
        bIsSpawn=<span class="kw9">false</span>;
        bPlayHeadShotSound=<span class="kw9">false</span>;
        iReticle=<span class="nu0">0</span>;
        iBulletsFiredTotal=<span class="nu0">0</span>;
        iBulletBodyHits=<span class="nu0">0</span>;
        iBulletHeadHits=<span class="nu0">0</span>;
        iBulletSpawnHits=<span class="nu0">0</span>;
        iBulletSpawnFirstHits=<span class="nu0">0</span>;
        iBulletSpawnerHits=<span class="nu0">0</span>;
        iSpawnPunishCount=<span class="nu0">0</span>;
        iTelefragPunishCount=<span class="nu0">0</span>;
        iBulletTeamMateHits=<span class="nu0">0</span>;
        iOutOfAmmoCount=<span class="nu0">0</span>;
<span class="br0">}</span>
</pre></div>
<p>Next, you need to spawn this actor whenever a player enters the game (the actor above is self-destructing, no need to worry about that in if You use this class).</p>
<p>The ListPlayers() is always called from the ModifyPlayer() function of the mutator.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">function</span> ListPlayers<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw5">local</span> <a href="/Pawn"><span class="kw10">pawn</span></a> P;
        <span class="kw5">local</span> ClanRifleReplicationInfo C;
        <span class="kw5">local</span> <span class="kw4">int</span> i,x;
 
        i=<span class="nu0">0</span>;
        <span class="kw1">ForEach</span> AllActors<span class="br0">(</span><span class="kw5">class</span><span class="st0">'ClanRifleReplicationInfo'</span>, C<span class="br0">)</span> <span class="kw1">break</span>;
        <span class="kw1">for</span><span class="br0">(</span>P=<span class="kw8">Level</span>.<span class="me1">Pawnlist</span>; P!=<span class="kw9">None</span>; P=P.<span class="me1">Nextpawn</span><span class="br0">)</span>
        <span class="br0">{</span>
                killers<span class="br0">[</span>i<span class="br0">]</span>=P;
                <span class="co1">// Create rifle replication info.</span>
                <span class="kw1">if</span><span class="br0">(</span>C!=<span class="kw9">None</span><span class="br0">)</span> C=C.<span class="me1">GetCRRI</span><span class="br0">(</span>P<span class="br0">)</span>;
                <span class="kw1">if</span><span class="br0">(</span>C==<span class="kw9">None</span><span class="br0">)</span>
                <span class="br0">{</span>
                        C=Spawn<span class="br0">(</span><span class="kw5">class</span><span class="st0">'ClanRifleReplicationInfo'</span>,P<span class="br0">)</span>;
                        x=<span class="kw5">class</span><span class="st0">'ClientOptionsPage'</span>.<span class="kw1">default</span>.<span class="me1">Reticle</span>;
                        <span class="kw1">if</span><span class="br0">(</span>x &gt; <span class="kw5">class</span><span class="st0">'ClientOptionsPage'</span>.<span class="kw1">default</span>.<span class="me1">ReticleMax</span><span class="br0">)</span> x=<span class="kw5">class</span><span class="st0">'ClientOptionsPage'</span>.<span class="kw1">default</span>.<span class="me1">ReticleMin</span>;
                        <span class="kw1">if</span><span class="br0">(</span>x &lt; <span class="kw5">class</span><span class="st0">'ClientOptionsPage'</span>.<span class="kw1">default</span>.<span class="me1">ReticleMin</span><span class="br0">)</span> x=<span class="kw5">class</span><span class="st0">'ClientOptionsPage'</span>.<span class="kw1">default</span>.<span class="me1">ReticleMax</span>;
                        C.<span class="me1">iReticle</span>=x;
                <span class="br0">}</span>
                <span class="co1">// Increase player count</span>
                i++;
        <span class="br0">}</span>
<span class="br0">}</span>
</pre></div>
<p>Then the variables need to be updated.</p>
<p>Here is function that updates a toggle (implemented within the Mutator - running on the server):</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">function</span> <span class="kw4">bool</span> ToggleCRRIHSS <span class="br0">(</span><a href="/Pawn"><span class="kw10">Pawn</span></a> SP<span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw5">local</span> ClanRifleReplicationInfo C;
        <span class="kw5">local</span> <a href="/Pawn"><span class="kw10">pawn</span></a> P;
        <span class="kw5">local</span> <span class="kw4">int</span> i;
        <span class="kw5">local</span> <span class="kw4">bool</span> found;
 
        <span class="kw1">if</span><span class="br0">(</span>SP==<span class="kw9">None</span><span class="br0">)</span> <span class="kw1">return</span> <span class="kw9">false</span>;
        i=<span class="nu0">0</span>;
        found=<span class="kw9">false</span>;
        <span class="kw1">for</span><span class="br0">(</span>P=<span class="kw8">Level</span>.<span class="me1">Pawnlist</span>; P!=<span class="kw9">None</span> &amp;&amp; !found; P=P.<span class="me1">Nextpawn</span><span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw1">if</span><span class="br0">(</span>SP==P<span class="br0">)</span> found=<span class="kw9">true</span>;
                i++;
        <span class="br0">}</span>
        <span class="kw1">if</span><span class="br0">(</span>found<span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw1">ForEach</span> AllActors<span class="br0">(</span><span class="kw5">class</span><span class="st0">'ClanRifleReplicationInfo'</span>, C<span class="br0">)</span> <span class="kw1">break</span>;
                C=C.<span class="me1">GetCRRI</span><span class="br0">(</span>SP<span class="br0">)</span>;
                <span class="kw1">if</span><span class="br0">(</span>C==<span class="kw9">None</span><span class="br0">)</span> <span class="kw1">return</span> <span class="kw9">false</span>;
                C.<span class="me1">bPlayHeadShotSound</span>=!C.<span class="me1">bPlayHeadShotSound</span>;
                <span class="kw1">return</span> <span class="kw9">true</span>;
        <span class="br0">}</span>
        <span class="kw1">return</span> <span class="kw9">false</span>;
<span class="br0">}</span>
</pre></div>
<p>There is function here that updates a counter (implemented within the Mutator - running on the server):</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">function</span> <span class="kw4">bool</span> UpdateCRRICounter <span class="br0">(</span><a href="/Pawn"><span class="kw10">Pawn</span></a> SP, <span class="kw4">int</span> Type, <span class="kw4">int</span> Counter<span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw5">local</span> ClanRifleReplicationInfo C;
        <span class="kw5">local</span> <a href="/Pawn"><span class="kw10">pawn</span></a> P;
        <span class="kw5">local</span> <span class="kw4">int</span> i, x;
        <span class="kw5">local</span> <span class="kw4">bool</span> found;
 
        <span class="kw1">if</span><span class="br0">(</span>SP==<span class="kw9">None</span><span class="br0">)</span> <span class="kw1">return</span> <span class="kw9">false</span>;
        i=<span class="nu0">0</span>;
        found=<span class="kw9">false</span>;
        <span class="kw1">for</span><span class="br0">(</span>P=<span class="kw8">Level</span>.<span class="me1">Pawnlist</span>; P!=<span class="kw9">None</span> &amp;&amp; !found; P=P.<span class="me1">Nextpawn</span><span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw1">if</span><span class="br0">(</span>SP==P<span class="br0">)</span> found=<span class="kw9">true</span>;
                i++;
        <span class="br0">}</span>
        <span class="kw1">if</span><span class="br0">(</span>found<span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw1">ForEach</span> AllActors<span class="br0">(</span><span class="kw5">class</span><span class="st0">'ClanRifleReplicationInfo'</span>, C<span class="br0">)</span> <span class="kw1">break</span>;
                C=C.<span class="me1">GetCRRI</span><span class="br0">(</span>SP<span class="br0">)</span>;
                <span class="kw1">if</span><span class="br0">(</span>C==<span class="kw9">None</span><span class="br0">)</span> <span class="kw1">return</span> <span class="kw9">false</span>;
                <span class="kw1">switch</span><span class="br0">(</span>Type<span class="br0">)</span>
                <span class="br0">{</span>
                        <span class="kw1">case</span> COUNTER_TYPE_RETICLE:
                                x=C.<span class="me1">iReticle</span>+Counter;
                                <span class="kw1">if</span><span class="br0">(</span>x &gt; <span class="kw5">class</span><span class="st0">'ClientOptionsPage'</span>.<span class="kw1">default</span>.<span class="me1">ReticleMax</span><span class="br0">)</span> x=<span class="kw5">class</span><span class="st0">'ClientOptionsPage'</span>.<span class="kw1">default</span>.<span class="me1">ReticleMin</span>;
                                <span class="kw1">if</span><span class="br0">(</span>x &lt; <span class="kw5">class</span><span class="st0">'ClientOptionsPage'</span>.<span class="kw1">default</span>.<span class="me1">ReticleMin</span><span class="br0">)</span> x=<span class="kw5">class</span><span class="st0">'ClientOptionsPage'</span>.<span class="kw1">default</span>.<span class="me1">ReticleMax</span>;
                                C.<span class="me1">iReticle</span>=x;
                                <span class="kw1">break</span>;
                        <span class="kw1">case</span> COUNTER_TYPE_BODY: C.<span class="me1">iBulletBodyHits</span>+=Counter; <span class="kw1">break</span>;
                        <span class="kw1">case</span> COUNTER_TYPE_HEAD: C.<span class="me1">iBulletHeadHits</span>+=Counter; <span class="kw1">break</span>;
                        <span class="kw1">case</span> COUNTER_TYPE_SPAWNSHOT: C.<span class="me1">iBulletSpawnHits</span>+=Counter; <span class="kw1">break</span>;
                        <span class="kw1">case</span> COUNTER_TYPE_SPAWNSHOT_FIRST: C.<span class="me1">iBulletSpawnFirstHits</span>+=Counter; <span class="kw1">break</span>;
                        <span class="kw1">case</span> COUNTER_TYPE_SPAWNER: C.<span class="me1">iBulletSpawnerHits</span>+=Counter; <span class="kw1">break</span>;
                        <span class="kw1">case</span> COUNTER_TYPE_SPAWNPUNISH: C.<span class="me1">iSpawnPunishCount</span>+=Counter; <span class="kw1">break</span>;
                        <span class="kw1">case</span> COUNTER_TYPE_TELEFRAGPUNISH: C.<span class="me1">iTelefragPunishCount</span>+=Counter; <span class="kw1">break</span>;
                        <span class="kw1">case</span> COUNTER_TYPE_TEAMMATE: C.<span class="me1">iBulletTeamMateHits</span>+=Counter; <span class="kw1">break</span>;
                <span class="br0">}</span>
                <span class="kw1">return</span> <span class="kw9">true</span>;
        <span class="br0">}</span>
        <span class="kw1">return</span> <span class="kw9">false</span>;
<span class="br0">}</span>
</pre></div>
<p>Here is a function that reads and updates a variable on the client-side:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw6">simulated</span> <span class="kw5">function</span> ReplicationTick<span class="br0">(</span><span class="kw4">float</span> DeltaTime<span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw5">local</span> ClanRifleReplicationInfo C;
        <span class="kw5">local</span> <a href="/Pawn"><span class="kw10">Pawn</span></a> PawnOwner;
        <span class="kw5">local</span> PlayerPawn PlayerPawnOwner;
        <span class="kw5">local</span> <span class="kw4">bool</span> FoundOwnerC;
 
        PawnOwner=<a href="/Pawn"><span class="kw10">Pawn</span></a><span class="br0">(</span>Owner<span class="br0">)</span>;
        PlayerPawnOwner=PlayerPawn<span class="br0">(</span>Owner<span class="br0">)</span>;
        FoundOwnerC=<span class="kw9">false</span>;
        <span class="kw1">if</span><span class="br0">(</span>PawnOwner!=<span class="kw9">None</span><span class="br0">)</span>
        <span class="br0">{</span>
                DT+=DeltaTime;
                <span class="kw1">if</span><span class="br0">(</span>DT&gt;=RefreshInterval<span class="br0">)</span>
                <span class="br0">{</span>
                        DT=<span class="nu0">0.000000</span>;
                        <span class="kw1">ForEach</span> AllActors<span class="br0">(</span><span class="kw5">class</span><span class="st0">'ClanRifleReplicationInfo'</span>, C<span class="br0">)</span>
                        <span class="br0">{</span>
                                <span class="kw1">if</span><span class="br0">(</span><a href="/Pawn"><span class="kw10">Pawn</span></a><span class="br0">(</span>C.<span class="me1">Owner</span><span class="br0">)</span>==PawnOwner<span class="br0">)</span>
                                <span class="br0">{</span>
                                        FoundOwnerC=<span class="kw9">true</span>;
                                        <span class="kw1">break</span>;
                                <span class="br0">}</span>
                        <span class="br0">}</span>
                        <span class="kw1">if</span><span class="br0">(</span>FoundOwnerC<span class="br0">)</span>
                        <span class="br0">{</span>
                                OwnerIsASpawn=C.<span class="me1">bIsSpawn</span>;
                                C.<span class="me1">iBulletsFiredTotal</span>+=BulletsFired;
                                BulletsFired=<span class="nu0">0</span>;
                                <span class="kw1">if</span><span class="br0">(</span>OutOfAmmo<span class="br0">)</span>
                                <span class="br0">{</span>
                                        OutOfAmmo=<span class="kw9">false</span>;
                                        C.<span class="me1">iOutOfAmmoCount</span>+=<span class="nu0">1</span>;
                                <span class="br0">}</span>
                                <span class="kw1">if</span><span class="br0">(</span>PlayerPawnOwner!=<span class="kw9">None</span><span class="br0">)</span> <span class="co1">// not for bots.</span>
                                <span class="br0">{</span>
                                        <span class="kw1">if</span><span class="br0">(</span>bPrevPlayHeadShotSound!=C.<span class="me1">bPlayHeadShotSound</span><span class="br0">)</span>
                                        <span class="br0">{</span>
                                                bPrevPlayHeadShotSound=C.<span class="me1">bPlayHeadShotSound</span>;
                                                <span class="kw1">if</span><span class="br0">(</span><span class="kw5">class</span><span class="st0">'ClientOptionsPage'</span>.<span class="kw1">default</span>.<span class="me1">HSAudio</span>&gt;HeadshotSoundCount<span class="nu0">-1</span><span class="br0">)</span> PlayerPawnOwner.<span class="me1">ClientPlaySound</span><span class="br0">(</span>HeadshotSound<span class="br0">[</span><span class="kw7">Rand</span><span class="br0">(</span>HeadshotSoundCount<span class="br0">)</span><span class="br0">]</span>, <span class="kw9">false</span>, <span class="kw9">false</span><span class="br0">)</span>;
                                                <span class="kw1">else</span> PlayerPawnOwner.<span class="me1">ClientPlaySound</span><span class="br0">(</span>HeadshotSound<span class="br0">[</span><span class="kw5">class</span><span class="st0">'ClientOptionsPage'</span>.<span class="kw1">default</span>.<span class="me1">HSAudio</span><span class="br0">]</span>, <span class="kw9">false</span>, <span class="kw9">false</span><span class="br0">)</span>;
                                        <span class="br0">}</span>
                                <span class="br0">}</span>
                        <span class="br0">}</span>
                        <span class="kw1">else</span> OwnerIsASpawn=<span class="kw9">false</span>;
                        TargetIsASpawn=HasSPInventory<span class="br0">(</span>TP<span class="br0">)</span>;
                        selectedreticle=GetCurrentReticle<span class="br0">(</span>OP<span class="br0">)</span>;
                <span class="br0">}</span>
        <span class="br0">}</span>
<span class="br0">}</span>
</pre></div>
<p>A couple of suggestions:</p>
<p>The GetCRRI() function does not work on client side - do not use it. It will only work in Standalone (no network) games.</p>
<p>Do NOT read/write the replicated variables from a PostRender() or Tick() function unless You add there some flow control (as done in the code above), otherwise the network performance will be very poor.</p>
<p><b>Csimbi:</b> I could not get replication working with NetUpdateFrequency values lower than 2.00. Is there any way to do that?</p>
<p><b>Iv:</b> I just managed to get that subclassing of PlayerReplicationInfo working by just destroying the actual PlayerReplicationInfo in the Pawn and spawning a new subclassed one in place, all of this from the ModifyPlayer function of the Mutator class. The trick seemed to work fine in here so here I'm posting the snip:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">function</span> ModifyPlayer<span class="br0">(</span><a href="/Pawn"><span class="kw10">Pawn</span></a> Other<span class="br0">)</span> <span class="br0">{</span>
        <span class="kw5">local</span> PlayerPawn pp;
        <span class="kw5">local</span> SpyPlayerReplicationInfo spri;
        <span class="kw5">local</span> <span class="kw4">string</span> PlayerName;
 
        <span class="kw1">if</span><span class="br0">(</span> Other.<span class="kw7">isA</span><span class="br0">(</span><span class="st0">'PlayerPawn'</span><span class="br0">)</span> <span class="br0">)</span> <span class="br0">{</span>
                pp = PlayerPawn<span class="br0">(</span>Other<span class="br0">)</span>;
                pp.<span class="me1">PlayerReplicationInfoClass</span> = <span class="kw5">class</span><span class="st0">'SpyPlayerReplicationInfo'</span>;
 
                <span class="coMULTI">/*
                 * We are going to spawn a new replication info
                 * and remove the previous one
                 */</span>
 
                PlayerName = pp.<span class="me1">PlayerReplicationInfo</span>.<span class="me1">PlayerName</span>;
                pp.<span class="me1">PlayerReplicationInfo</span>.<span class="me1">destroy</span><span class="br0">(</span><span class="br0">)</span>;
                pp.<span class="me1">PlayerReplicationInfo</span> = Spawn<span class="br0">(</span> <span class="kw5">class</span> <span class="st0">'SpyPlayerReplicationInfo'</span>, pp,,<span class="kw4">vect</span><span class="br0">(</span><span class="nu0">0</span>,<span class="nu0">0</span>,<span class="nu0">0</span><span class="br0">)</span>,rot<span class="br0">(</span><span class="nu0">0</span>,<span class="nu0">0</span>,<span class="nu0">0</span><span class="br0">)</span><span class="br0">)</span>;
 
                pp.<span class="me1">PlayerReplicationInfo</span>.<span class="me1">PlayerName</span> = PlayerName;
                pp.<span class="me1">initPlayerReplicationInfo</span><span class="br0">(</span><span class="br0">)</span>;
                spri = SpyPlayerReplicationInfo<span class="br0">(</span> pp.<span class="me1">PlayerReplicationInfo</span> <span class="br0">)</span>;
                spri.<span class="me1">ipAddrString</span> = pp.<span class="me1">GetPlayerNetworkAddress</span><span class="br0">(</span><span class="br0">)</span>;           
        <span class="br0">}</span>
        <span class="kw6">super</span>.<span class="me1">ModifyPlayer</span><span class="br0">(</span> Other <span class="br0">)</span>;
<span class="br0">}</span>
</pre></div>
<p><b>Xian:</b></p>
<p>Csimbi: That is because the main ClanRifleReplicationInfo is not replicated to all Clients. It exists only on Role=ROLE_Authority. But there are other ways to update variables client-side... I don't get why you had to use a function that is executed each frame O_o</p>
<p>Iv: From what I can remember, ModifyPlayer() is called on each respawn. Spawn/Destroy use A LOT of bandwidth, not to mention CPU resources... best way is to use a Mutator like this:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">function</span> ModifyLogin<span class="br0">(</span><span class="kw6">out</span> class&lt;playerpawn&gt; SpawnClass, <span class="kw6">out</span> <span class="kw4">string</span> Portal, <span class="kw6">out</span> <span class="kw4">string</span> Options<span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span> NextMutator != <span class="kw9">None</span> <span class="br0">)</span>
                NextMutator.<span class="me1">ModifyLogin</span><span class="br0">(</span>SpawnClass, Portal, Options<span class="br0">)</span>;
 
        SpawnClass.<span class="kw1">default</span>.<span class="me1">PlayerReplicationInfoClass</span> = <span class="kw5">Class</span><span class="st0">'SpyPlayerReplicationInfo'</span>;
<span class="br0">}</span>
</pre></div>
<p>Done&#160;:) And even more efficient (note: if other mutators modify it, then you will mess up their functions... also note a SpawnNotify can override your Class)</p>
<p><a name="Known_Subclasses" id="Known_Subclasses"></a></p>
<h2><span class="mw-headline">Known Subclasses</span></h2>
<ul>
<li><a href="../../../../articles/b/o/t/Legacy%7EBotReplicationInfo_9831.html" title="Legacy:BotReplicationInfo">BotReplicationInfo</a></li>
</ul>
<p><a name="Related_Topics" id="Related_Topics"></a></p>
<h2><span class="mw-headline">Related Topics</span></h2>
<ul>
<li><a href="../../../../articles/m/a/i/Legacy%7EMaintaining_Compatibility_7f4d.html" title="Legacy:Maintaining Compatibility">Maintaining Compatibility</a></li>
</ul>

<!-- 
NewPP limit report
Preprocessor node count: 32/1000000
Post-expand include size: 258/2097152 bytes
Template argument size: 176/2097152 bytes
#ifexist count: 0/100
-->
<div class="printfooter">
</div>
	    <div id="catlinks"><p class='catlinks'><a href="../../../../articles/c/a/t/Special%7ECategories_101d.html" title="Special:Categories">Category</a>: <span dir='ltr'><a href="../../../../articles/l/e/g/Category%7ELegacy_Class_%28UT%29_523c.html" title="Category:Legacy Class (UT)">Legacy Class (UT)</a></span></p></div>	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-legacy"
	       class="selected"	       ><a href="../../../../articles/p/l/a/Legacy%7EPlayerReplicationInfo_%28UT%29_a7db.html">Legacy</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../../articles/p/l/a/Legacy_talk%7EPlayerReplicationInfo_%28UT%29_e463.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://wiki.beyondunreal.com/Legacy:PlayerReplicationInfo_%28UT%29">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../../misc/uewiki.png);"
	    href="../../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-mainpage"><a href="../../../../index.html">Main Page</a></li>
	     	      <li id="n-portal"><a href="../../../../articles/c/o/m/Unreal_Wiki%7ECommunity_Portal_3311.html">Community portal</a></li>
	     	      <li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt='Attribution-Noncommercial-Share Alike 3.0' /></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 16:19, 6 June 2006 by Anonymous user(s) of Unreal Wiki. </li>	  <li id="f-copyright">Licensed as <a href="../../../../articles/c/o/p/Unreal_Wiki%7ECopyrights_e561.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>	  <li id="f-about"><a href="../../../../articles/a/b/o/Unreal_Wiki%7EAbout_9ce6.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>	  <li id="f-disclaimer"><a href="../../../../articles/g/e/n/Unreal_Wiki%7EGeneral_disclaimer_a0a2.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
