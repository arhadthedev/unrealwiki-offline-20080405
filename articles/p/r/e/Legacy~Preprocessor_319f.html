<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- headlinks removed -->
	<link rel="shortcut icon" href="../../../../misc/uewiki-favicon.png"/>
    <title>Legacy:Preprocessor - Unreal Wiki</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../../skins/offline/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/md5.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/utf8.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/lookup.js"></script>
    <script type="text/javascript" src="../../../../articles/-/_/_/-.html"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../../articles/c/o/m/MediaWiki%7ECommon.css_d42e.html";
@import "../../../../articles/m/o/n/MediaWiki%7EMonobook.css_fb19.html";
@import "../../../../articles/-/_/_/-.html";
/*]]>*/</style>          </head>
  <body
    class="ns-100">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Legacy:Preprocessor</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</h3>
	    <div id="contentSub"></div>
	    	    	    <!-- start content -->
	    <p>Using the UT3 PreProcessor</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1"><a href="#features"><span class="tocnumber">2</span> <span class="toctext">features</span></a></li>
<li class="toclevel-1"><a href="#usage"><span class="tocnumber">3</span> <span class="toctext">usage</span></a>
<ul>
<li class="toclevel-2"><a href="#Defining_Macros..."><span class="tocnumber">3.1</span> <span class="toctext">Defining Macros...</span></a></li>
<li class="toclevel-2"><a href="#Conditional..."><span class="tocnumber">3.2</span> <span class="toctext">Conditional...</span></a></li>
<li class="toclevel-2"><a href="#Including_Source..."><span class="tocnumber">3.3</span> <span class="toctext">Including Source...</span></a></li>
<li class="toclevel-2"><a href="#Things_to_investigate"><span class="tocnumber">3.4</span> <span class="toctext">Things to investigate</span></a></li>
<li class="toclevel-2"><a href="#Line_Continuation_and_Multi_Line_Macros"><span class="tocnumber">3.5</span> <span class="toctext">Line Continuation and Multi Line Macros</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Caveats"><span class="tocnumber">4</span> <span class="toctext">Caveats</span></a>
<ul>
<li class="toclevel-2"><a href="#Line_Numbers_in_warning.2Ferror_output"><span class="tocnumber">4.1</span> <span class="toctext">Line Numbers in warning/error output</span></a></li>
<li class="toclevel-2"><a href="#white_space"><span class="tocnumber">4.2</span> <span class="toctext">white space</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Integration_with_Editor.Make_.28_ut3_make_..._.29"><span class="tocnumber">5</span> <span class="toctext">Integration with Editor.Make ( ut3 make ... )</span></a>
<ul>
<li class="toclevel-2"><a href="#DEBUG"><span class="tocnumber">5.1</span> <span class="toctext">DEBUG</span></a></li>
<li class="toclevel-2"><a href="#FINAL_RELEASE"><span class="tocnumber">5.2</span> <span class="toctext">FINAL_RELEASE</span></a></li>
<li class="toclevel-2"><a href="#RELEASE"><span class="tocnumber">5.3</span> <span class="toctext">RELEASE</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#More_to_come"><span class="tocnumber">6</span> <span class="toctext">More to come</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Introduction" id="Introduction"></a></p>
<h1><span class="mw-headline">Introduction</span></h1>
<p>The UT3 PreProcessor is functional and while it seems to be lacking in documentation (at least that is available to the mod community) it works ok as a basic pp.</p>
<p>There are other preprocessors of course. I believe I've seen several UnrealScript specific ones and there are always things like <a href="http://www.cabaret.demon.co.uk/filepp/" class="external text" title="http://www.cabaret.demon.co.uk/filepp/" rel="nofollow">filepp</a> which is just totally awesome. You could use a C preprocessor as well, or something like perl's <a href="http://www.tt2.org" class="external text" title="http://www.tt2.org" rel="nofollow">Template Toolkit</a>.</p>
<p>However, should you choose to use the inbuilt preprocessor, here is a guide to what has been discovered so far.</p>
<p><a name="features" id="features"></a></p>
<h1><span class="mw-headline">features</span></h1>
<pre>
* Basic if/else/elsif/endif directives
* Include capability
* Define preprocessor symbols
* Simple "literal" macro replacement
* Macros that can take arguments
* Multi-line Macros
* Some integration with Editor.Make 
* ??? There must be more - please contribute your knowledge!
</pre>
<p><a name="usage" id="usage"></a></p>
<h1><span class="mw-headline">usage</span></h1>
<p>The usage is simple and rather straight forward. All directives are initiated with the backtick ( ` ) symbol.</p>
<p><a name="Defining_Macros..." id="Defining_Macros..."></a></p>
<h2><span class="mw-headline">Defining Macros...</span></h2>
<p>Here are some examples of defining macros and symbols:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
`define MyVersion <span class="st0">"1.3.20"</span> 
`define MyClass <span class="kw5">class</span><span class="st0">'MyPackage.MyClass'</span> 
`define LogError<span class="br0">(</span>txt<span class="br0">)</span> LogInternal<span class="br0">(</span> GetFuncName<span class="br0">(</span><span class="br0">)</span>$<span class="st0">":"</span>$ `txt , <span class="st0">'Error'</span><span class="br0">)</span> 
`define LogDebug<span class="br0">(</span>txt<span class="br0">)</span> LogInternal<span class="br0">(</span> GetFuncName<span class="br0">(</span><span class="br0">)</span>$<span class="st0">":"</span>$ `txt , <span class="st0">'Debug'</span><span class="br0">)</span> 
`define MyAssert<span class="br0">(</span>condition<span class="br0">)</span> <span class="kw1">if</span><span class="br0">(</span> `condition <span class="br0">)</span> <span class="br0">{</span> `LogError<span class="br0">(</span><span class="st0">"Assert failed: `condition"</span><span class="br0">)</span>; <span class="br0">}</span>
`define NameOf<span class="br0">(</span><span class="kw5">var</span><span class="br0">)</span> <span class="br0">(</span> <span class="br0">(</span> `<span class="kw5">var</span> == `<span class="kw5">var</span> <span class="br0">)</span> ? <span class="st0">'`var'</span> : <span class="st0">'`var'</span> <span class="br0">)</span>
</pre></div>
<p><a name="Conditional..." id="Conditional..."></a></p>
<h2><span class="mw-headline">Conditional...</span></h2>
<p>Standard if/elsif/else/endif clauses can be used. At the moment, the conditions that can be evaluated by these clauses seem to be somewhat limited to the following:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
`notdefined<span class="br0">(</span> SYMBOL <span class="br0">)</span>
`isdefined<span class="br0">(</span> SYMBOL <span class="br0">)</span>
</pre></div>
<p>There must be other preprocessor functions that can be used as well - but those are all you need to accomplish quite a bit:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
`define MyVersion <span class="st0">"1.3.20"</span> 
`define MyClass <span class="kw5">class</span><span class="st0">'MyPackage.MyClass'</span> 
`define LogError<span class="br0">(</span>txt<span class="br0">)</span> LogInternal<span class="br0">(</span> GetFuncName<span class="br0">(</span><span class="br0">)</span>$<span class="st0">":"</span>$ `txt , <span class="st0">'Error'</span><span class="br0">)</span> 
`define MyAssert<span class="br0">(</span>condition<span class="br0">)</span> <span class="kw1">if</span><span class="br0">(</span> `condition <span class="br0">)</span> <span class="br0">{</span> `LogError<span class="br0">(</span><span class="st0">"Assert failed: `condition"</span><span class="br0">)</span>; <span class="br0">}</span>
 
`<span class="kw1">if</span><span class="br0">(</span>`isdefined<span class="br0">(</span>DEBUG<span class="br0">)</span><span class="br0">)</span>
 
`define LogDebug<span class="br0">(</span>txt<span class="br0">)</span> LogInternal<span class="br0">(</span> GetFuncName<span class="br0">(</span><span class="br0">)</span>$<span class="st0">":"</span>$ `txt , <span class="st0">'Debug'</span><span class="br0">)</span> 
`define NameOf<span class="br0">(</span><span class="kw5">var</span><span class="br0">)</span> <span class="br0">(</span> <span class="br0">(</span> `<span class="kw5">var</span> == `<span class="kw5">var</span> <span class="br0">)</span> ? <span class="st0">'`var'</span> : <span class="st0">'`var'</span> <span class="br0">)</span> 
 
`<span class="kw1">else</span>
 
`define LogDebug<span class="br0">(</span>txt<span class="br0">)</span> 
`define NameOf<span class="br0">(</span><span class="kw5">var</span><span class="br0">)</span> <span class="st0">'`var'</span> 
 
`endif
</pre></div>
<p><a name="Including_Source..." id="Including_Source..."></a></p>
<h2><span class="mw-headline">Including Source...</span></h2>
<p>You may use the include directive to incorporate content. The convention for "header files" seems to be to use the extension: .uci</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">class</span> MyMutator <span class="kw5">extends</span> <a href="/Mutator"><span class="kw10">Mutator</span></a>;
 
`include<span class="br0">(</span> MyPackage/Classes/MyStdInc.<span class="me1">uci</span> <span class="br0">)</span>
 
<span class="kw5">function</span> PostBeginPlay<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
    `MyDbg<span class="br0">(</span><span class="st0">"MyCoolMutator, Version: "</span> $ `MyVersion <span class="br0">)</span>;
    <span class="co1">// whatever....</span>
<span class="br0">}</span>
</pre></div>
<p><a name="Things_to_investigate" id="Things_to_investigate"></a></p>
<h2><span class="mw-headline">Things to investigate</span></h2>
<p>The '#' symbol seems to be recognized:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="co1">// Not sure what this is - it may be for positional arguments or number of arguments supplied to macros.  More investigation is needed.</span>
 
`#<span class="br0">(</span><span class="br0">)</span>
</pre></div>
<p>Enclosing symbols in '{' and '}' seems to have some purpose, not sure what it is but, I think it may mean "evaluate to empty string and do not produce an error if the symbol/macro is not defined." like so:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
`<span class="kw1">if</span><span class="br0">(</span>`isdefined<span class="br0">(</span>MY_UNIT_TEST<span class="br0">)</span><span class="br0">)</span>
`define FuncScope public
`endif
 
`<span class="br0">{</span>FuncScope<span class="br0">}</span> <span class="kw5">function</span> MyCoolFunction<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
   <span class="co1">// whatever...</span>
<span class="br0">}</span>
</pre></div>
<p><a name="Line_Continuation_and_Multi_Line_Macros" id="Line_Continuation_and_Multi_Line_Macros"></a></p>
<h2><span class="mw-headline">Line Continuation and Multi Line Macros</span></h2>
<p>You may wish to continue long lines or create multi-line macros. You can continue lines with a backslash. If you want your macros to be "multi-line" then you can place a "\n" at the end of the line.</p>
<p>Example source:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">var</span> <span class="kw4">int</span> SwapTmp;
`define SwapInt<span class="br0">(</span>a,b<span class="br0">)</span> SwapTmp = `a; \
                     `a = `b; \
                     `b = SwapTmp
 
<span class="kw5">var</span> array&lt;string&gt; Messages;
`define DefaultMessages \
  Messages<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Hello World"</span> \n \
  Messages<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Headshot!!!"</span> \n
 
<span class="kw5">class</span> MyClass <span class="kw5">extends</span> Info;
 
<span class="kw5">function</span> PostBeginPlay<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
  Swap<span class="br0">(</span>MyKills,MyHealth<span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw1">defaultproperties</span>
<span class="br0">{</span>
  `DefaultMessages
<span class="br0">}</span>
</pre></div>
<p>The above would result in something like:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">var</span> <span class="kw4">int</span> SwapTmp;
 
 
 
 
 
 
<span class="kw5">class</span> MyClass <span class="kw5">extends</span> Info;
 
<span class="kw5">function</span> PostBeginPlay<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
  SwapTmp = MyKills; MyKills = MyHealth; MyHealth = SwapTmp;
<span class="br0">}</span>
 
<span class="kw1">defaultproperties</span>
<span class="br0">{</span>
  Messages<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Hello World"</span>
  Messages<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Headshot!!!"</span>
<span class="br0">}</span>
</pre></div>
<p><a name="Caveats" id="Caveats"></a></p>
<h1><span class="mw-headline">Caveats</span></h1>
<p><a name="Line_Numbers_in_warning.2Ferror_output" id="Line_Numbers_in_warning.2Ferror_output"></a></p>
<h2><span class="mw-headline">Line Numbers in warning/error output</span></h2>
<p>Unless you use the `include() directive, you should not have a problem with this. If however, you choose to</p>
<p>use the `include() directive then when your code has a warning or error it is quite likely that the line</p>
<p>number reported by the compiler will be inaccurate.</p>
<p>_[BIA]DarthMushak_&#160;: I have written a perl script that will launch "ut3 make" and parse the resulting output before displaying it, adjusting line numbers as necessary. If anyone is interested, let me know.</p>
<p><a name="white_space" id="white_space"></a></p>
<h2><span class="mw-headline">white space</span></h2>
<ul>
<li>Caution* you must be aware of how the UT3 preprocessor interprets whitespace! If there is no whitespace between the end of your macro definition and the newline, then when the preprocessor inserts the result, it will *eat all the whitespace on its RHS* - so:</li>
</ul>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="nu0">1</span>: `define MyType <span class="kw4">int</span>\n
<span class="nu0">2</span>: \n
<span class="nu0">3</span>: <span class="kw5">var</span> `MyType Foo;\n
<span class="nu0">4</span>: \n
<span class="nu0">5</span>: `define MyOtherType <span class="kw4">string</span> \n
<span class="nu0">6</span>: \n
<span class="nu0">7</span>: <span class="kw5">var</span> `MyOtherType Bar;\n
</pre></div>
<p>Assuming that the "\n" chars in the code above are the newlines, the above code would effectively produce the following:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="nu0">1</span>: 
<span class="nu0">2</span>: 
<span class="nu0">3</span>: <span class="kw5">var</span> intFoo;
<span class="nu0">4</span>:
<span class="nu0">5</span>: 
<span class="nu0">6</span>:
<span class="nu0">7</span>: <span class="kw5">var</span> <span class="kw4">string</span> Bar;
</pre></div>
<p>So, be careful with the whitespace!</p>
<p><a name="Integration_with_Editor.Make_.28_ut3_make_..._.29" id="Integration_with_Editor.Make_.28_ut3_make_..._.29"></a></p>
<h1><span class="mw-headline">Integration with Editor.Make ( ut3 make ... )</span></h1>
<p>While you are free to define symbols such as DEBUG and FINAL_RELEASE via preprocessor directives it is probably best if you leverage the inbuilt support for these two via command line switches to the "make" Commandlet.</p>
<p><a name="DEBUG" id="DEBUG"></a></p>
<h3><span class="mw-headline">DEBUG</span></h3>
<p>By supplying the switch *-debug* to make, the symbol "DEBUG" will be defined globally in all classes during the parsing phase. I am guessing that this switch also enables other things during the compile phase as well (ie: support for a debugger perhaps? - doesn't seem to exist?)</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
ut3 make -debug
</pre></div>
<p><a name="FINAL_RELEASE" id="FINAL_RELEASE"></a></p>
<h3><span class="mw-headline">FINAL_RELEASE</span></h3>
<p>By supplying the switch *-final_release* to make, the symbol "FINAL_RELEASE" will be defined globally in all classes during parsing phase.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
ut3 make -final_release
</pre></div>
<p><a name="RELEASE" id="RELEASE"></a></p>
<h3><span class="mw-headline">RELEASE</span></h3>
<p>If you supply neither *-final_release* or *-debug* then the code will be built for "release" and neither the "DEBUG" or the "FINAL_RELEASE" symbols are defined.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
ut3 make
</pre></div>
<p><br /></p>
<p><a name="More_to_come" id="More_to_come"></a></p>
<h1><span class="mw-headline">More to come</span></h1>
<p>Stay tuned! If you learn more, please update this page. Thanks!</p>

<!-- 
NewPP limit report
Preprocessor node count: 56/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
#ifexist count: 0/100
-->
<div class="printfooter">
</div>
	    	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-legacy"
	       class="selected"	       ><a href="../../../../articles/p/r/e/Legacy%7EPreprocessor_319f.html">Legacy</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../../articles/p/r/e/Legacy_talk%7EPreprocessor_0dd1.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://wiki.beyondunreal.com/Legacy:Preprocessor">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../../misc/uewiki.png);"
	    href="../../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-mainpage"><a href="../../../../index.html">Main Page</a></li>
	     	      <li id="n-portal"><a href="../../../../articles/c/o/m/Unreal_Wiki%7ECommunity_Portal_3311.html">Community portal</a></li>
	     	      <li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt='Attribution-Noncommercial-Share Alike 3.0' /></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 08:55, 10 January 2008 by Anonymous user(s) of Unreal Wiki. </li>	  <li id="f-copyright">Licensed as <a href="../../../../articles/c/o/p/Unreal_Wiki%7ECopyrights_e561.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>	  <li id="f-about"><a href="../../../../articles/a/b/o/Unreal_Wiki%7EAbout_9ce6.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>	  <li id="f-disclaimer"><a href="../../../../articles/g/e/n/Unreal_Wiki%7EGeneral_disclaimer_a0a2.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
