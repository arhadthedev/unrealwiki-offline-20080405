<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- headlinks removed -->
	<link rel="shortcut icon" href="../../../../misc/uewiki-favicon.png"/>
    <title>Legacy:Moo/Diary - Unreal Wiki</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../../skins/offline/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/md5.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/utf8.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/lookup.js"></script>
    <script type="text/javascript" src="../../../../articles/-/_/_/-.html"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../../articles/c/o/m/MediaWiki%7ECommon.css_d42e.html";
@import "../../../../articles/m/o/n/MediaWiki%7EMonobook.css_fb19.html";
@import "../../../../articles/-/_/_/-.html";
/*]]>*/</style>          </head>
  <body
    class="ns-100">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Legacy:Moo/Diary</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</h3>
	    <div id="contentSub"><span class="subpages">&lt; <a href="../../../../articles/m/o/o/Legacy%7EMoo_d69f.html" title="Legacy:Moo">Legacy:Moo</a></span></div>
	    	    	    <!-- start content -->
	    <table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#6_July_2005"><span class="tocnumber">1</span> <span class="toctext">6 July 2005</span></a>
<ul>
<li class="toclevel-2"><a href="#HtmlPage_class"><span class="tocnumber">1.1</span> <span class="toctext">HtmlPage class</span></a></li>
<li class="toclevel-2"><a href="#New_output_classes"><span class="tocnumber">1.2</span> <span class="toctext">New output classes</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#5_July_2005"><span class="tocnumber">2</span> <span class="toctext">5 July 2005</span></a></li>
<li class="toclevel-1"><a href="#1_July_2005"><span class="tocnumber">3</span> <span class="toctext">1 July 2005</span></a></li>
<li class="toclevel-1"><a href="#Old_stuff"><span class="tocnumber">4</span> <span class="toctext">Old stuff</span></a>
<ul>
<li class="toclevel-2"><a href="#Admin_Pages"><span class="tocnumber">4.1</span> <span class="toctext">Admin Pages</span></a></li>
<li class="toclevel-2"><a href="#Home_Page"><span class="tocnumber">4.2</span> <span class="toctext">Home Page</span></a></li>
<li class="toclevel-2"><a href="#Diff_.26_History"><span class="tocnumber">4.3</span> <span class="toctext">Diff &amp; History</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Main_function"><span class="tocnumber">5</span> <span class="toctext">Main function</span></a></li>
<li class="toclevel-1"><a href="#New.28.29"><span class="tocnumber">6</span> <span class="toctext">New()</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="6_July_2005"></a></p>
<h2><span class="mw-headline">6 July 2005</span></h2>
<p>I went to take a look at <a href="http://www.usemod.com/cgi-bin/mb.pl?InfiniteMonkey" class="extiw" title="meatball:InfiniteMonkey">MeatBall:InfiniteMonkey</a>. Funny how you can miss totally obvious features, eg RSS output. This really amounts to a totally different output channel for the script. Then I read the bit about working with Wiki Clients, which adds a potential third channel.</p>
<p>So... do I add a level of abstraction in my Page hierarchy, like this:</p>
<div style="font-family: monospace; white-space: preserve; line-height: 1em;">Page<br /></div>
<div style="font-family: monospace; white-space: preserve; line-height: 1em;"><img src="../../../../../extensions/TreeTag/16/leaf.png" alt="\-&nbsp;" />HtmlPage<br /></div>
<div style="font-family: monospace; white-space: preserve; line-height: 1em;"><img src="../../../../../extensions/TreeTag/16/empty.png" alt="&nbsp;&nbsp;&nbsp;" /><img src="../../../../../extensions/TreeTag/16/leaf.png" alt="\-&nbsp;" />WikiHtmlPage<br /></div>
<div style="font-family: monospace; white-space: preserve; line-height: 1em;"><img src="../../../../../extensions/TreeTag/16/empty.png" alt="&nbsp;&nbsp;&nbsp;" /><img src="../../../../../extensions/TreeTag/16/empty.png" alt="&nbsp;&nbsp;&nbsp;" /><img src="../../../../../extensions/TreeTag/16/leaf.png" alt="\-&nbsp;" />usual classes<br /></div>
<p>Or do I introduce Yet Another orthogonal class system of "Output modules" that provide wrapping to the Wiki output? These would be HTML and RSS initially, and WikiClient could be a plug-in later.</p>
<p>My gut instinct it to lean towards the 2nd option, even though it's a big change in how the script works and it's also a whole new class tree to think about.</p>
<p><a name="HtmlPage_class" id="HtmlPage_class"></a></p>
<h3><span class="mw-headline">HtmlPage class</span></h3>
<p>Pro:</p>
<ul>
<li>Relatively simple</li>
<li>RssPage will have different children to a certain extent. Rss won't need things like a Diff page, or an Edit page and so on. So having a new branch of the Page class tree makes sense in this light. But...</li>
</ul>
<p>Con:</p>
<ul>
<li>Some duplication of classes would occur: we'd basically have two RecentChangesPage classes. Would any other classes find themselves repeated? Certainly the ClientOutput would need things like old revisions and history list pages.</li>
</ul>
<p><a name="New_output_classes" id="New_output_classes"></a></p>
<h3><span class="mw-headline">New output classes</span></h3>
<p>Pro:</p>
<ul>
<li>Features such as site-wide linkbars or user-specific custom linkbars could be added as a new Output class. I have no idea how these could be plug-ins in current system.</li>
</ul>
<p>Con:</p>
<ul>
<li>RssPage and other output methods will need some way of knowing that it can't do a Diff page, for example. This will need to be expansion-proof.</li>
<li>RSS outputs a completely different kind of markup. It's not just a wrapping of template and whatever around the formatted Wiki markup. Two RecentChangesPage classes actually make sense here.</li>
</ul>
<p>Hmm....</p>
<p><a name="5_July_2005"></a></p>
<h2><span class="mw-headline">5 July 2005</span></h2>
<p>The really big thing that's still missing is the database. Things like edit conflict and diff too, but while these are core features, they're not totally essential. With a database system and the basic UseMod parser, Moo should at least be ok to run on a local system as a personal notepad.</p>
<p>Oh and a system for user registration!</p>
<p>My To Do list at the moment is mainly cleaning up tasks – making variable names consistent and standardizing the way things are accessed.</p>
<p><a name="1_July_2005"></a></p>
<h2><span class="mw-headline">1 July 2005</span></h2>
<p><b>Tarquin:</b> Today I've taken a tentative look at the script for Moo. It runs. It doesn't have a markup parser or a database, but you can edit and save a page, and there's basic support in place for things like category page listings. I need to spend some time getting reacquainted with the script so I understand it again. Fortunately, I've caught Mych's habit of leaving LOTS of comments. There's even POD too!</p>
<p><a name="Old_stuff" id="Old_stuff"></a></p>
<h2><span class="mw-headline">Old stuff</span></h2>
<p>Rough notes for the class structure</p>
<ul>
<li>Page
<ul>
<li>PageWiki: pages that open a page from the server
<ul>
<li>Edit
<ul>
<li>Edit Conflict</li>
</ul>
</li>
<li>Diff</li>
<li>History</li>
<li>PageWikiSpecial
<ul>
<li>RecentChanges (maybe this &amp; below given a base class, SpecialPage)</li>
<li>Search</li>
<li>Wanted Pages</li>
<li>RandomPage</li>
<li>Image Upload</li>
</ul>
</li>
</ul>
</li>
<li>Preferences</li>
<li>Login</li>
<li>List all pages</li>
<li>Admin-Only
<ul>
<li>Rename</li>
<li>Ban IP</li>
<li>Lock / unlock site</li>
<li>Lock / Unlock page</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>I had an idea to isolate behaviour for diff, edit, conflict, history in subclasses. The problem is that PageWikiSpecial children need that behavour too.</p>
<p>Possible solution: treat SpecialPages as a seperate tree of plug-in behaviours. (like bot brains).</p>
<p>Aside: can a class's parent be set at runtime? I suppose it can, since it's just</p>
<pre>
  our @ISA = Block;
</pre>
<p>which sets parentage. Nothing stopping a</p>
<pre>
if( pants ) {
 our @ISA = Block; }
else {
 our @ISA = NotBlock;}
</pre>
<p>and thus</p>
<ol>
<li>indentify requirement as Browse, Edit, Diff, Etc</li>
<li>determine if SpecialPage</li>
<li>spawn object of (desired SpecialPage) as child of requirement in 1</li>
</ol>
<p>Would that count as REALLY twisted though?</p>
<p><b>Mychaeel:</b> It can be done and is even documented as doable (in that the method inheritance namespace cache is documented to be cleared when it's done), but it's a last resort at most... if you can avoid stuff like that, do it.</p>
<p><b>Tarquin:</b> Doh! Diff &amp; Edit etc dont need to load in the generated content... just the saved wiki text. So if the object is if class "Diff" (say), then the fact that it doesnt load the generated behaviour is irrelevant!</p>
<p><a name="Admin_Pages" id="Admin_Pages"></a></p>
<h4><span class="mw-headline">Admin Pages</span></h4>
<p>Maybe make a base class for Admin-only pages. Hmm. maybe not, a simple Admin-only flag somewhere.</p>
<dl>
<dd><a href="http://c2.com/cgi/wiki?ShallowHierarchies" class="external free" title="http://c2.com/cgi/wiki?ShallowHierarchies" rel="nofollow">http://c2.com/cgi/wiki?ShallowHierarchies</a> Let's have a class PageAdmin which handles checking the viewer's admin status &amp; displaying a message.</dd>
</dl>
<p><a name="Home_Page" id="Home_Page"></a></p>
<h4><span class="mw-headline">Home Page</span></h4>
<p>slightly special because no page specified means go here... so not a class, but a special case in PageWiki</p>
<p>Actually, might as well make it a special case at the class level. The class for HomePage could be as simple as reading a config variable for which page to open.</p>
<p><a name="Diff_.26_History" id="Diff_.26_History"></a></p>
<h4><span class="mw-headline">Diff &amp; History</span></h4>
<p>not sure how to handle diff &amp; history. probably:</p>
<ul>
<li>Page
<ul>
<li>PageWiki
<ul>
<li>History</li>
<li>Diff</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The really clever thing to do would be to have History, Diff and EditConflict create a new PageWiki object that handles opening the second page.</p>
<p>This business that new() is non-special means that a class can have <i>several</i> creation functions, I suppose.</p>
<dl>
<dd><b>Mychaeel:</b> Absolutely. (Naming convention is C++-like, by the way – start class names with capital letters, method names with lowercase letters. You can structure either by using capital letters inbetween.)</dd>
</dl>
<p>That means page classes could have a NewPage() and a NewNested() (or whatever. names subject to improvement). If a nested page is needed for diff, history, edit conflict, etc, create a new instance of PageWiki, but the NewNested obviously doesn't need to make headers, it just needs to open a file &amp; display text.</p>
<p><a name="Main_function" id="Main_function"></a></p>
<h2><span class="mw-headline">Main function</span></h2>
<p>Pondering two approaches:</p>
<p>method 1:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
sub doBrowse <span class="br0">{</span>
  print &amp;getHttpHeader<span class="br0">(</span><span class="br0">)</span>;
  print &amp;getHtmlHeader<span class="br0">(</span><span class="br0">)</span>;
  print &amp;getPageHeader<span class="br0">(</span><span class="br0">)</span>;
  print &amp;getDocumentText<span class="br0">(</span><span class="br0">)</span>;
  # etc
<span class="br0">}</span>
 
 
method <span class="nu0">2</span>:
 
&lt;uscript&gt;
sub doBrowse <span class="br0">{</span>
  getHttpHeader<span class="br0">(</span><span class="br0">)</span>;
  getHtmlHeader<span class="br0">(</span><span class="br0">)</span>;
  getPageHeader<span class="br0">(</span><span class="br0">)</span>;
  getDocumentText<span class="br0">(</span><span class="br0">)</span>;
  # etc
<span class="br0">}</span>
# each <span class="kw5">function</span> handles its own printing.
</pre></div>
<p>As I see it, the advantage of (2) is that I can choose whether to build up a $text and print in one go, or print pieces as it goes.</p>
<p><b>Mychaeel:</b> I strongly suggest you build the entire page in memory first, then print it at once if appropriate. Just think of the <a href="../../../../articles/o/f/f/Legacy%7EOffline_Wiki_94d3.html" title="Legacy:Offline Wiki">Offline Wiki</a> (plus, you can send a decent "Content-Length" HTTP header so browsers know in advance how much content to expect and can display working progress bars while loading).</p>
<p><a name="New.28.29" id="New.28.29"></a></p>
<h2><span class="mw-headline">New()</span></h2>
<p>In wookee.pm, new() is only ever called with one argument. Therefore, is the second line in sub new() useful:</p>
<pre>
    my $owner = shift;
</pre>
<p>It's causing me problems as I'm calling new(&#160;%PageVariables ) and the first piece of the hash gets eaten by it. Do i risk death or disaster by removing it?</p>
<p><b>Mychaeel:</b> At one place in Wookee, new() takes a reference to an object's "owner" (to propagate information about embedded links and headers up the block nesting hierarchy). That's not a Perl built-in, it's merely my own design.</p>
<hr />
<p><b>Mychaeel:</b> Moo? I like the name. &#160;:-D</p>
<p><b>Tarquin:</b> &#160;:D</p>
<p><b>ZxAnPhOrIaN:</b> I like moo too.&#160;:D</p>
<hr />
<pre>
 sub Browse {
   my $page          = ' ';
   # need to know:
   # URL params
   # User name and status
   
   my %browseParams  = ( page=&gt;'Home', action=&gt;'edit');
   
   # determine which class to set $page equal to...
   foreach $subclass ( @registered ) {
     $page = $subclass-&gt;ChildofPage($page, %browseParams );
     print "checking... $page\n";
     # Page
     ## PageAdminTask
     ## PageWiki
     ## PageLogin
     ## PagePreferences
   }
   print $page-&gt;GenerateContent();
   #print scalar @registered;
 }
</pre>
<p>hmm.... not ideal. I'm trying to think if there's ever a situation where different tasks might both want to perform, given the input, and one should take precedence. If not, might as well have classes return nothing unless they want to take on the task, and use some sort of a "while ..." construction instead of "foreach".</p>

<!-- 
NewPP limit report
Preprocessor node count: 18/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
#ifexist count: 0/100
-->
<div class="printfooter">
</div>
	    	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-legacy"
	       class="selected"	       ><a href="../../../../articles/m/o/o/Legacy%7EMoo_Diary_2825.html">Legacy</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../../articles/m/o/o/Legacy_talk%7EMoo_Diary_a7ce.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://wiki.beyondunreal.com/Legacy:Moo/Diary">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../../misc/uewiki.png);"
	    href="../../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-mainpage"><a href="../../../../index.html">Main Page</a></li>
	     	      <li id="n-portal"><a href="../../../../articles/c/o/m/Unreal_Wiki%7ECommunity_Portal_3311.html">Community portal</a></li>
	     	      <li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt='Attribution-Noncommercial-Share Alike 3.0' /></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 13:19, 6 July 2005 by <a href="../../../../articles/t/a/r/User%7ETarquin_cdb6.html" title="User:Tarquin">tarquin</a>. </li>	  <li id="f-copyright">Licensed as <a href="../../../../articles/c/o/p/Unreal_Wiki%7ECopyrights_e561.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>	  <li id="f-about"><a href="../../../../articles/a/b/o/Unreal_Wiki%7EAbout_9ce6.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>	  <li id="f-disclaimer"><a href="../../../../articles/g/e/n/Unreal_Wiki%7EGeneral_disclaimer_a0a2.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
