<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- headlinks removed -->
	<link rel="shortcut icon" href="../../../../misc/uewiki-favicon.png"/>
    <title>Legacy:UT2K4GamePageBase - Unreal Wiki</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../../skins/offline/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/md5.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/utf8.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/lookup.js"></script>
    <script type="text/javascript" src="../../../../articles/-/_/_/-.html"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../../articles/c/o/m/MediaWiki%7ECommon.css_d42e.html";
@import "../../../../articles/m/o/n/MediaWiki%7EMonobook.css_fb19.html";
@import "../../../../articles/-/_/_/-.html";
/*]]>*/</style>          </head>
  <body
    class="ns-100">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Legacy:UT2K4GamePageBase</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</h3>
	    <div id="contentSub"></div>
	    	    	    <!-- start content -->
	    <div class="infobox infobox-class infobox-legacy"><a href="../../../../articles/u/t/2/Legacy%7EUT2004_5921.html" class="mw-redirect" title="Legacy:UT2004">UT2004</a>&#160;:: <a href="../../../../articles/g/u/i/Legacy%7EGUI_3dd2.html" title="Legacy:GUI">GUI</a> &gt;&gt; <a href="../../../../articles/g/u/i/Legacy%7EGUIComponent_61d8.html" title="Legacy:GUIComponent">GUIComponent</a> &gt;&gt; <a href="../../../../articles/g/u/i/Legacy%7EGUIMultiComponent_439a.html" title="Legacy:GUIMultiComponent">GUIMultiComponent</a> &gt;&gt; <a href="../../../../articles/g/u/i/Legacy%7EGUIPage_02a6.html" title="Legacy:GUIPage">GUIPage</a> &gt;&gt; UT2K4GUIPage &gt;&gt; UT2K4MainPage &gt;&gt; UT2K4GamePageBase</div>
<p>The base class for the UT2004 Instant Action and Host Game menus.</p>
<p><a name="Evolution_explains" id="Evolution_explains"></a></p>
<h2><span class="mw-headline">Evolution explains</span></h2>
<p>I've seen quite a few questions regarding the correct way for implementing a custom gametype rules page in the <a href="../../../../articles/u/t/2/Legacy%7EUT2004_5921.html" class="mw-redirect" title="Legacy:UT2004">UT2004</a> <a href="../../../../articles/g/u/i/Legacy%7EGUI_3dd2.html" title="Legacy:GUI">GUI</a>. Recently I received an email from a mod author who was having trouble with getting his custom game rules tabpanel to appear in the game. The following was my response to his question - copied here for the benefit of anyone else having trouble understanding the new gametype rules menu system.</p>
<p>The rules page is dynamically generated in <a href="../../../../articles/u/t/2/Legacy%7EUT2004_5921.html" class="mw-redirect" title="Legacy:UT2004">UT2004</a>, and there are no longer custom rules panels for each gametype. I decided to go this route in UT2004 because of the sheer volume of new properties that were going to be added and exposed in the interface.</p>
<p>The rules page is now dynamically generated by the UT2K4PlayInfoPanel class, using data from <a href="../../../../articles/p/l/a/Legacy%7EPlayInfo_6e9c.html" title="Legacy:PlayInfo">PlayInfo</a>. The exact implementation, however, was changed very early in the development cycle. Originally, the rules tab was UT2K4Tab_RulesBase, which contained its own GUITabControl with a single tab for each playinfo group. InstantActionRulesPanel was the class that was used in this internal tabcontrol for each of the <a href="../../../../articles/p/l/a/Legacy%7EPlayInfo_6e9c.html" title="Legacy:PlayInfo">PlayInfo</a> groups. If you take a look at UT2K4Tab_RulesBase.Refresh(), you'll see where the panels are generated based on the <a href="../../../../articles/p/l/a/Legacy%7EPlayInfo_6e9c.html" title="Legacy:PlayInfo">PlayInfo</a> groups.</p>
<p>Eventually, however, we decided that the instant action menu looked too cluttered this way, and decided to go with a single page for all <a href="../../../../articles/p/l/a/Legacy%7EPlayInfo_6e9c.html" title="Legacy:PlayInfo">PlayInfo</a> properties, represented as a multicolumn list of <a href="../../../../articles/g/u/i/Legacy%7EGUIMenuOption_6518.html" title="Legacy:GUIMenuOption">GUIMenuOptions</a>...thus IAMultiColumnRulesPanel was born. This is the reason why your subclass of InstantActionRulesPanel isn't showing up.</p>
<p>If you take a look at UT2K4GamePageBase, you'll notice that there is a bUseTabs variable. Since I had spent so much time developing and fine-tuning the multiple tab method of displaying the rules, I didn't want to just throw it all away. I left bUseTabs in as a hook for going back to the multi-tabs approach, if we wanted to do that later. Unless you set bUseTabs to true in your subclass of UT2K4GamePageBase, it will always use GUI2K4.IAMultiColumnRulesPanel as the class that manages all the <a href="../../../../articles/p/l/a/Legacy%7EPlayInfo_6e9c.html" title="Legacy:PlayInfo">PlayInfo</a> rules (look at UT2K4GamePageBase.InitComponent()). Generally, you shouldn't need to replace the rules panel - you can manipulate PlayInfo from within your gametype to be able to do lots of things in the menu without the need to write any menu code whatsoever.</p>
<p>As far as figuring out what the heck is going on in this menu, the most important thing to remember is that the whole thing revolves around <a href="../../../../articles/p/l/a/Legacy%7EPlayInfo_6e9c.html" title="Legacy:PlayInfo">PlayInfo</a> - so you definitely want to make sure you know how <a href="../../../../articles/p/l/a/Legacy%7EPlayInfo_6e9c.html" title="Legacy:PlayInfo">PlayInfo</a> works. When the gametype is changed, the current PlayInfo's data is no longer relevant, so the game type page re-initializes the <a href="../../../../articles/p/l/a/Legacy%7EPlayInfo_6e9c.html" title="Legacy:PlayInfo">PlayInfo</a> object with the data from the new gametype, then notifies all panels that care that <a href="../../../../articles/p/l/a/Legacy%7EPlayInfo_6e9c.html" title="Legacy:PlayInfo">PlayInfo</a> has been re-initialized.</p>
<p>For the rules panel (IAMultiColumnRulesPanel), this means that it must go through each property in <a href="../../../../articles/p/l/a/Legacy%7EPlayInfo_6e9c.html" title="Legacy:PlayInfo">PlayInfo</a>, and generate the corresponding control for that rule, which involves adding the component to its GUIMultiOptionList, setting up the appropriate delegate chains, setting the default values, etc. For the mutators panel, this means it must re-verify that mutators are allowed in this gametype, and remove any that are not allowed.</p>
<p>So here's a quick run-down:</p>
<ul>
<li>user changes gametype</li>
<li>gametype selection panel calls its OnChangeGameType delegate, which is hooked to UT2K4GamePageBase.ChangeGameType</li>
<li>ChangeGameType notifies the mutator panel, then calls SetRuleInfo()</li>
<li>SetRuleInfo initializes <a href="../../../../articles/p/l/a/Legacy%7EPlayInfo_6e9c.html" title="Legacy:PlayInfo">PlayInfo</a> with the new gametype, then calls Refresh on the rules panel, which is currently IAMultiColumnRulesPanel</li>
<li>the rules panel clears its current list of components, then re-fills the list with new components ( AddRule() ) based on the properties now in playinfo ( LoadRules() )</li>
<li>the rules panel then goes through all of the components it just added, and initializes their values with the values from <a href="../../../../articles/p/l/a/Legacy%7EPlayInfo_6e9c.html" title="Legacy:PlayInfo">PlayInfo</a> ( UpdateRules() )</li>
<li>when the value of any of the options is changed, the rules panel takes care of propagating the change to <a href="../../../../articles/p/l/a/Legacy%7EPlayInfo_6e9c.html" title="Legacy:PlayInfo">PlayInfo</a> ( UpdateSetting() )</li>
<li>when the user exits the page, either by clicking 'Play', or clicking 'Back', the values stored in playinfo are written out to disk, and the changes have been applied ( UT2K4GamePageBase.InternalOnClick() / PrepareToPlay() )</li>
</ul>
<p>I hope that clears up some things for you and gives you an idea of where to start digging into this menu if you need to.</p>
<p><b>NickR:</b> Just because this is the wiki and if you didn't know: To get your own game settings into the new gamerules tab, you add them inside you own version of the static function FillPlayInfo which is declared in the GameInfo class.</p>
<p><b>smattbac:</b> And you can remove settings with by returning false in AcceptPlayInfoProperty(). I spent almost an hour looking for this.&#160;:( Also, this page should probably be cleaned up, or have this info put somewhere else.</p>
<p><a name="Known_Subclasses" id="Known_Subclasses"></a></p>
<h2><span class="mw-headline">Known Subclasses</span></h2>
<ul>
<li>UT2K4GamePageMP</li>
<li>UT2K4GamePageSP</li>
</ul>

<!-- 
NewPP limit report
Preprocessor node count: 11/1000000
Post-expand include size: 360/2097152 bytes
Template argument size: 270/2097152 bytes
#ifexist count: 0/100
-->
<div class="printfooter">
</div>
	    <div id="catlinks"><p class='catlinks'><a href="../../../../articles/c/a/t/Special%7ECategories_101d.html" title="Special:Categories">Categories</a>: <span dir='ltr'><a href="../../../../articles/l/e/g/Category%7ELegacy_Class_%28UT2004%29_5784.html" title="Category:Legacy Class (UT2004)">Legacy Class (UT2004)</a></span> | <span dir='ltr'><a href="../../../../articles/l/e/g/Category%7ELegacy_Tutorial_261e.html" title="Category:Legacy Tutorial">Legacy Tutorial</a></span></p></div>	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-legacy"
	       class="selected"	       ><a href="../../../../articles/u/t/2/Legacy%7EUT2K4GamePageBase_26ad.html">Legacy</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../../articles/u/t/2/Legacy_talk%7EUT2K4GamePageBase_72d8.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://wiki.beyondunreal.com/Legacy:UT2K4GamePageBase">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../../misc/uewiki.png);"
	    href="../../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-mainpage"><a href="../../../../index.html">Main Page</a></li>
	     	      <li id="n-portal"><a href="../../../../articles/c/o/m/Unreal_Wiki%7ECommunity_Portal_3311.html">Community portal</a></li>
	     	      <li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt='Attribution-Noncommercial-Share Alike 3.0' /></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 17:52, 31 May 2006 by Anonymous user(s) of Unreal Wiki. </li>	  <li id="f-copyright">Licensed as <a href="../../../../articles/c/o/p/Unreal_Wiki%7ECopyrights_e561.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>	  <li id="f-about"><a href="../../../../articles/a/b/o/Unreal_Wiki%7EAbout_9ce6.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>	  <li id="f-disclaimer"><a href="../../../../articles/g/e/n/Unreal_Wiki%7EGeneral_disclaimer_a0a2.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
