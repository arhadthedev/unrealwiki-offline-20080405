<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- headlinks removed -->
	<link rel="shortcut icon" href="../../../../misc/uewiki-favicon.png"/>
    <title>Legacy:TeamVehicleFactory - Unreal Wiki</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../../skins/offline/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/md5.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/utf8.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/lookup.js"></script>
    <script type="text/javascript" src="../../../../articles/-/_/_/-.html"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../../articles/c/o/m/MediaWiki%7ECommon.css_d42e.html";
@import "../../../../articles/m/o/n/MediaWiki%7EMonobook.css_fb19.html";
@import "../../../../articles/-/_/_/-.html";
/*]]>*/</style>          </head>
  <body
    class="ns-100">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Legacy:TeamVehicleFactory</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</h3>
	    <div id="contentSub"></div>
	    	    	    <!-- start content -->
	    <div class="infobox infobox-class infobox-legacy"><a href="../../../../articles/u/t/2/Legacy%7EUT2004_5921.html" class="mw-redirect" title="Legacy:UT2004">UT2004</a>&#160;:: <a href="../../../../articles/a/c/t/Legacy%7EActor_5985.html" title="Legacy:Actor">Actor</a> &gt;&gt; <a href="../../../../articles/s/v/e/Legacy%7ESVehicleFactory_e070.html" title="Legacy:SVehicleFactory">SVehicleFactory</a> &gt;&gt; TeamVehicleFactory (custom)</div>
<p>This custom actor really duplicates much of the functionality of the ONSVehicleFactory subclasses, but the big feature is that nearly any vehicle class can be spawned. Although this actor cannot display the selected vehicle class in the editor, it does offer added controls that mappers for VCTF or other vehicle gametypes might want.</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Features"><span class="tocnumber">1</span> <span class="toctext">Features</span></a></li>
<li class="toclevel-1"><a href="#Notes"><span class="tocnumber">2</span> <span class="toctext">Notes</span></a></li>
<li class="toclevel-1"><a href="#Properties"><span class="tocnumber">3</span> <span class="toctext">Properties</span></a>
<ul>
<li class="toclevel-2"><a href="#Main"><span class="tocnumber">3.1</span> <span class="toctext">Main</span></a></li>
<li class="toclevel-2"><a href="#Hidden"><span class="tocnumber">3.2</span> <span class="toctext">Hidden</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Code"><span class="tocnumber">4</span> <span class="toctext">Code</span></a></li>
<li class="toclevel-1"><a href="#External_Links"><span class="tocnumber">5</span> <span class="toctext">External Links</span></a></li>
<li class="toclevel-1"><a href="#Related_Topics"><span class="tocnumber">6</span> <span class="toctext">Related Topics</span></a></li>
<li class="toclevel-1"><a href="#Discussion"><span class="tocnumber">7</span> <span class="toctext">Discussion</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Features" id="Features"></a></p>
<h2><span class="mw-headline">Features</span></h2>
<ul>
<li>The ability to spawn random vehicles from a list of vehicle classes</li>
<li>The ability to spawn nearly any vehicle class in gametypes that allow vehicles</li>
<li>The ability to trigger PreSpawn and (Post)Spawn events</li>
<li>The option to allow the vehicle to spawn over and crush other actors</li>
<li>The option to use this as either a triggerable or an automatic (timed) vehicle factory.</li>
<li>Greater control over spawn timing</li>
</ul>
<p><a name="Notes" id="Notes"></a></p>
<h2><span class="mw-headline">Notes</span></h2>
<ul>
<li>If you use a TeamVehicleFactory "as is" in your custom map, please credit me in the readme file of the map. (<b>SuperApe</b>)</li>
<li>You have to supply spawning effects and sounds, via <a href="../../../../articles/s/c/r/Legacy%7EScriptedTrigger_5316.html" title="Legacy:ScriptedTrigger">ScriptedTrigger</a>, <a href="../../../../articles/e/m/i/Legacy%7EEmitter_1879.html" title="Legacy:Emitter">Emitter</a> and the like. This is meant to allow flexibilty in the ways you want vehicles to spawn. An example VCTF map posted on <a href="http://forums.unrealplayground.com/showthread.php?t=23515" class="external text" title="http://forums.unrealplayground.com/showthread.php?t=23515" rel="nofollow">this UP Forum thread</a> gives my suggestion for spawning particles and sound. (It appears similar to pickup spawning.)</li>
<li>With bAutoSpawn on and without a PreSpawnTime of around 2 seconds, you run the risk of spawning a vehicle before headlights can be properly spawned at map start. Subsequent vehicles after map start will spawn headlights normally.</li>
<li>Turrets that are spawned automatically get an AIController. They are auto turrets; firing at enemies, or if set to neutral (team 255), firing at any non-neutral controlled pawn it detects.</li>
<li>The AS Spacefighters are spawned with a minimum velocity that makes them impractical to use. However, a custom launcher for these is easy to make with a TryToDrive() function.</li>
<li>This has a slightly larger bBlocked check radius than ONSVehicleFactory. ( 1.33&#160;: 1.25 )</li>
</ul>
<p><a name="Properties" id="Properties"></a></p>
<h2><span class="mw-headline">Properties</span></h2>
<p><a name="Main" id="Main"></a></p>
<h3><span class="mw-headline">Main</span></h3>
<dl>
<dt>int TeamNum&#160;</dt>
<dd>Team Number to be set on spawn. 0= red, 1= blue, 255= neutral / none</dd>
<dt>bool bPlayerControl&#160;</dt>
<dd>Only player instigators can trigger.</dd>
<dt>bool bAutoSpawn&#160;</dt>
<dd>Will spawn at regular intervals. The triggering ability is disabled.</dd>
<dt>int RespawnTime&#160;</dt>
<dd>Interval to wait before AutoSpawning.</dd>
</dl>
<dl>
<dt>name PreSpawnEvent&#160;</dt>
<dd>Event to trigger before spawn.</dd>
<dt>int PreSpawnTime&#160;</dt>
<dd>Time before spawn to trigger event. Will begin event this many seconds before the factory is set to AutoSpawn.</dd>
<dt>name SpawnEvent&#160;</dt>
<dd>Event to trigger after spawn. A post spawn event.</dd>
<dt>bool bCrushable&#160;</dt>
<dd>Allow spawning over colliding actors. Note: Turrets will normally spawn in collision with other actors, spawned vehicles will generally move out of the way.</dd>
<dt>int RetrySpawnTime&#160;</dt>
<dd>Interval to wait if bBlocked.</dd>
<dt>bool bRandomFlip&#160;</dt>
<dd>Neutral vehicles may face backwards.</dd>
<dt>bool bRandomSpawn&#160;</dt>
<dd>Will spawn random vehicle class.</dd>
<dt>struct class&lt;<a href="../../../../articles/v/e/h/Legacy%7EVehicle_6bd9.html" title="Legacy:Vehicle">Vehicle</a>&gt; SpawnedVehicle&#160;</dt>
<dd>Selected random vehicle class.</dd>
<dt>array&lt;SpawnedVehicle&gt; RandomVehicles&#160;</dt>
<dd>List for random vehicle spawn.</dd>
</dl>
<p><a name="Hidden" id="Hidden"></a></p>
<h3><span class="mw-headline">Hidden</span></h3>
<dl>
<dt>bool bWaiting&#160;</dt>
<dd>Waiting to spawn.</dd>
<dt>int FactoryTime&#160;</dt>
<dd>Time last spawn. (in Level.TimeSeconds)</dd>
<dt>bool bPreSpawn&#160;</dt>
<dd>Should trigger PreSpawnEvent next.</dd>
</dl>
<p><a name="Code" id="Code"></a></p>
<h2><span class="mw-headline">Code</span></h2>
<div class="hidden-block">
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="hint">&lt;/span&gt;&lt;div <span class="kw5">class</span>=<span class="st0">"hidden"</span>&gt;<span class="co1">//==================================================================================</span>
<span class="co1">// TeamVehicleFactory.</span>
<span class="co1">// Spawn any Vehicle or Turret, set Team, pre &amp; post spawn Events, timing, and more.</span>
<span class="co1">// Glenn 'SuperApe' Storm -- June 2004 -- Updated: July 2005</span>
<span class="co1">//==================================================================================</span>
<span class="kw5">class</span> TeamVehicleFactory <span class="kw5">extends</span> SVehicleFactory
        <span class="kw6">placeable</span>;
 
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        <span class="kw4">int</span>                    TeamNum ;                  <span class="co1">// 0= red, 1= blue, 255= neutral / none</span>
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        <span class="kw4">bool</span>           bPlayerControl ;   <span class="co1">// Only player instigators can trigger</span>
 
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        <span class="kw4">bool</span>           bAutoSpawn ;               <span class="co1">// Will spawn at regular intervals</span>
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        <span class="kw4">int</span>                    RespawnTime ;              <span class="co1">// Interval to wait before AutoSpawning</span>
 
<span class="kw5">var</span>            <span class="kw4">bool</span>           bWaiting ;                 <span class="co1">// About to spawn</span>
<span class="kw5">var</span>            <span class="kw4">int</span>                    FactoryTime     ;               <span class="co1">// Time last spawn</span>
 
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        <span class="kw4">name</span>           PreSpawnEvent ;            <span class="co1">// Event to trigger before spawn</span>
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        <span class="kw4">int</span>                    PreSpawnTime ;             <span class="co1">// Time before spawn to trigger event</span>
<span class="kw5">var</span>            <span class="kw4">bool</span>           bPreSpawn ;                        <span class="co1">// Should trigger PreSpawnEvent next</span>
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        <span class="kw4">name</span>           SpawnEvent ;               <span class="co1">// Event to trigger after spawn</span>
 
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        <span class="kw4">bool</span>           bCrushable ;               <span class="co1">// Allow spawning over colliding actors</span>
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        <span class="kw4">int</span>                    RetrySpawnTime ;   <span class="co1">// Interval to wait if bBlocked</span>
 
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        <span class="kw4">bool</span>           bRandomFlip ;              <span class="co1">// Neutral vehicles may face backwards</span>
 
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        <span class="kw4">bool</span>                                   bRandomSpawn ;             <span class="co1">// Spawn random vehicle class</span>
<span class="kw4">struct</span> SpawnedVehicle
<span class="br0">{</span>
        <span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        class&lt;Vehicle&gt;            SpawnVehicle;           <span class="co1">// Selected random vehicle class</span>
<span class="br0">}</span>;
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        array&lt;SpawnedVehicle&gt;     RandomVehicles ;   <span class="co1">// List for random vehicle spawn</span>
 
 
<span class="kw6">simulated</span> <span class="kw5">function</span> PostBeginPlay<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw6">Super</span>.<span class="me1">PostBeginPlay</span><span class="br0">(</span><span class="br0">)</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> bAutoSpawn <span class="br0">)</span>
                bWaiting = <span class="kw9">true</span>;
                bPreSpawn = <span class="kw9">true</span>;
                <span class="kw1">if</span> <span class="br0">(</span> RespawnTime &gt; <span class="nu0">0</span> <span class="br0">)</span>
                        FactoryTime = <span class="kw8">Level</span>.<span class="me1">TimeSeconds</span> - RespawnTime + PreSpawnTime;
                <span class="kw1">else</span>
                        FactoryTime = <span class="kw8">Level</span>.<span class="me1">TimeSeconds</span> - PreSpawnTime;
<span class="br0">}</span>
 
<span class="kw6">simulated</span> <span class="kw5">event</span> Trigger<span class="br0">(</span> <a href="/Actor"><span class="kw10">Actor</span></a> Other, <a href="/Pawn"><span class="kw10">Pawn</span></a> EventInstigator <span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span> bAutoSpawn <span class="br0">)</span>
                <span class="co1">// bAutoSpawn overrides Trigger</span>
                <span class="kw1">return</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> !EventInstigator.<span class="kw7">IsA</span><span class="br0">(</span><span class="st0">'UnrealPawn'</span><span class="br0">)</span> &amp;&amp; bPlayerControl <span class="br0">)</span>
                <span class="kw1">return</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> VehicleCount &gt;= MaxVehicleCount <span class="br0">)</span>
                <span class="kw1">return</span>;
 
 
        <span class="kw1">if</span> <span class="br0">(</span> VehicleClass == <span class="kw9">None</span> || <span class="br0">(</span> bRandomSpawn &amp;&amp; RandomVehicles.<span class="kw6">length</span> &gt; <span class="nu0">0</span> <span class="br0">)</span> <span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw7">Log</span><span class="br0">(</span><span class="st0">"TeamVehicleFactory:"</span>@<span class="kw8">self</span>@<span class="st0">"has no VehicleClass"</span><span class="br0">)</span>;
                <span class="kw1">return</span>;
        <span class="br0">}</span>
 
        bWaiting = <span class="kw9">true</span>;
        bPreSpawn = <span class="kw9">true</span>;
        <span class="kw1">if</span> <span class="br0">(</span> RespawnTime &gt; <span class="nu0">0</span> <span class="br0">)</span>
                FactoryTime = <span class="kw8">Level</span>.<span class="me1">TimeSeconds</span> - RespawnTime + PreSpawnTime;
        <span class="kw1">else</span>
                FactoryTime = <span class="kw8">Level</span>.<span class="me1">TimeSeconds</span> - PreSpawnTime;
<span class="br0">}</span>
 
<span class="kw6">simulated</span> <span class="kw5">function</span> SpawnItNow<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw5">local</span>  Vehicle         CreatedVehicle;
        <span class="kw5">local</span>  <span class="kw4">bool</span>           bBlocked;
        <span class="kw5">local</span>  <a href="/Pawn"><span class="kw10">Pawn</span></a>              P;
        <span class="kw5">local</span>  <span class="kw4">float</span>          SV;
 
        bBlocked = <span class="kw9">false</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> VehicleClass != <span class="kw9">None</span> || <span class="br0">(</span> bRandomSpawn &amp;&amp; RandomVehicles.<span class="kw6">length</span> &gt; <span class="nu0">0</span> <span class="br0">)</span> <span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw1">if</span> <span class="br0">(</span> bRandomSpawn &amp;&amp; RandomVehicles.<span class="kw6">length</span> &gt; <span class="nu0">0</span> <span class="br0">)</span>
                        VehicleClass = RandomVehicles<span class="br0">[</span> <span class="kw4">int</span><span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> * RandomVehicles.<span class="kw6">length</span> <span class="br0">)</span> <span class="br0">]</span>.<span class="me1">SpawnVehicle</span>;
            <span class="kw1">foreach</span> CollidingActors<span class="br0">(</span><span class="kw5">class</span><span class="st0">'Pawn'</span>, P, VehicleClass.<span class="kw1">default</span>.<span class="me1">CollisionRadius</span> * <span class="nu0">1.33</span><span class="br0">)</span>
                        bBlocked = <span class="kw9">true</span>;
        <span class="br0">}</span>
        <span class="kw1">else</span>
        <span class="br0">{</span>
                <span class="kw7">Log</span><span class="br0">(</span><span class="st0">"TeamVehicleFactory:"</span>@<span class="kw8">self</span>@<span class="st0">"has no VehicleClass"</span><span class="br0">)</span>;
                <span class="kw1">return</span>;
        <span class="br0">}</span>
 
    <span class="kw1">if</span> <span class="br0">(</span> bBlocked &amp;&amp; !bCrushable <span class="br0">)</span>
        <span class="br0">{</span>
                bWaiting = <span class="kw9">true</span>;
                bPreSpawn = <span class="kw9">true</span>;
                <span class="kw1">if</span> <span class="br0">(</span> RespawnTime &gt; <span class="nu0">0</span> <span class="br0">)</span>
                        FactoryTime = <span class="kw8">Level</span>.<span class="me1">TimeSeconds</span> - RespawnTime + RetrySpawnTime + PreSpawnTime;
                <span class="kw1">else</span>
                        FactoryTime = <span class="kw8">Level</span>.<span class="me1">TimeSeconds</span> - RetrySpawnTime + PreSpawnTime;
                <span class="kw1">return</span>;
        <span class="br0">}</span>
    <span class="kw1">else</span>
                <span class="br0">{</span>
                        <span class="kw1">if</span> <span class="br0">(</span> TeamNum == <span class="nu0">255</span> <span class="br0">)</span>
 
                        <span class="br0">{</span>
                                <span class="kw1">if</span> <span class="br0">(</span> bRandomFlip &amp;&amp; <span class="kw7">Rand</span><span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span> == <span class="nu0">1</span> <span class="br0">)</span>
                                        CreatedVehicle = spawn<span class="br0">(</span>VehicleClass, , , Location, Rotation + rot<span class="br0">(</span><span class="nu0">0</span>,<span class="nu0">32768</span>,<span class="nu0">0</span><span class="br0">)</span><span class="br0">)</span>;
                                <span class="kw1">else</span>
                                        CreatedVehicle = spawn<span class="br0">(</span>VehicleClass, , , Location, Rotation<span class="br0">)</span>;
                                <span class="co1">// Unlock neutral vehicles</span>
                                CreatedVehicle.<span class="me1">bTeamLocked</span> = <span class="kw9">false</span>;
                        <span class="br0">}</span>
                        <span class="kw1">else</span>
                                CreatedVehicle = spawn<span class="br0">(</span>VehicleClass, , , Location, Rotation<span class="br0">)</span>;
                        <span class="kw1">if</span> <span class="br0">(</span> CreatedVehicle != <span class="kw9">None</span> <span class="br0">)</span>
                        <span class="br0">{</span>
                                VehicleCount++;
                                CreatedVehicle.<span class="kw5">Event</span> = Tag;
                                CreatedVehicle.<span class="me1">ParentFactory</span> = <span class="kw8">self</span>;
                                CreatedVehicle.<span class="me1">SetTeamNum</span><span class="br0">(</span>TeamNum<span class="br0">)</span>;
                                TriggerEvent<span class="br0">(</span>SpawnEvent, <span class="kw8">self</span>, <span class="kw9">None</span><span class="br0">)</span>;                               
                        <span class="br0">}</span>
                <span class="br0">}</span>
<span class="br0">}</span>
 
<span class="kw5">event</span> VehicleDestroyed<span class="br0">(</span>Vehicle V<span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw6">Super</span>.<span class="me1">VehicleDestroyed</span><span class="br0">(</span>V<span class="br0">)</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> bAutoSpawn <span class="br0">)</span>
        <span class="br0">{</span>
                bWaiting = <span class="kw9">true</span>;
                bPreSpawn = <span class="kw9">true</span>;
                FactoryTime = <span class="kw8">Level</span>.<span class="me1">TimeSeconds</span>;
        <span class="br0">}</span>
<span class="br0">}</span>
 
<span class="kw6">simulated</span> <span class="kw5">function</span> <span class="kw8">Tick</span><span class="br0">(</span><span class="kw4">float</span> DeltaTime<span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span> bWaiting <span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">Level</span>.<span class="me1">TimeSeconds</span> - FactoryTime &lt; RespawnTime - PreSpawnTime <span class="br0">)</span>
                        <span class="kw1">return</span>;
 
                <span class="kw1">if</span> <span class="br0">(</span> VehicleCount &lt; MaxVehicleCount <span class="br0">)</span>
                        <span class="kw1">if</span> <span class="br0">(</span> !bPreSpawn <span class="br0">)</span>
                        <span class="br0">{</span>         
                                <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">Level</span>.<span class="me1">TimeSeconds</span> - FactoryTime &gt;= RespawnTime <span class="br0">)</span>
                                <span class="br0">{</span>
                                        bWaiting = <span class="kw9">false</span>;
                                        FactoryTime = <span class="kw8">Level</span>.<span class="me1">TimeSeconds</span>;
                                        SpawnItNow<span class="br0">(</span><span class="br0">)</span>;
                                <span class="br0">}</span>
                        <span class="br0">}</span>
                        <span class="kw1">else</span>
                        <span class="br0">{</span>
                                bPreSpawn = <span class="kw9">false</span>;
                                TriggerEvent<span class="br0">(</span>PreSpawnEvent, <span class="kw8">self</span>, <span class="kw9">None</span><span class="br0">)</span>;
                        <span class="br0">}</span>
        <span class="br0">}</span>
<span class="br0">}</span>
 
<span class="kw6">simulated</span> <span class="kw5">function</span> Reset<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw5">local</span> Vehicle V;
 
    <span class="kw1">if</span> <span class="br0">(</span> VehicleCount &gt; <span class="nu0">0</span> <span class="br0">)</span>
        <span class="kw1">forEach</span> AllActors <span class="br0">(</span> <span class="kw5">class</span> <span class="st0">'Vehicle'</span>, V <span class="br0">)</span>
            <span class="kw1">if</span> <span class="br0">(</span> V.<span class="me1">ParentFactory</span> == <span class="kw8">self</span> <span class="br0">)</span>
                V.<span class="me1">Destroy</span><span class="br0">(</span><span class="br0">)</span>;
 
    <span class="kw6">Super</span>.<span class="me1">Reset</span><span class="br0">(</span><span class="br0">)</span>;
<span class="br0">}</span></span>
</pre></div>
</div>
<p><a name="External_Links" id="External_Links"></a></p>
<h2><span class="mw-headline">External Links</span></h2>
<ul>
<li><a href="http://forums.unrealplayground.com/showthread.php?t=23515" class="external text" title="http://forums.unrealplayground.com/showthread.php?t=23515" rel="nofollow">Mapping for VCTF</a> – A thread on UnrealPlayground that includes a test map using this actor and suggested spawn EFX.</li>
</ul>
<p><a name="Related_Topics" id="Related_Topics"></a></p>
<h2><span class="mw-headline">Related Topics</span></h2>
<ul>
<li><a href="../../../../articles/m/a/p/Legacy%7EMapping_For_AS_%28UT2004%29_048a.html" title="Legacy:Mapping For AS (UT2004)">Mapping for AS (UT2004)</a></li>
<li><a href="../../../../articles/m/a/p/Legacy%7EMapping_For_ONS_a6c3.html" title="Legacy:Mapping For ONS">Mapping for ONS</a></li>
<li><a href="../../../../articles/m/a/p/Legacy%7EMapping_For_VCTF_e5df.html" title="Legacy:Mapping For VCTF">Mapping for VCTF</a></li>
<li><a href="../../../../articles/s/u/p/Legacy%7ESuperApe_Mapping_For_OSM_Adventure_9f9d.html" title="Legacy:SuperApe/Mapping For OSM Adventure">Mapping for OSM Adventure</a> <i>(Note: A version of TeamVehicleFactory is included in OSMT)</i></li>
<li><a href="../../../../articles/p/a/t/Legacy%7EPathing_For_Vehicles_24aa.html" title="Legacy:Pathing For Vehicles">Pathing For Vehicles</a></li>
<li><a href="../../../../articles/p/a/t/Legacy%7EPathing_2k4_Flying_Vehicles_4ce1.html" title="Legacy:Pathing 2k4 Flying Vehicles">Pathing 2k4 Flying Vehicles</a></li>
<li><a href="../../../../articles/v/e/h/Legacy%7EVehicles_acc3.html" title="Legacy:Vehicles">Vehicles</a> – Hub for all vehicle topics
<ul>
<li><a href="../../../../articles/v/e/h/Legacy%7EVehicle_6bd9.html" title="Legacy:Vehicle">Vehicle</a> – UT2004 parent class for all vehicles and turrets</li>
<li><a href="../../../../articles/v/e/h/Legacy%7EVehicle_Gameplay_2f52.html" title="Legacy:Vehicle Gameplay">Vehicle Gameplay</a> – Placing VehicleFactories for strong <a href="../../../../articles/m/a/p/Legacy%7EMap_Flow_640e.html" title="Legacy:Map Flow">Map Flow</a></li>
</ul>
</li>
</ul>
<p><a name="Discussion" id="Discussion"></a></p>
<h2><span class="mw-headline">Discussion</span></h2>
<p><b>SuperApe</b>: Originally this actor included a bForceAllow option that overrode the Level.bAllowVehicles setting. Since the latest patch to UT2004 moved that check up to SVehicle, that will not work anymore. Alas, that very cool option to include vehicles in any gametype would have to be left out.&#160;:( Now, I offer it as simply a way to get any vehicle class into gametypes which *do* allow vehicles. Enjoy!&#160;:)</p>
<p><b>MythOpus:</b> Why couldn't you just set the bAllowVehicles property through the code?</p>
<p><b>SuperApe:</b> You mean like this?</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw1">if</span> <span class="br0">(</span> !<span class="kw8">Level</span>.<span class="me1">Game</span>.<span class="me1">bAllowVehicles</span> &amp;&amp; bForceAllow <span class="br0">)</span>
    <span class="kw8">Level</span>.<span class="me1">Game</span>.<span class="me1">bAllowVehicles</span> = <span class="kw9">true</span>;
</pre></div>
<p><b>MythOpus:</b> Yes, something like that&#160;:P&#160;:) Good luck.</p>
<p><b>SuperApe:</b> No luck. I believe the new patch for 2k4 moved many of the bAllowVehicle checks either higher in the actor heirarchy, or like into SVehicle itself.</p>
<p><b>SuperApe:</b> A request has been made by a mapper for Red Orchestra to include a Reset() function for this actor. If you have a triggered version of this factory and the map is reset, any outstanding vehicles are still there. Working...</p>
<p><b>SuperApe:</b> I've added the Reset() function that should work fine. In fact, I had difficulty duplicating the problem of a stranded vehicle after map reset. Nevertheless, this Reset() function won't hurt and it may solve the problem for the Red Orchestra mapper.</p>
<p><b>SuperApe:</b> Thanks to a suggestion by ZedMaestro on the BUF, I've added a feature for spawning random vehicle classes. Just set bRandomSpawn = true and the list of possible vehicle classes in RandomVehicles. Also, in relation to the above discussion about forcing to allow vehicles in any gametype, there is a <a href="http://forums.unrealplayground.com/showthread.php?t=34314" class="external text" title="http://forums.unrealplayground.com/showthread.php?t=34314" rel="nofollow">SuperVehicleFactory</a> in testing on the UnrealPlayground forums.</p>
<p><b>VitalOverdose:</b> when i got cut offline i took a whole buch of the most difficult problems from atari forums and wiki and decided to crack each one as i was gonna be ofline for atleast 4months.your teamvehiclefactory idea was on i decided to have a go at.As far as i can see it does everything you specified in the orignal design spec. i was thinking between us we could come up with an ultimate solution but if not np.</p>
<p><b>SuperApe:</b> I think I understand the confusion. The TeamVehicleFactory is not a problem which I am trying to find a solution for, it is a custom actor I've posted on the wiki after testing thoroughly and developing somewhere else. I post it here for others to use at their discretion, as a Third-Party component. If you would like to take the code, use it in a custom map, or even expand on it and modify it for specific purposes, that's fine by me. That's why I posted it here. Just remember, the normal etiquette is to give credit for the source in those situations, either in the map's readme file or the code's initial comment block, or both. If you would like help finding a solution to a problem you're having with your own code, I suggest posting (in brief) the problem's details on the <a href="../../../../articles/h/e/l/Legacy%7EHelp_Desk_e07f.html" title="Legacy:Help Desk">Help Desk</a>. Personally, I wasn't at all clear what you wanted help with. But at any rate, that code didn't belong here in the Discussion of this page. Thanks for moving it.&#160;:)</p>
<p><b>Moofed:</b> I noticed the first vehicle that is spawned from a TeamVehicleFactory doesn't have a HeadlightProjector, but all vehicles afterwards do. Not sure what's causing it.&#160;:-/</p>
<p><b>SuperApe:</b> Hmm. I'm not seeing that bug. Headlights are spawned from the vehicle (ONSVehicle) during PostNetBeginPlay(). Can't think of why your first vehicle wouldn't have them when you jump in.</p>
<p><b>Moofed:</b> Fixed by setting PreSpawnTime=2. I think bDropDetail gets set (and the coronas and projectors not spawned) because the computer is bogged down by the level loading, which happens to be at the same time as the vehicles are spawning when using bAutoSpawn.</p>
<p><b>SuperApe:</b> Ah, that makes more sense. Without including a default spawn effect, that is a potential problem with this script. I didn't see it due to the effects I include in the test map, linked to above. Perhaps I should add the suggested spawn effects as a small block of code. Thanks.&#160;:)</p>
<p><b>SuperApe:</b> I believe the Reset() function does absolutely nothing. Vehicles themselves have their own Reset() functon, so it's redundant, IIRC. I will update the code with defaultproperties and include code for a default spawning Effects class to use with this factory as an option, so that mappers can choose to use custom spawning efx or not.</p>
<p><b>SuperApe:</b> This class is included in <a href="../../../../articles/s/u/p/Legacy%7ESuperApe_Old_Skool_Monsta_Toolz_5e52.html" title="Legacy:SuperApe/Old Skool Monsta Toolz">Old Skool Monsta Toolz</a> and adds the feature of bDefaultEFX, which spawns particles and sounds that indicate the team the vehicle is spawning for and the size of the vehicle about to spawn. I will update the code to match OSMT.TeamVehicleFactory soon.</p>

<!-- 
NewPP limit report
Preprocessor node count: 27/1000000
Post-expand include size: 202/2097152 bytes
Template argument size: 128/2097152 bytes
#ifexist count: 0/100
-->
<div class="printfooter">
</div>
	    <div id="catlinks"><p class='catlinks'><a href="../../../../articles/c/a/t/Special%7ECategories_101d.html" title="Special:Categories">Category</a>: <span dir='ltr'><a href="../../../../articles/l/e/g/Category%7ELegacy_Custom_Class_%28UT2004%29_0b8c.html" title="Category:Legacy Custom Class (UT2004)">Legacy Custom Class (UT2004)</a></span></p></div>	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-legacy"
	       class="selected"	       ><a href="../../../../articles/t/e/a/Legacy%7ETeamVehicleFactory_2f4e.html">Legacy</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../../articles/t/e/a/Legacy_talk%7ETeamVehicleFactory_410b.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://wiki.beyondunreal.com/Legacy:TeamVehicleFactory">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../../misc/uewiki.png);"
	    href="../../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-mainpage"><a href="../../../../index.html">Main Page</a></li>
	     	      <li id="n-portal"><a href="../../../../articles/c/o/m/Unreal_Wiki%7ECommunity_Portal_3311.html">Community portal</a></li>
	     	      <li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt='Attribution-Noncommercial-Share Alike 3.0' /></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 22:00, 19 November 2007 by Anonymous user(s) of Unreal Wiki. </li>	  <li id="f-copyright">Licensed as <a href="../../../../articles/c/o/p/Unreal_Wiki%7ECopyrights_e561.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>	  <li id="f-about"><a href="../../../../articles/a/b/o/Unreal_Wiki%7EAbout_9ce6.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>	  <li id="f-disclaimer"><a href="../../../../articles/g/e/n/Unreal_Wiki%7EGeneral_disclaimer_a0a2.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
