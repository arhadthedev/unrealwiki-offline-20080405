<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- headlinks removed -->
	<link rel="shortcut icon" href="../../../../misc/uewiki-favicon.png"/>
    <title>Legacy:Embedding Code - Unreal Wiki</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../../skins/offline/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/md5.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/utf8.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/lookup.js"></script>
    <script type="text/javascript" src="../../../../articles/-/_/_/-.html"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../../articles/c/o/m/MediaWiki%7ECommon.css_d42e.html";
@import "../../../../articles/m/o/n/MediaWiki%7EMonobook.css_fb19.html";
@import "../../../../articles/-/_/_/-.html";
/*]]>*/</style>          </head>
  <body
    class="ns-100">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Legacy:Embedding Code</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</h3>
	    <div id="contentSub"></div>
	    	    	    <!-- start content -->
	    <p>Since <a href="../../../../articles/m/a/p/Legacy%7EMap_File_0a3c.html" title="Legacy:Map File">Map Files</a> are simply Unreal packages, they can contain all sorts of different resources in addition to geometry and <a href="../../../../articles/t/e/x/Legacy%7ETexture_%28UT%29_9f36.html" title="Legacy:Texture (UT)">Texture (UT)s</a>. That includes UnrealScript code. Rather than including a bunch of small .u files with your map distribution, embed their code into your <a href="../../../../articles/m/a/p/Legacy%7EMap_File_0a3c.html" title="Legacy:Map File">Map Files</a>. Apart from being neater, that'll make a much more professional appearance than a cluttered .zip file.</p>
<p><b>Don't embed code without permission.</b> (That's clear, but unfortunately not to everyone.) Be sure that the code's author is content with having his/her code embedded in maps. Besides, embedding code makes only sense for small code packages, and if being able to do a centralized update of the code package is not an issue.</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Creating_Code_in_MyLevel"><span class="tocnumber">1</span> <span class="toctext">Creating Code in MyLevel</span></a></li>
<li class="toclevel-1"><a href="#Importing_Code_into_MyLevel"><span class="tocnumber">2</span> <span class="toctext">Importing Code into MyLevel</span></a>
<ul>
<li class="toclevel-2"><a href="#...from_a_.u_file"><span class="tocnumber">2.1</span> <span class="toctext">...from a .u file</span></a></li>
<li class="toclevel-2"><a href="#...from_another_map_file"><span class="tocnumber">2.2</span> <span class="toctext">...from another map file</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Updating_Code_in_MyLevel"><span class="tocnumber">3</span> <span class="toctext">Updating Code in MyLevel</span></a></li>
<li class="toclevel-1"><a href="#Related_Topics"><span class="tocnumber">4</span> <span class="toctext">Related Topics</span></a></li>
<li class="toclevel-1"><a href="#Discussion"><span class="tocnumber">5</span> <span class="toctext">Discussion</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Creating_Code_in_MyLevel" id="Creating_Code_in_MyLevel"></a></p>
<h2><span class="mw-headline">Creating Code in MyLevel</span></h2>
<p>You can create new classes in UnrealEd and store them directly into MyLevel. You might want to do this if:</p>
<ul>
<li>you're pasting in a complete script from one of the <a href="../../../../articles/t/h/i/Legacy%7EThird-Party_Components_8ca4.html" title="Legacy:Third-Party Components">Third-Party Components</a> or <a href="../../../../articles/o/p/e/Legacy%7EOpen_Source_43a1.html" title="Legacy:Open Source">Open Source</a> pages</li>
<li>you're daring</li>
<li>you're desperate</li>
</ul>
<p>See <a href="../../../../articles/c/r/e/Legacy%7ECreate_A_Subclass_2675.html" title="Legacy:Create A Subclass">Create A Subclass</a> for instructions.</p>
<p>The usual pitfalls of creating code in UnrealEd apply: Can't delete classes, can't rename classes, can't change a superclass, UnrealEd crashes when you change the property declarations of a class that is used in the map. If you're simply pasting a script (a custom one from this site for example), that's not a problem though.</p>
<p><a name="Importing_Code_into_MyLevel" id="Importing_Code_into_MyLevel"></a></p>
<h2><span class="mw-headline">Importing Code into MyLevel</span></h2>
<p><a name="...from_a_.u_file"></a></p>
<h3><span class="mw-headline">...from a .u file</span></h3>
<p>If you have a pre-existing .u file that you want to import in MyLevel, do it as follows:</p>
<ol>
<li>Make sure that you're not already using that .u file externally in your map; in other words, make the .u file import the first step of using the actors defined in that .u file. <i>If</i> you already have added actors from that .u file in your map, cut them into the clipboard, save your map, and close UnrealEd.</li>
</ol>
<ol>
<li>Make sure that the .u package you're about to import isn't automatically loaded when UnrealEd starts. Check the <tt>EditPackages</tt> lines in <a href="../../../../articles/u/n/r/Legacy%7EUnrealTournament.Ini_74a4.html" title="Legacy:UnrealTournament.Ini">UnrealTournament.ini</a> and delete any line pointing to that .u package if necessary (then restart UnrealEd). Also, place the .u file you would like to import into the \UnrealTournament\System directory.</li>
</ol>
<p>Do <a href="../../../../articles/u/n/r/Legacy%7EUnrealEd_Main_Menu_8ae6.html" title="Legacy:UnrealEd Main Menu">UnrealEd Main Menu</a> -&gt; View -&gt; Log to open the log window or click the button on the <a href="../../../../articles/c/o/n/Legacy%7EConsole_Bar_fd55.html" title="Legacy:Console Bar">Console Bar</a>. At the prompt, enter:</p>
<pre>
obj load file=whatever.u package=MyLevel
</pre>
<p>(substitute "whatever" by the name of the package you want to import, of course). If everything works out, you'll see some log entries along the lines of "New file, existing package." If you made a typo in the file name, UnrealEd crashes (courtesy of the <a href="../../../../articles/u/n/r/Legacy%7EUnrealEd_Goblin_ce02.html" title="Legacy:UnrealEd Goblin">UnrealEd Goblin</a>).</p>
<p><br /></p>
<ol>
<li>If you previously had cut/removed existing actors from that package from your map, paste/re-add them.</li>
</ol>
<ol>
<li>Do a <b>full rebuild,</b> then save.</li>
</ol>
<p><b>Notes:</b> After importing a package in this way, the <a href="../../../../articles/a/c/t/Legacy%7EActor_Browser_2eb9.html" class="mw-redirect" title="Legacy:Actor Browser">actor browser</a> in UnrealEd 2 will not show any imported actors that are direct descendants of actor (and possibly some others deeper in the tree too) unless you first deselect then reselect the <i>Show Actor Classes Only</i> checkbox to force a reload of the tree.</p>
<p>To get imported music to show up in the music browser, click the docked/undocked button and your imported music file will show up.</p>
<p>Only actors that are referenced in the map and their parent classes get saved in <a href="../../../../articles/m/y/l/Legacy%7EMyLevel_3b70.html" title="Legacy:MyLevel">MyLevel</a> with the map so if you have actors that only get spawned in runtime and are in the package you just imported you need to add an example in your map somewhere out of sight so they get stored in MyLevel and can be spawned properly in game. This would apply to projectiles in custom weapon types etc.</p>
<p>Be sure to test your new map on a virgin install of Unreal Tournament that has none of the packages you've imported classes from in it. Otherwise it's dead easy for a reference to something that isn't sucessfully stored in MyLevel to get missed and what you thought would be a triumphant release of your latest project gets off to a bad start when your map crashes the game on load thanks to missing resources...</p>
<p><a name="...from_another_map_file"></a></p>
<h3><span class="mw-headline">...from another map file</span></h3>
<p>Some authors distribute their scripts already embedded in <a href="../../../../articles/m/a/p/Legacy%7EMap_File_0a3c.html" title="Legacy:Map File">Map Files</a>. To use them (the "with permission" clause above applies, of course), do the following:</p>
<ol>
<li>Restart UnrealEd. (Always a good idea before working with <a href="../../../../articles/m/y/l/Legacy%7EMyLevel_3b70.html" title="Legacy:MyLevel">MyLevel</a>.)</li>
<li>Open the map file that contains the code you want to import.</li>
<li>Without closing UnrealEd, open your own map file you want to import the code into.</li>
</ol>
<p>UnrealEd doesn't remove the code classes from the first map file you opened when you open the second one; if you use any of those classes in your own map, they will automatically be saved along with your map.</p>
<dl>
<dd><b>Tip:</b> If you're planning to distribute your <i>own</i> code via the second method (which is handy because it <i>forces</i> mappers to embed the code into their maps rather than bundling an .u file), be sure that you <b>only place code</b> in your distribution map's MyLevel. UnrealEd is prone to crashing if there are, for instance, <a href="../../../../articles/t/e/x/Legacy%7ETexture_7ee5.html" title="Legacy:Texture">Textures</a> left from a previously loaded map file in MyLevel when the user loads his/her own map after yours.</dd>
</dl>
<p><a name="Updating_Code_in_MyLevel" id="Updating_Code_in_MyLevel"></a></p>
<h2><span class="mw-headline">Updating Code in MyLevel</span></h2>
<p>Sometimes you might have to update the code of components embedded in <a href="../../../../articles/m/y/l/Legacy%7EMyLevel_3b70.html" title="Legacy:MyLevel">MyLevel</a>.</p>
<ol>
<li>Open the map the code is embedded in.</li>
<li>In the <a href="../../../../articles/a/c/t/Legacy%7EActor_Browser_2eb9.html" class="mw-redirect" title="Legacy:Actor Browser">actor browser</a>, browse to the embedded actor class and double-click it. A script editor window with the component's source code opens.</li>
<li>Select all of the old source code in the script editor window and delete it.</li>
<li>Copy all of the new source code <b>up to, but not including</b> the <code>defaultproperties</code> section (if there is one).</li>
<li>Paste the copied source code into the script editor window (click into the empty window and press Ctrl+V).</li>
<li>Select <i>Tools</i> -&gt; <i>Compile Changed</i> from the script editor's menu. After a brief processing delay, the script editor's status bar says something along the lines of "Success: Compiled xx line(s), xx statement(s)." (You might have to move the script editor window up a bit in order to see its status bar.)</li>
<li>Save your map.</li>
</ol>
<p><a name="Related_Topics" id="Related_Topics"></a></p>
<h2><span class="mw-headline">Related Topics</span></h2>
<ul>
<li><a href="../../../../articles/w/r/i/Legacy%7EWriting_And_Using_An_Embedded_Mutator_7ab9.html" title="Legacy:Writing And Using An Embedded Mutator">Writing_And_Using_An_Embedded_Mutator</a></li>
</ul>
<p><a name="Discussion" id="Discussion"></a></p>
<h2><span class="mw-headline">Discussion</span></h2>
<p><b>SabbathCat:</b> Models can be imported too!! I've not tried with anything more complex than simple decorations, but you can definitely do it.&#160;:) So cool, no worries about "version mismatch". I had a bunch of flagbase meshes I was always including with my maps, but keeping track of which version was out with which map can be difficult. What a great solution to package everything into the map.&#160;:)</p>
<p><b>Foxpaw:</b> Yes, you should be able to package anything into a map including code, textures, sounds, models, static meshes, and prefabs. Like it says above a map is just a package like any other. In theory you could probrably even package multiple maps into a package, but you might need a third party application to do that and I'm not sure how you would go about loading the different maps.</p>
<p><b>Wormbo:</b> Loading a map into a map? Should be possible through <code>OBJ LOAD File=..\Maps\TheMap.ut2 Package=myLevel</code>, but I doubt this works without crashing or rendering the existing map useless.</p>
<p><b>Mychaeel:</b> The map loading code probably either assumes that all objects in a map file belong to the same map, or it always just loads all those objects connected to the first LevelInfo object it finds in the map file. While it should be possible to <i>store</i> two maps in the same Unreal package without problems, I strongly suppose it's not actually possible to <i>use</i> those packages without some native code changes.</p>
<p><b>SabbathCat:</b> There's a pitfall.. I recently embedded a bunch of mesh files and one music file, all well and good, the map plays and runs without a glitch, but now when I open it in the editor, I just get a blank screen.&#160;:(</p>
<p>It may perhaps be the music thing, The imported music didn't show up until I loaded another music package, I could then the MyLevel.musicname track to apply in the level properties.</p>
<p>Is it best to do all your importing once the map is near complete?</p>
<p>ah well, on the up side of course you could consider this an excellent way to safeguard maps from being re-built or plundered without permission.&#160;:)</p>
<p>Maybe I should try impoting the map into a new map?</p>
<p><b>inio:</b> blank viewports or one big white screen? if it's the later, do viewports-&gt;configure-&gt;ok</p>
<p><b>Wormbo:</b> Music package? You're talking about UT, right? Blank screen problem in UEd is described on <a href="../../../../articles/u/n/r/Legacy%7EUnrealEd_Viewport_4e72.html" title="Legacy:UnrealEd Viewport">UnrealEd viewport</a>.</p>
<p><b>SabbathCat:</b> Er, no.&#160;:) A blank screen as in a totally empty map. I stuck back all the .u files I'd removed from the system directory and the .umx in the music directory post-import, and it opened again.</p>
<p><b>Ch3z:</b> This is very helpful. Answered my question. A related topics section could help too. I now wonder how to call the mutator I embedded into action. A link in the related topics secton to a page that explained that would be perfect.</p>
<p><b>Foxpaw:</b> I'm not sure if there's a wiki page on it or not, but if you want to embed a mutator you will probrably need to also make a custom actor to load the mutator. You can then embed the actor and place one on your map. That actor can load the mutator in it's postbeginplay function and then destroy itself once the mutator is loaded.</p>
<p><b>Ch3z:</b> Thx Fox. And I knew I had seen more on this somewhere. Finally came across it again and addeed "Related" section.</p>
<p><b>Jimbo:</b> I've imported a vertex mesh into mylevel in UT2003 using the aforementioned procedure and it works quite fine. Strangely however, the mesh is not visible over netplay to the client who connects to me. I still see the mesh but he doesn't. If he disconnects from me and runs his own server or just plays an instant action match, the mesh is visible. Anyone have any ideas what might be causing this problem?</p>
<p><b>Kamek:</b> Can OGG files be embedded into maps?</p>
<p><b>Wormbo:</b> No. They are no package files themselves and UT200x doesn't provide any option to import generic binary files into packages.</p>
<p><b>Solace:</b> I noticed, in my 2004 editor, if I want to import an existing .u to MyLevel, I can type "obj load file=whatever.u package=MyLevel" twice in a row, and I don't have to do the cutting/pasting/ect thing to make it work. Quite a time saver, if it works for anyone else.</p>
<p><b>MythOpus:</b> It states on this page that you can't delete classes. Apparently though, classes in MyLevel will remove themselves if they aren't in the map. Can someone confirm this?</p>
<p><b>SuperApe:</b> It sounds like you're referring to when an embedded object is resident in one map, then on load of another, it "is removed". If the question is, "Does the embedded object remain after the next map loads?", my guess is no. But I haven't confirmed.</p>
<p><b>Wormbo:</b> "Can't delete" refers to the lack of an explicit delete feature, like there is for textures, sounds or static meshes. The implicit deleting (or better: not saving) of classes and other objects in the myLevel package is a feature of UnrealEd. To get rid of unwanted embedded stuff you simply need to make sure it's no longer referenced by the level, then save the level and restart UnrealEd.</p>
<p><b>MythOpus:</b> Well, its a great feature then. I afraid the 5 custom pressure volume classes that I made and didn't work would be stuck in the map forever.</p>

<!-- 
NewPP limit report
Preprocessor node count: 18/1000000
Post-expand include size: 28/2097152 bytes
Template argument size: 0/2097152 bytes
#ifexist count: 0/100
-->
<div class="printfooter">
</div>
	    <div id="catlinks"><p class='catlinks'><a href="../../../../articles/c/a/t/Special%7ECategories_101d.html" title="Special:Categories">Categories</a>: <span dir='ltr'><a href="../../../../articles/l/e/g/Category%7ELegacy_Mapping_ae48.html" title="Category:Legacy Mapping">Legacy Mapping</a></span> | <span dir='ltr'><a href="../../../../articles/l/e/g/Category%7ELegacy_Tutorial_261e.html" title="Category:Legacy Tutorial">Legacy Tutorial</a></span></p></div>	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-legacy"
	       class="selected"	       ><a href="../../../../articles/e/m/b/Legacy%7EEmbedding_Code_735c.html">Legacy</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../../articles/e/m/b/Legacy_talk%7EEmbedding_Code_ffe9.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://wiki.beyondunreal.com/Legacy:Embedding_Code">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../../misc/uewiki.png);"
	    href="../../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-mainpage"><a href="../../../../index.html">Main Page</a></li>
	     	      <li id="n-portal"><a href="../../../../articles/c/o/m/Unreal_Wiki%7ECommunity_Portal_3311.html">Community portal</a></li>
	     	      <li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt='Attribution-Noncommercial-Share Alike 3.0' /></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 23:26, 20 September 2007 by Anonymous user(s) of Unreal Wiki. Based on work by Unreal Wiki user(s) <a href="../../../../articles/w/o/r/User%7EWormbo_7d13.html" title="User:Wormbo">Wormbo</a>.</li>	  <li id="f-copyright">Licensed as <a href="../../../../articles/c/o/p/Unreal_Wiki%7ECopyrights_e561.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>	  <li id="f-about"><a href="../../../../articles/a/b/o/Unreal_Wiki%7EAbout_9ce6.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>	  <li id="f-disclaimer"><a href="../../../../articles/g/e/n/Unreal_Wiki%7EGeneral_disclaimer_a0a2.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
