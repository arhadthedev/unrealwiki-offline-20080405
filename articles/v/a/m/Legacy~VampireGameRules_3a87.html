<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- headlinks removed -->
	<link rel="shortcut icon" href="../../../../misc/uewiki-favicon.png"/>
    <title>Legacy:VampireGameRules - Unreal Wiki</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../../skins/offline/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/md5.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/utf8.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/lookup.js"></script>
    <script type="text/javascript" src="../../../../articles/-/_/_/-.html"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../../articles/c/o/m/MediaWiki%7ECommon.css_d42e.html";
@import "../../../../articles/m/o/n/MediaWiki%7EMonobook.css_fb19.html";
@import "../../../../articles/-/_/_/-.html";
/*]]>*/</style>          </head>
  <body
    class="ns-100">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Legacy:VampireGameRules</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</h3>
	    <div id="contentSub"></div>
	    	    	    <!-- start content -->
	    <div class="infobox infobox-class infobox-legacy"><a href="../../../../articles/u/t/2/Legacy%7EUT2003_f97b.html" class="mw-redirect" title="Legacy:UT2003">UT2003</a>&#160;:: <a href="../../../../articles/a/c/t/Legacy%7EActor_5985.html" title="Legacy:Actor">Actor</a> &gt;&gt; <a href="../../../../articles/i/n/f/Legacy%7EInfo_6292.html" title="Legacy:Info">Info</a> &gt;&gt; <a href="../../../../articles/g/a/m/Legacy%7EGameRules_2d19.html" title="Legacy:GameRules">GameRules</a> &gt;&gt; VampireGameRules (Package: XGame)</div>
<p>The VampireGameRules augments the damage dealing process in the game allowing for the damage you deal to another <a href="../../../../articles/p/a/w/Legacy%7EPawn_d11f.html" title="Legacy:Pawn">Pawn</a> (that is not on your team) to be transfered to your life total (at a certain ratio).</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Properties"><span class="tocnumber">1</span> <span class="toctext">Properties</span></a></li>
<li class="toclevel-1"><a href="#Variables"><span class="tocnumber">2</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1"><a href="#Methods"><span class="tocnumber">3</span> <span class="toctext">Methods</span></a></li>
<li class="toclevel-1"><a href="#Known_Subclases"><span class="tocnumber">4</span> <span class="toctext">Known Subclases</span></a></li>
<li class="toclevel-1"><a href="#Code_Walkthrough."><span class="tocnumber">5</span> <span class="toctext">Code Walkthrough.</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Properties" id="Properties"></a></p>
<h2><span class="mw-headline">Properties</span></h2>
<dl>
<dt>ConversionRatio = 0.500000</dt>
</dl>
<p><a name="Variables" id="Variables"></a></p>
<h2><span class="mw-headline">Variables</span></h2>
<dl>
<dt>ConversionRatio</dt>
</dl>
<p><a name="Methods" id="Methods"></a></p>
<h2><span class="mw-headline">Methods</span></h2>
<dl>
<dt>int NetDamage( int OriginalDamage, int Damage, <a href="../../../../articles/p/a/w/Legacy%7EPawn_d11f.html" title="Legacy:Pawn">pawn</a> injured, <a href="../../../../articles/p/a/w/Legacy%7EPawn_d11f.html" title="Legacy:Pawn">pawn</a> instigatedBy, <a href="../../../../articles/v/e/c/Legacy%7EVector_fa11.html" title="Legacy:Vector">vector</a> HitLocation, out <a href="../../../../articles/v/e/c/Legacy%7EVector_fa11.html" title="Legacy:Vector">vector</a> Momentum, class&lt;<a href="../../../../articles/d/a/m/Legacy%7EDamageType_c81e.html" title="Legacy:DamageType">DamageType</a>&gt; DamageType )&#160;</dt>
<dd>Augments the damage dealing process by giving health back to the <a href="../../../../articles/p/a/w/Legacy%7EPawn_d11f.html" title="Legacy:Pawn">Pawn</a> that has damaged another valid pawn.</dd>
</dl>
<p><a name="Known_Subclases" id="Known_Subclases"></a></p>
<h2><span class="mw-headline">Known Subclases</span></h2>
<dl>
<dt>None</dt>
</dl>
<hr />
<p><a name="Code_Walkthrough." id="Code_Walkthrough."></a></p>
<h2><span class="mw-headline">Code Walkthrough.</span></h2>
<p>I thought that these would be useful examples to further demonstrate writing a <a href="../../../../articles/g/a/m/Legacy%7EGameRules_2d19.html" title="Legacy:GameRules">GameRules</a> for your game.</p>
<p>I've broken the code into two parts. Lets take a look at the <i>NetDamage</i> function first.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">class</span> VampireGameRules <span class="kw5">extends</span> GameRules;
 
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span> <span class="kw4">float</span> ConversionRatio;
 
<span class="kw5">function</span> <span class="kw4">int</span> NetDamage<span class="br0">(</span> <span class="kw4">int</span> OriginalDamage, <span class="kw4">int</span> Damage, <a href="/Pawn"><span class="kw10">pawn</span></a> injured, <a href="/Pawn"><span class="kw10">pawn</span></a> instigatedBy, <span class="kw4">vector</span> HitLocation, <span class="kw6">out</span> <span class="kw4">vector</span> Momentum, class&lt;DamageType&gt; <a href="/DamageType"><span class="kw10">DamageType</span></a> <span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span> NextGameRules != <span class="kw9">None</span> <span class="br0">)</span>
                <span class="kw1">return</span> NextGameRules.<span class="me1">NetDamage</span><span class="br0">(</span> OriginalDamage,Damage,injured,instigatedBy,HitLocation,Momentum,<a href="/DamageType"><span class="kw10">DamageType</span></a> <span class="br0">)</span>;
        <span class="kw1">if</span> <span class="br0">(</span> <span class="br0">(</span>InstigatedBy != Injured<span class="br0">)</span> &amp;&amp; <span class="br0">(</span>InstigatedBy != <span class="kw9">None</span><span class="br0">)</span> &amp;&amp; <span class="br0">(</span>InstigatedBy.<span class="me1">Health</span> &gt; <span class="nu0">0</span><span class="br0">)</span> 
                &amp;&amp; <span class="br0">(</span>InstigatedBy.<span class="me1">PlayerReplicationInfo</span> != <span class="kw9">None</span><span class="br0">)</span> &amp;&amp; <span class="br0">(</span>Injured.<span class="me1">PlayerReplicationInfo</span> != <span class="kw9">None</span><span class="br0">)</span> 
                &amp;&amp; <span class="br0">(</span><span class="br0">(</span>InstigatedBy.<span class="me1">PlayerReplicationInfo</span>.<span class="me1">Team</span> == <span class="kw9">None</span><span class="br0">)</span> || <span class="br0">(</span>InstigatedBy.<span class="me1">PlayerReplicationInfo</span>.<span class="me1">Team</span> != Injured.<span class="me1">PlayerReplicationInfo</span>.<span class="me1">Team</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">)</span>
                InstigatedBy.<span class="me1">Health</span> = <span class="kw7">Min</span><span class="br0">(</span> InstigatedBy.<span class="me1">Health</span>+Damage*ConversionRatio, <span class="kw7">Max</span><span class="br0">(</span>InstigatedBy.<span class="me1">Health</span>,InstigatedBy.<span class="me1">HealthMax</span><span class="br0">)</span> <span class="br0">)</span>;
        <span class="kw1">return</span> Damage;
<span class="br0">}</span>
</pre></div>
<p>The block of code handles two things: Allows the other GameRules modifiers to go first; Calculates the amount of damage that the Instagator recieves back as health.</p>
<blockquote class="legacyquote">
<p>This <a href="../../../../articles/g/a/m/Legacy%7EGameRules_2d19.html" title="Legacy:GameRules">GameRules</a> allows all other GameRules to affect the <i>NetDamage</i> before it augments the damage in play. If you neglect giving the other GameRules a chance to augment <i>NetDamage</i>, then all other GameRules loaded after this GameRules will not have a chance to augment play.</p>
</blockquote>
<p>The logic is long but not too complicated. I'll briefly explain it.</p>
<p>If the pawn instigating the damage didn't hurt themselves, does exists, is still alive, has <a href="../../../../articles/p/l/a/Legacy%7EPlayerReplicationInfo_be80.html" title="Legacy:PlayerReplicationInfo">PlayerReplicationInfo</a>, his target has it as well, and is not on a team or hit someone not on his team, then calculate the health returned.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
InstigatedBy.<span class="me1">Health</span> = <span class="kw7">Min</span><span class="br0">(</span> InstigatedBy.<span class="me1">Health</span>+Damage*ConversionRatio, <span class="kw7">Max</span><span class="br0">(</span>InstigatedBy.<span class="me1">Health</span>,InstigatedBy.<span class="me1">HealthMax</span><span class="br0">)</span> <span class="br0">)</span>;
</pre></div>
<p>This health increase is the smallest value of either the Instigator's Health plus damange, at the conversion ratio, or the maximum value of either the Instigator's Health or MaxHealth.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="co1">//</span>
<span class="co1">// server querying</span>
<span class="co1">//</span>
<span class="kw5">function</span> GetServerDetails<span class="br0">(</span> <span class="kw6">out</span> GameInfo.<span class="me1">ServerResponseLine</span> ServerState <span class="br0">)</span>
<span class="br0">{</span>
        <span class="co1">// append the gamerules name- only used if mutator adds me and deletes itself.</span>
        <span class="kw5">local</span> <span class="kw4">int</span> i;
        i = ServerState.<span class="me1">ServerInfo</span>.<span class="kw6">Length</span>;
        ServerState.<span class="me1">ServerInfo</span>.<span class="kw6">Length</span> = i<span class="nu0">+1</span>;
        ServerState.<span class="me1">ServerInfo</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">Key</span> = <span class="st0">"Mutator"</span>;
        ServerState.<span class="me1">ServerInfo</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">Value</span> = GetHumanReadableName<span class="br0">(</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw1">defaultproperties</span>
<span class="br0">{</span>
     ConversionRatio=<span class="nu0">0.500000</span>
<span class="br0">}</span>
</pre></div>
<p>This increases the array that stores the ServerInfo by one and appends the key Mutator and the name of the Mutator. This is in the event that the Vampire Mutator was used to load this GameRule and then has deleted itself.</p>
<hr />
<p><b>Burtlo:</b> Thought I would use the subclasses as a great oppurtunity to show how <a href="../../../../articles/g/a/m/Legacy%7EGameRules_2d19.html" title="Legacy:GameRules">GameRules</a> work.</p>

<!-- 
NewPP limit report
Preprocessor node count: 28/1000000
Post-expand include size: 566/2097152 bytes
Template argument size: 449/2097152 bytes
#ifexist count: 0/100
-->
<div class="printfooter">
</div>
	    <div id="catlinks"><p class='catlinks'><a href="../../../../articles/c/a/t/Special%7ECategories_101d.html" title="Special:Categories">Category</a>: <span dir='ltr'><a href="../../../../articles/l/e/g/Category%7ELegacy_Class_%28UT2003%29_1edb.html" title="Category:Legacy Class (UT2003)">Legacy Class (UT2003)</a></span></p></div>	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-legacy"
	       class="selected"	       ><a href="../../../../articles/v/a/m/Legacy%7EVampireGameRules_3a87.html">Legacy</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../../articles/v/a/m/Legacy_talk%7EVampireGameRules_b847.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://wiki.beyondunreal.com/Legacy:VampireGameRules">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../../misc/uewiki.png);"
	    href="../../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-mainpage"><a href="../../../../index.html">Main Page</a></li>
	     	      <li id="n-portal"><a href="../../../../articles/c/o/m/Unreal_Wiki%7ECommunity_Portal_3311.html">Community portal</a></li>
	     	      <li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt='Attribution-Noncommercial-Share Alike 3.0' /></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 21:57, 11 August 2003 by Anonymous user(s) of Unreal Wiki. </li>	  <li id="f-copyright">Licensed as <a href="../../../../articles/c/o/p/Unreal_Wiki%7ECopyrights_e561.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>	  <li id="f-about"><a href="../../../../articles/a/b/o/Unreal_Wiki%7EAbout_9ce6.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>	  <li id="f-disclaimer"><a href="../../../../articles/g/e/n/Unreal_Wiki%7EGeneral_disclaimer_a0a2.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
