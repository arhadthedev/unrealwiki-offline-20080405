<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- headlinks removed -->
	<link rel="shortcut icon" href="../../../../misc/uewiki-favicon.png"/>
    <title>Legacy:LadderQuery - Unreal Wiki</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../../skins/offline/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/md5.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/utf8.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/lookup.js"></script>
    <script type="text/javascript" src="../../../../articles/-/_/_/-.html"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../../articles/c/o/m/MediaWiki%7ECommon.css_d42e.html";
@import "../../../../articles/m/o/n/MediaWiki%7EMonobook.css_fb19.html";
@import "../../../../articles/-/_/_/-.html";
/*]]>*/</style>          </head>
  <body
    class="ns-100">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Legacy:LadderQuery</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</h3>
	    <div id="contentSub"></div>
	    	    	    <!-- start content -->
	    <div class="infobox infobox-class infobox-legacy"><a href="../../../../articles/u/t/2/Legacy%7EUT2003_f97b.html" class="mw-redirect" title="Legacy:UT2003">UT2003</a>&#160;:: <a href="../../../../articles/o/b/j/Legacy%7EObject_f294.html" title="Legacy:Object">Object</a> &gt;&gt; XAdminBase &gt;&gt; xWebQueryHandler &gt;&gt; LadderQuery (<a href="../../../../articles/l/a/d/Legacy%7ELadder1.46_a0ee.html" title="Legacy:Ladder1.46">Ladder1.46</a>)</div>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<div class="source-uscript" style="font-family: monospace;">
<ol>
<li class="li1">
<div class="de1"><span class="co1">//-----------------------------------------------------------</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// &#160;Ladder.LadderQuery</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// &#160;QueryHandler for webadmin interface</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//-----------------------------------------------------------</span></div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">class</span> LadderQuery <span class="kw5">extends</span> xWebQueryHandler</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw6">DependsOn</span><span class="br0">(</span>ProfileConfigSet<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw6">config</span><span class="br0">(</span>System<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">const</span> LOGNAME&#160; &#160;&#160; &#160; &#160; &#160; = <span class="st0">'LadderQuery'</span>;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">const</span> EPICNUMBER &#160; &#160;= <span class="nu0">85</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> LadderGameRules LadderRules;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Profile Tracking Variables</span></div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> SessionMaster &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SMaster;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> ConfigMaster&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ConfigM;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw4">string</span> &#160; &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EpicPackages<span class="br0">[</span>EPICNUMBER<span class="br0">]</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Active Profile Variables</span></div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> StringArray &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileMaps;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> ProfileExporter&#160; &#160; &#160;&#160; &#160; &#160; &#160; ExportMaster;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> ProfileConfigSet &#160; &#160;CurrentProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> StringArray &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileMutators;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; DefaultProfileName;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Physical page that will be served</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; MasterPage;&#160; &#160; &#160;<span class="co1">// This is main html page for Ladder</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; SubFrame;&#160; &#160; &#160; &#160;<span class="co1">// Manage sub-frame</span></div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; SubFrameMenu;&#160; &#160;<span class="co1">// Sub-menu (GameType, Mutators, Maps, PlayInfo, Review)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; SubFrameContent;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Include Files</span></div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; IncludeTable;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; IncludeSection;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; IncludeRows;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; IncludeCaptionButton;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; IncludeMapSelect;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; IncludeProfileName;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; IncludeGameType;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; IncludeCheckBox;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; IncludeSwitch;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// Virtual paths that will be requested from clients</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span> &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileViewURI;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span> &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileEditURI;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span> &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileMenuURI;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span> &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileSwitchURI;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; ProfileManageURI;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; SubFrameURI;&#160; &#160; <span class="co1">// accessed through manage link - linked to SubFrame page</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; SubFrameMenuURI;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span> &#160; &#160; &#160; &#160; &#160; &#160; &#160; SubMapsURI;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span> &#160; &#160; &#160; &#160; &#160; &#160; &#160; SubSavedURI;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span> &#160; &#160; &#160; &#160; &#160; &#160; &#160; SubRulesURI;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span> &#160; &#160; &#160; &#160; &#160; &#160; &#160; SubReviewURI;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span> &#160; &#160; &#160; &#160; &#160; &#160; &#160; SubGametypeURI;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span> &#160; &#160; &#160; &#160; &#160; &#160; &#160; SubMutatorsURI;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; SubImportURI;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">config</span> <span class="kw4">string</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; SubExportURI;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Localized Page Help texts</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;HelpViewProfile;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;HelpEditProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;HelpSwitchProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;HelpManageProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;HelpImportProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;HelpExportProfile;</div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// Subpage help text</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; HelpGameType;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; HelpMutators;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; HelpMaps;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; HelpPlayInfo;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; HelpReview;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Localized Menu Link Text</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;LinkEditProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;LinkViewProfile;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;LinkSwitchProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;LinkManageProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;LinkImportProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;LinkExportProfile;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// for AddProfilePage/ManageProfilePage</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;TableTitle<span class="br0">[</span><span class="nu0">9</span><span class="br0">]</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;PageCaption<span class="br0">[</span><span class="nu0">9</span><span class="br0">]</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;ProfileButtonName<span class="br0">[</span><span class="nu0">9</span><span class="br0">]</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;ProfileButtonValue<span class="br0">[</span><span class="nu0">9</span><span class="br0">]</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Section Headers &amp; Text</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; MapText;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorText;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; MutatorText;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;RequiredText;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; AvailableText;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; UnlimitedText;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; FollowingMaps;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; AreAssignedText;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; AreAvailableText;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; FollowingMutators;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; CommandLineOptionsTitle;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Button Values</span></div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;ButtonLoadProfile;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Label for "switch immediately" button</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ButtonDeleteProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ButtonPreviewProfile;&#160; &#160;&#160; &#160; &#160; &#160; <span class="co1">// Label for previewing remote profile button</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ButtonApplyImportProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ButtonApplyExportProfile;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ButtonApplyProfileChanges;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Input form labels</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelCopyProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelDeleteProfile;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelImportProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelExportProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelAddProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelSelectActions;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelTextboxActions;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelPlayInfo;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelGeneralProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelGameType;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelProfileName;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelAccessControl;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelChooseAction;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelManagement;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelInputDescription;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;LabelMaxMaps;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;LabelNumberGames;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelCheckAllMap;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelRequiredMaps;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelUncheckAllMap;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;LabelChangeMaplist;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelCheckAllMutator;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelRequiredMutators;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelNumberMatchesLeft;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelUncheckAllMutator;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelDelayProfileChange;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelApplyImportProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelApplyExportProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; LabelModifyProfile;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// Success Messages</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; SuccessText;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; SuccessDeleteProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; SuccessExportProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; SuccessImportProfile;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; SuccessImportProfileTitle;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; SuccessCopyProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; SuccessSwitchProfile;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Profile Errors</span></div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorLoadingPlayInfoText<span class="br0">[</span><span class="nu0">5</span><span class="br0">]</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorGameRulesNotFound;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorGameClassText;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorGameClassTitle;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorAccessControlText;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorAccessControlTitle;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span> &#160; &#160;ErrorSameProfileName;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorRemoteMutator;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorRemoteServerActor;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorSavingProfile;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorDeletingProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorExportingProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorNoProfilesExist;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorCopyFrom;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorCopyNoName;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorExcludeMapNotFound;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorIncludeMapNotFound;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorReplacingWebConnection;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ImportClassSpawnError;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ImportProfileFailText;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ImportProfileFailTitle;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Import errors</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorBind;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorBadURL;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorServer;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorResolve;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorTimeout;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorNotFound;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorForbidden;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorBadRequest;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">var</span> <span class="kw6">localized</span> <span class="kw4">string</span>&#160; &#160; ErrorUnauthorized;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> <span class="kw4">bool</span> Init<span class="br0">(</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> GameRules GR;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>GR=<span class="kw8">Level</span>.<span class="me1">Game</span>.<span class="me1">GameRulesModifiers</span>;GR!=<span class="kw9">None</span>;GR=GR.<span class="me1">NextGameRules</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderGameRules<span class="br0">(</span>GR<span class="br0">)</span>&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; LadderRules = LadderGameRules<span class="br0">(</span>GR<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderRules == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Cleanup<span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">false</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ConfigM == <span class="kw9">None</span> &amp;&amp; ConfigMaster<span class="br0">(</span><span class="kw8">Level</span>.<span class="me1">Game</span>.<span class="me1">BaseMutator</span>.<span class="me1">NextMutator</span><span class="br0">)</span>&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ConfigM = ConfigMaster<span class="br0">(</span><span class="kw8">Level</span>.<span class="me1">Game</span>.<span class="me1">BaseMutator</span>.<span class="me1">NextMutator</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; GetCurrentConfigSet<span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; ExportMaster &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; = <span class="kw6">new</span> <span class="kw5">class</span><span class="st0">'ProfileExporter'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; DefaultProfileName &#160; &#160; &#160;&#160; &#160; &#160; &#160; = LadderRules.<span class="me1">DefaultProfileName</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; SMaster &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SessionMaster'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; ProfileMaps &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; ProfileMutators &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">Assert</span><span class="br0">(</span><span class="kw8">Level</span>.<span class="me1">Game</span>.<span class="me1">AccessControl</span>&#160;!= <span class="kw9">None</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//////////////////////////////////////////////////////////////</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//////////////////////////////////////////////////////////////</span></div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// Session Manipulation Functions</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Load profile information into session object</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> CreateSessionInfo<span class="br0">(</span><span class="kw6">coerce</span> <span class="kw4">int</span> ProfileIndex, <span class="kw4">string</span> SID, <span class="kw6">optional</span> <span class="kw4">bool</span> bIncludeNonActive, <span class="kw6">optional</span> <span class="kw4">bool</span> bSave, <span class="kw6">optional</span> <span class="kw4">bool</span> bQuiet<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; i;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; <span class="kw5">local</span> Session &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> &#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; <span class="kw5">local</span> array&lt;string&gt; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempArr;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; <span class="kw5">local</span> ProfileConfigSet &#160; &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; <span class="kw5">local</span> array&lt;ProfileConfigSet.<span class="me1">ProfileMutator</span>&gt; &#160; &#160; &#160; &#160;AllPCSMutators;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; <span class="kw5">local</span> array&lt;ProfileConfigSet.<span class="me1">ProfileMap</span>&gt; &#160; &#160;&#160; &#160; &#160; &#160; AllPCSMaps;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; <span class="kw5">local</span> array&lt;ProfileConfigSet.<span class="me1">ProfileSA</span>&gt; AllPCSServerActors;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>SID == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>SID,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; TempPCS = LadderRules.<span class="me1">LadderProfiles</span><span class="br0">[</span>ProfileIndex<span class="br0">]</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; TempPCS.<span class="me1">StartEdit</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// General profile information</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"ProfileIndex"</span>, <span class="kw4">string</span><span class="br0">(</span>ProfileIndex<span class="br0">)</span>, <span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span>,LadderRules.<span class="me1">Profiles</span><span class="br0">[</span>ProfileIndex<span class="br0">]</span>.<span class="me1">ProfileName</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"GameType"</span>, <span class="kw4">string</span><span class="br0">(</span>TempPCS.<span class="me1">GetGameClass</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>, <span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"ACClass"</span>, TempPCS.<span class="me1">GetAccessControl</span><span class="br0">(</span><span class="br0">)</span>, <span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"MaxMaps"</span>, <span class="kw4">string</span><span class="br0">(</span>TempPCS.<span class="me1">GetMaxMaps</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>, <span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; AllPCSMutators = TempPCS.<span class="me1">GetProfileMutators</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; AllPCSMaps = TempPCS.<span class="me1">GetProfileMaps</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; AllPCSServerActors = TempPCS.<span class="me1">GetProfileServerActors</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; TempArr = LadderRules.<span class="me1">GetProfileMutators</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>ProfileIndex<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; TempStr = <span class="kw5">class</span><span class="st0">'wUtils103.wArray'</span>.<span class="kw6">static</span>.<span class="me1">Join</span><span class="br0">(</span>TempArr,<span class="st0">","</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Load profile mutator information</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; CurS.<span class="me1">ClearMutators</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;AllPCSMutators.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160;<span class="kw1">if</span> <span class="br0">(</span>AllPCSMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">bRequired</span> || <span class="br0">(</span><span class="kw7">InStr</span><span class="br0">(</span>TempStr,AllPCSMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MutatorName</span><span class="br0">)</span>!=<span class="nu0">-1</span><span class="br0">)</span> || bIncludeNonActive<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;CurS.<span class="me1">setMutator</span><span class="br0">(</span>AllPCSMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MutatorName</span>,<span class="kw9">True</span>,AllPCSMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">bRequired</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; TempArr = LadderRules.<span class="me1">GetProfileMaps</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>ProfileIndex<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; TempStr = <span class="kw5">class</span><span class="st0">'wUtils103.wArray'</span>.<span class="kw6">static</span>.<span class="me1">Join</span><span class="br0">(</span>TempArr,<span class="st0">","</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// Load profile map information</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; CurS.<span class="me1">ClearMaps</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;AllPCSMaps.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160;<span class="kw1">if</span> <span class="br0">(</span>AllPCSMaps<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">bRequired</span> || <span class="br0">(</span><span class="kw7">InStr</span><span class="br0">(</span>TempStr,AllPCSMaps<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MapName</span><span class="br0">)</span>!=<span class="nu0">-1</span><span class="br0">)</span> || bIncludeNonActive<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160;CurS.<span class="me1">setMap</span><span class="br0">(</span>AllPCSMaps<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MapName</span>,AllPCSMaps<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MapListOrder</span>,<span class="kw9">True</span>,AllPCSMaps<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">bRequired</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; TempArr = LadderRules.<span class="me1">GetProfileServerActors</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>ProfileIndex<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; TempStr = <span class="kw5">class</span><span class="st0">'wUtils103.wArray'</span>.<span class="kw6">static</span>.<span class="me1">Join</span><span class="br0">(</span>TempArr,<span class="st0">","</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Load ServerActor info</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; CurS.<span class="me1">ClearServerActors</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;AllPCSServerActors.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>AllPCSServerActors<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">bRequired</span> || <span class="kw7">InStr</span><span class="br0">(</span>TempStr,AllPCSServerActors<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ActorClass</span><span class="br0">)</span>!=<span class="nu0">-1</span> || bIncludeNonActive<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setServerActor</span><span class="br0">(</span>AllPCSServerActors<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ActorClass</span>, <span class="kw9">True</span>, AllPCSServerActors<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">bRequired</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// Load profile PlayInfo data</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;TempPCS.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span>TempPCS.<span class="me1">GetProfileParamName</span><span class="br0">(</span>i<span class="br0">)</span>,TempPCS.<span class="me1">GetProfileParam</span><span class="br0">(</span>i<span class="br0">)</span>,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; TempPCS.<span class="me1">EndEdit</span><span class="br0">(</span>bSave,bQuiet<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Initialize session data for recently imported profile</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> ProfileConfigSet CreateImportSessionInfo<span class="br0">(</span>Session CurS<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span>&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; i;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr, Tmp;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> PlayInfo&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPI;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> ProfileConfigSet &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Mutator&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;GameInfo&gt; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GIClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;AccessControl&gt; &#160; &#160; &#160;&#160; &#160; &#160; &#160; ACClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Info&gt;&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ServerActorClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;class&lt;Info&gt; &gt;&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; SAClass;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;class&lt;Mutator&gt; &gt; &#160; &#160;MClass;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; TempPCS = LadderRules.<span class="me1">AddProfile</span><span class="br0">(</span>CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span><span class="br0">)</span>,CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempPCS.<span class="me1">StartEdit</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GIClass = class&lt;GameInfo&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>GIClass == <span class="kw9">None</span><span class="br0">)</span> <span class="kw1">return</span> <span class="kw9">None</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ACClass"</span>,<span class="kw8">Level</span>.<span class="me1">Game</span>.<span class="me1">AccessControlClass</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ACClass = class&lt;AccessControl&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ACClass == <span class="kw9">None</span><span class="br0">)</span> <span class="kw1">return</span> <span class="kw9">None</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPI = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'PlayInfo'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Mutators</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getMutatorLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getMutator</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutClass = class&lt;Mutator&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr, <span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>MutClass&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MClass<span class="br0">[</span>MClass.<span class="kw6">Length</span><span class="br0">]</span> = MutClass;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">AddProfileMutator</span><span class="br0">(</span>TempStr,CurS.<span class="me1">MutRequired</span><span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw7">log</span><span class="br0">(</span>ErrorRemoteMutator@TempStr,LOGNAME<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getSALength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getServerActor</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ServerActorClass = class&lt;Info&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ServerActorClass&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SAClass<span class="br0">[</span>SAClass.<span class="kw6">Length</span><span class="br0">]</span> = ServerActorClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">AddProfileServerActor</span><span class="br0">(</span>TempStr,CurS.<span class="me1">SARequired</span><span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw7">log</span><span class="br0">(</span>ErrorRemoteServerActor@TempStr,LOGNAME<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; LoadThisPlayInfo<span class="br0">(</span>TempPI, GIClass, ACClass, MClass, SAClass<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// Maps</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getMapLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getMap</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">AddProfileMap</span><span class="br0">(</span>TempStr,CurS.<span class="me1">MapRequired</span><span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// PlayInfo</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;TempPI.<span class="me1">Settings</span>.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="st0">""</span>; Tmp=<span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">getIdValue</span><span class="br0">(</span>i,TempStr,Tmp<span class="br0">)</span> == <span class="nu0">-1</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>&#160;!SettingIsAllowed<span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SecLevel</span><span class="br0">)</span> <span class="br0">)</span> <span class="kw1">continue</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!TempPCS.<span class="me1">SetProfileNamedParam</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span>, CurS.<span class="me1">getValue</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span>,TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">Value</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">SetProfileParam</span><span class="br0">(</span>TempPCS.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>,TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span>,CurS.<span class="me1">getValue</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span>,TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">Value</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">EndEdit</span><span class="br0">(</span><span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> TempPCS;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw7">log</span><span class="br0">(</span>ErrorServer,LOGNAME<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">None</span>;</div>
</li>
<li class="li2">
<div class="de2"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Clear session data and optionally create new session object</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> <span class="kw4">string</span> ResetSessionID<span class="br0">(</span>Session CurS, <span class="kw6">optional</span> <span class="kw4">bool</span> bDestroySession<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> OldSID;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>bDestroySession<span class="br0">)</span> SMaster.<span class="me1">destroySession</span><span class="br0">(</span>CurS<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> CurS.<span class="me1">ResetSession</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>OldSID,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> CurS.<span class="me1">GetHash</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="co1">////////////////////////////////////////////////////////////</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">////////////////////////////////////////////////////////////</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Profile manipulation methods</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">function</span> <span class="kw4">int</span> LoadThisPlayInfo<span class="br0">(</span>PlayInfo PI, class&lt;GameInfo&gt; ThisGameInfo, class&lt;AccessControl&gt; ThisAccessControl, array&lt;class&lt;Mutator&gt; &gt; ThisMutator, array&lt;class&lt;Info&gt; &gt; ThisServerActor<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Mutator&gt; M;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>PI == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="nu0">0</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; PI.<span class="me1">Clear</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ThisGameInfo == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="nu0">1</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ThisAccessControl == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="nu0">2</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ThisMutator.<span class="kw6">Length</span> &gt; <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;ThisMutator.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ThisMutator<span class="br0">[</span>i<span class="br0">]</span> == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="nu0">3</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ThisServerActor.<span class="kw6">Length</span> &gt; <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;ThisServerActor.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ThisServerActor<span class="br0">[</span>i<span class="br0">]</span> == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="nu0">4</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; ThisGameInfo.<span class="kw6">static</span>.<span class="me1">FillPlayInfo</span><span class="br0">(</span>PI<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; PI.<span class="me1">PopClass</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ThisGameInfo.<span class="kw1">default</span>.<span class="me1">MutatorClass</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; M = class&lt;Mutator&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>ThisGameInfo.<span class="kw1">default</span>.<span class="me1">MutatorClass</span>,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>M&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; M.<span class="kw6">static</span>.<span class="me1">FillPlayInfo</span><span class="br0">(</span>PI<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; ThisAccessControl.<span class="kw6">static</span>.<span class="me1">FillPlayInfo</span><span class="br0">(</span>PI<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; PI.<span class="me1">PopClass</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i &lt; ThisMutator.<span class="kw6">Length</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ThisMutator<span class="br0">[</span>i<span class="br0">]</span>.<span class="kw6">static</span>.<span class="me1">FillPlayInfo</span><span class="br0">(</span>PI<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; PI.<span class="me1">PopClass</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i &lt; ThisServerActor.<span class="kw6">Length</span>; i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ThisServerActor<span class="br0">[</span>i<span class="br0">]</span>.<span class="kw6">static</span>.<span class="me1">FillPlayInfo</span><span class="br0">(</span>PI<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; PI.<span class="me1">PopClass</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">class</span><span class="st0">'CommandLineParams'</span>.<span class="kw6">static</span>.<span class="me1">FillPlayInfo</span><span class="br0">(</span>PI<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; PI.<span class="me1">PopClass</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="nu0">-1</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> ProfileConfigSet GetCurrentConfigSet<span class="br0">(</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurrentProfile == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; i = LadderRules.<span class="me1">FindActiveProfile</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>i &gt;= <span class="nu0">0</span><span class="br0">)</span>&#160; &#160; &#160;CurrentProfile = LadderRules.<span class="me1">LadderProfiles</span><span class="br0">[</span>i<span class="br0">]</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> CurrentProfile;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> <span class="kw4">int</span> GetCurrentConfigIndex<span class="br0">(</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurrentProfile&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>;i &lt; LadderRules.<span class="me1">LadderProfiles</span>.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderRules.<span class="me1">LadderProfiles</span><span class="br0">[</span>i<span class="br0">]</span> == CurrentProfile<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> i;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> LadderRules.<span class="me1">FindActiveProfile</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Returns an array of class names for mutators that this profile will use in the game</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> array&lt;string&gt; LoadActiveProfileMutators<span class="br0">(</span><span class="kw6">optional</span> <span class="kw4">string</span> CurrentProfileItem<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> LadderRules.<span class="me1">GetProfileMutators</span><span class="br0">(</span>CurrentProfileItem<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> array&lt;string&gt; LoadActiveProfileServerActors<span class="br0">(</span><span class="kw6">optional</span> <span class="kw4">string</span> CurrentProfileItem<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> LadderRules.<span class="me1">GetProfileServerActors</span><span class="br0">(</span>CurrentProfileItem<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Returns an array of map names that in the maplist for this profile</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> array&lt;string&gt; LoadActiveProfileMaps<span class="br0">(</span><span class="kw6">optional</span> <span class="kw4">string</span> CurrentProfileItem<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">return</span> LadderRules.<span class="me1">GetProfileServerActors</span><span class="br0">(</span>CurrentProfileItem<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">/*</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">function CreateFullMutatorList(out StringArray Mutators, out StringArray GroupsOnly)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">{</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; local StringArray Grouped;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; local int i,j,z;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; local string GrpName;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; local string thisgroup, nextgroup;</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">// This class provides a specialized sorting function</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">// since mutators may be grouped - mutators in the same groups</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">// are not allowed to be selected togther</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; Grouped = new(None) class'SortedStringArray';</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">// Create array sorted on GroupName...this allows to flag</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">// the mutator for a different .inc file</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; for (i = 0; i &lt; Mutators.Count(); i++)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; {</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = int(Mutators.GetItem(i));</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">// If the mutator author forgot to configure a group name for the mutator</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (AllMutators[j].GroupName == "")</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GrpName = "Z" $ string (z++);</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; else GrpName = AllMutators[j].GroupName;</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Grouped.Add(string(j),GrpName $ "." $ AllMutators[j].FriendlyName);</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; }</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">// Move all grouped mutators to GroupsOnly StringArray for sorting by friendly name</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; for (i=0;i&lt;Grouped.Count();i++)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; {</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; thisgroup = AllMutators[int(Grouped.GetItem(i))].GroupName;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; nextgroup = "";</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (thisgroup=="")</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; continue;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (i+1&lt;Grouped.Count())</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; nextgroup = AllMutators[int(Grouped.GetItem(i+1))].GroupName;</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (thisgroup ~= nextgroup)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; {</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j=i;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; while(nextgroup~=thisgroup &amp;&amp; j&lt;Grouped.Count())</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; {</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GroupsOnly.MoveFromId(Grouped, Grouped.FindItemId(Grouped.GetItem(j)));</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; thisgroup = nextgroup;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (j+1==Grouped.Count())</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; nextgroup="";</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; else nextgroup = AllMutators[int(Grouped.GetItem(j+1))].GroupName;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; }</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (j&lt;Grouped.Count())</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GroupsOnly.MoveFromId(Grouped,Grouped.FindItemId(Grouped.GetItem(j)));</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; i=-1;</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; }</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; }</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">// Move all non-grouped mutators back to Mutators array</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">// for re-sorting by Friendly Name</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; Mutators.Reset();</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; for (i=0;i&lt;Grouped.Count();i++)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; {</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j=int(Grouped.GetItem(i));</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators.Add(string(j),AllMutators[j].FriendlyName);</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; }</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; Grouped.Reset();</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">}</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">*/</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//****************************************************************</span></div>
</li>
<li class="li2">
<div class="de2"><span class="co1">//****************************************************************</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Helper functions</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//****************************************************************</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//**************************</span></div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// HTML Generation</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//*************************</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Creates a listing of PlayInfo data</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Pass "defaults_row" in the 'IncludeFile' param to add the</span></div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// input form objects to the output</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> <span class="kw4">string</span> GeneratePlayInfoRows<span class="br0">(</span>WebRequest Req, WebResponse Res, <span class="kw4">string</span> IncludeFile<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i,j,k,z;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> &#160; &#160;TempStr, Data, Op, SID,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempRow, HeadingRow, PlayInfoRows;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session &#160; &#160; &#160; &#160; &#160; CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> PlayInfo &#160;&#160; &#160; &#160; &#160; TempPI;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> StringArray &#160; &#160; &#160; Info, InfoC, InfoS, InfoT;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;string&gt; &#160; &#160; &#160; &#160; &#160; &#160; Options;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Mutator&gt; &#160; &#160;&#160; &#160; &#160; &#160; TempMut;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Info&gt;&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempSA;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;GameInfo&gt; &#160; &#160; &#160; &#160; &#160; GIClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;AccessControl&gt; &#160; &#160; &#160;ACClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;class&lt;Mutator&gt; &gt; MClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;class&lt;Info&gt; &gt;&#160; &#160; &#160; &#160;SAClass;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">GetSession</span><span class="br0">(</span>SID<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GIClass = class&lt;GameInfo&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>GIClass == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorGameClassTitle,ErrorGameClassText<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="st0">""</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ACClass"</span>,<span class="kw8">Level</span>.<span class="me1">Game</span>.<span class="me1">AccessControlClass</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ACClass = class&lt;AccessControl&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ACClass == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorAccessControlTitle,ErrorAccessControlText<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">GetMutatorLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getMutator</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempMut = class&lt;Mutator&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempMut&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MClass<span class="br0">[</span>MClass.<span class="kw6">Length</span><span class="br0">]</span> = TempMut;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getSALength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getServerActor</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempSA = class&lt;Info&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempSA&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SAClass<span class="br0">[</span>SAClass.<span class="kw6">Length</span><span class="br0">]</span> = TempSA;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Initialize and fill PlayInfo</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; TempPI = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'PlayInfo'</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; LoadThisPlayInfo<span class="br0">(</span>TempPI, GIClass, ACClass, MClass, SAClass<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;TempPI.<span class="me1">Settings</span>.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">HasData</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPI.<span class="me1">StoreSetting</span><span class="br0">(</span>i, CurS.<span class="me1">getValue</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span>,TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">Value</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; InfoC = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;&#160; &#160; &#160;<span class="co1">// Checkboxes</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; InfoS = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;&#160; &#160; &#160;<span class="co1">// Selects</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; InfoT = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;&#160; &#160; &#160;<span class="co1">// Textboxes</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Info &#160;= <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;&#160; &#160; &#160;<span class="co1">// Contains each unique ClassFrom value</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Want to allow admin to input values for each setting</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>IncludeFile ~= <span class="st0">"defaults_row"</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;TempPI.<span class="me1">Settings</span>.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">RenderType</span>~=<span class="st0">"Text"</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Hack for MOTD sorting</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span><span class="kw7">Left</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span>,<span class="kw7">Len</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span><span class="br0">)</span> - <span class="nu0">1</span><span class="br0">)</span> ~= <span class="st0">"GameReplicationInfo.MOTDLine"</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; InfoT.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>, TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> InfoT.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>,TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">DisplayName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">RenderType</span>~=<span class="st0">"Check"</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; InfoC.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>,TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">DisplayName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">RenderType</span>~=<span class="st0">"Select"</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; InfoS.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>,TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">DisplayName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>j=<span class="nu0">0</span>;j&lt;Info.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;j++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Info.<span class="me1">GetTag</span><span class="br0">(</span>j<span class="br0">)</span> ~= <span class="kw4">string</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassFrom</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>j == Info.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Info.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>, <span class="kw4">string</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassFrom</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>k=<span class="nu0">0</span>;k&lt;Info.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;k++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempRow = <span class="st0">""</span>; HeadingRow = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, <span class="st0">"&lt;td class=ttext colspan=<span class="es0">\"</span>3<span class="es0">\"</span>&gt;"</span>$Info.<span class="me1">GetTag</span><span class="br0">(</span>k<span class="br0">)</span>$<span class="st0">"&lt;/td&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; HeadingRow = WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;InfoC.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j=<span class="kw4">int</span><span class="br0">(</span>InfoC.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!SettingIsAllowed<span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SecLevel</span><span class="br0">)</span> || <span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassFrom</span><span class="br0">)</span>!=Info.<span class="me1">GetTag</span><span class="br0">(</span>k<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">continue</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, Checkbox<span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SettingName</span>, TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Value</span> ~= <span class="st0">"True"</span>, TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Data</span>&#160;!= <span class="st0">""</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, <span class="st0">"&lt;span class=location title=<span class="es0">\"</span>Required Security Level<span class="es0">\"</span>&gt;"</span>$TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SecLevel</span>$<span class="st0">"&lt;/span&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr += WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, <span class="st0">"&lt;span class='location'&gt;"</span>$HtmlEncode<span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">DisplayName</span><span class="br0">)</span>$<span class="st0">"&lt;/span&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span> $ TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempRow += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;InfoT.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="st0">""</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = <span class="kw4">int</span><span class="br0">(</span>InfoT.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!SettingIsAllowed<span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SecLevel</span><span class="br0">)</span> || <span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassFrom</span><span class="br0">)</span>!=Info.<span class="me1">GetTag</span><span class="br0">(</span>k<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">continue</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Data = <span class="st0">"8"</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Data</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Data = TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Data</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw7">Divide</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Data</span>, <span class="st0">";"</span>, Data, Op<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPI.<span class="me1">SplitStringToArray</span><span class="br0">(</span>Options, Op, <span class="st0">":"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Op = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Options.<span class="kw6">Length</span> &gt; <span class="nu0">1</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Op = <span class="st0">" ("</span>$Options<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>$<span class="st0">" - "</span>$Options<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span>$<span class="st0">")"</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, Textbox<span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SettingName</span>, Data, <span class="nu0">3</span> * <span class="kw4">int</span><span class="br0">(</span>Data<span class="br0">)</span>, TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Value</span><span class="br0">)</span> $ Op<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, <span class="st0">"&lt;span class=location title=<span class="es0">\"</span>Required Security Level<span class="es0">\"</span>&gt;"</span>$TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SecLevel</span>$<span class="st0">"&lt;/span&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr += WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, <span class="st0">"&lt;span class='location'&gt;"</span>$HtmlEncode<span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">DisplayName</span><span class="br0">)</span>$<span class="st0">"&lt;/span&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span> $ TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempRow += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;InfoS.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Data = <span class="st0">""</span>; TempStr = <span class="st0">""</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j=<span class="kw4">int</span><span class="br0">(</span>InfoS.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!SettingIsAllowed<span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SecLevel</span><span class="br0">)</span> || <span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassFrom</span><span class="br0">)</span>!=Info.<span class="me1">GetTag</span><span class="br0">(</span>k<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">continue</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Build a set of options from PID.Data</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPI.<span class="me1">SplitStringToArray</span><span class="br0">(</span>Options, TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Data</span>, <span class="st0">";"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>z = <span class="nu0">0</span>; <span class="br0">(</span>z<span class="nu0">+1</span><span class="br0">)</span>&lt;Options.<span class="kw6">Length</span>; z += <span class="nu0">2</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Data += <span class="br0">(</span><span class="st0">"&lt;option value='"</span>$Options<span class="br0">[</span>z<span class="br0">]</span>$<span class="st0">"'"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">If</span> <span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Value</span> == Options<span class="br0">[</span>z<span class="br0">]</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Data @= <span class="st0">"selected"</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Data += <span class="br0">(</span><span class="st0">"&gt;"</span>$HtmlEncode<span class="br0">(</span>Options<span class="br0">[</span>z<span class="nu0">+1</span><span class="br0">]</span><span class="br0">)</span>$<span class="st0">"&lt;/option&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, Select<span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SettingName</span>, Data<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, <span class="st0">"&lt;span class=location title=<span class="es0">\"</span>Required Security Level<span class="es0">\"</span>&gt;"</span>$TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SecLevel</span>$<span class="st0">"&lt;/span&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr += WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, <span class="st0">"&lt;span class='location'&gt;"</span>$HtmlEncode<span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">DisplayName</span><span class="br0">)</span>$<span class="st0">"&lt;/span&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span> $ TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempRow += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempRow!=<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; PlayInfoRows += <span class="br0">(</span>HeadingRow$TempRow<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span>&#160; &#160; <span class="co1">// Displaying values only</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;TempPI.<span class="me1">Settings</span>.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span><span class="kw7">Left</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span>,<span class="kw7">Len</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span><span class="br0">)</span> - <span class="nu0">1</span><span class="br0">)</span> ~= <span class="st0">"GameReplicationInfo.MOTDLine"</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; InfoS.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>, TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> InfoS.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>,TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">DisplayName</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>j=<span class="nu0">0</span>;j&lt;Info.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;j++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Info.<span class="me1">GetTag</span><span class="br0">(</span>j<span class="br0">)</span> ~= <span class="kw4">string</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassFrom</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>j == Info.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Info.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>, <span class="kw4">string</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassFrom</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>k=<span class="nu0">0</span>;k&lt;Info.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;k++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempRow = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; HeadingRow = <span class="st0">"&lt;tr&gt;&lt;td class=ttext colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;"</span>$Info.<span class="me1">GetTag</span><span class="br0">(</span>k<span class="br0">)</span>$<span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;InfoS.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j=<span class="kw4">int</span><span class="br0">(</span>InfoS.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Data = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!SettingIsAllowed<span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SecLevel</span><span class="br0">)</span> || <span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassFrom</span><span class="br0">)</span>!=Info.<span class="me1">GetTag</span><span class="br0">(</span>k<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">continue</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, HtmlEncode<span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">DisplayName</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Value</span> ~= <span class="st0">"true"</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Data = <span class="st0">"True"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Value</span> ~= <span class="st0">"false"</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Data = <span class="st0">"False"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">RenderType</span> ~= <span class="st0">"Select"</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw5">class</span><span class="st0">'wUtils103.wString'</span>.<span class="kw6">static</span>.<span class="me1">Split2</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Data</span>, <span class="st0">";"</span>, Options<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>z=<span class="nu0">0</span>;<span class="br0">(</span>z<span class="nu0">+1</span><span class="br0">)</span>&lt;Options.<span class="kw6">Length</span>;z+=<span class="nu0">2</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Value</span> == Options<span class="br0">[</span>z<span class="br0">]</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Data = Options<span class="br0">[</span>z<span class="nu0">+1</span><span class="br0">]</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> Data = TempPI.<span class="me1">Settings</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Value</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, HtmlEncode<span class="br0">(</span>Data<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempRow += WebInclude<span class="br0">(</span>IncludeFile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempRow!=<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; PlayInfoRows += <span class="br0">(</span>HeadingRow$TempRow<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> PlayInfoRows;</div>
</li>
<li class="li2">
<div class="de2"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Creates the drop-down box containing profiles names</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> <span class="kw4">String</span> GenerateSwitchProfileOptions<span class="br0">(</span><span class="kw6">optional</span> <span class="kw4">string</span> CurrentProfileItem<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> SelectedStr, OptionStr;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderRules.<span class="me1">AllLadderProfiles</span>.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span> == <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="st0">"&lt;option value=<span class="es0">\"</span><span class="es0">\"</span>&gt;***"</span>@NoneText@<span class="st0">"***&lt;/option&gt;"</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>; i &lt; LadderRules.<span class="me1">AllLadderProfiles</span>.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// This item was the item passed in by CurrentProfileItem, so make it active</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurrentProfileItem ~= LadderRules.<span class="me1">AllLadderProfiles</span>.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SelectedStr = <span class="st0">" selected"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> SelectedStr = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; OptionStr = OptionStr$<span class="st0">"&lt;option value=<span class="es0">\"</span>"</span>$LadderRules.<span class="me1">AllLadderProfiles</span>.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span>$<span class="st0">"<span class="es0">\"</span>"</span>$SelectedStr$<span class="st0">"&gt;"</span>$LadderRules.<span class="me1">AllLadderProfiles</span>.<span class="me1">GetTag</span><span class="br0">(</span>i<span class="br0">)</span>@<span class="st0">"&lt;/option&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">return</span> OptionStr;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> <span class="kw4">bool</span> SettingIsAllowed<span class="br0">(</span><span class="kw4">byte</span> SettingSecLevel<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">return</span> SettingSecLevel &lt;= CurAdmin.<span class="me1">MaxSecLevel</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Handles generation of the double map select boxes (Exclude &amp; Include)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> <span class="kw4">String</span> CreateMapListSelect<span class="br0">(</span>array&lt;ProfileConfigSet.<span class="me1">ProfileMap</span>&gt; AllPCSMaps, StringArray MapList, StringArray MovedMaps<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i,j;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">String</span> ResponseStr, SelectedStr, Tmp;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>MapList.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span> == <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="st0">"&lt;option value=<span class="es0">\"</span><span class="es0">\"</span>&gt;***"</span>@NoneText@<span class="st0">"***&lt;/option&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i&lt;MapList.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Index for map within AllPCSMaps</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = <span class="kw4">int</span><span class="br0">(</span>MapList.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Tmp = AllPCSMaps<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">MapName</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SelectedStr = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>MovedMaps&#160;!= <span class="kw9">None</span> &amp;&amp; MovedMaps.<span class="me1">FindItemId</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>j<span class="br0">)</span><span class="br0">)</span> &gt;= <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SelectedStr = <span class="st0">" selected"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ResponseStr = ResponseStr$<span class="st0">"&lt;option value=<span class="es0">\"</span>"</span>$Tmp$<span class="st0">"<span class="es0">\"</span>"</span>$SelectedStr$<span class="st0">"&gt;"</span>$Tmp$<span class="st0">"&lt;/option&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> ResponseStr;</div>
</li>
<li class="li2">
<div class="de2"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//**********************</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Import / Export</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//**********************</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Handles spacing for textboxes on export page</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> <span class="kw4">int</span> GetLongestURL<span class="br0">(</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i, Current, Largest;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i &lt; ExportMaster.<span class="me1">Zips</span>.<span class="kw6">Length</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Current = <span class="kw7">Len</span><span class="br0">(</span>ExportMaster.<span class="me1">Zips</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ZipURL</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Current &gt; Largest<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Largest = Current;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> Largest + <span class="nu0">1</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Handles filling in zip-location textboxes on export page</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> <span class="kw4">string</span> GetLocation<span class="br0">(</span><span class="kw4">string</span> Package<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Check if we're dealing with a map or a mutator</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; i = <span class="kw7">InStr</span><span class="br0">(</span>Package, <span class="st0">"."</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Dealing with a mutator - remove class name</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>i&#160;!= <span class="nu0">-1</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Package = <span class="kw7">Left</span><span class="br0">(</span>Package, i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> ExportMaster.<span class="me1">FindZipLocation</span><span class="br0">(</span>Package<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Handles saving zip file locations from export page</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> SetLocation<span class="br0">(</span><span class="kw4">string</span> Package, <span class="kw4">string</span> NewLocation<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Check if we're dealing with a map or a mutator</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; i = <span class="kw7">InStr</span><span class="br0">(</span>Package, <span class="st0">"."</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Dealing with a mutator - remove class name</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>i&#160;!= <span class="nu0">-1</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Package = <span class="kw7">Left</span><span class="br0">(</span>Package, i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>NewLocation == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ExportMaster.<span class="me1">DeleteZipLocation</span><span class="br0">(</span>Package<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">else</span> ExportMaster.<span class="me1">AddZipLocation</span><span class="br0">(</span>Package, NewLocation<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Utility function to remove strings from profile names before</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// creating .txt for exported profile</span></div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">function</span> <span class="kw4">string</span> RemoveStr<span class="br0">(</span><span class="kw4">string</span> Source,<span class="kw4">string</span> mask<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> <span class="kw7">left</span>,<span class="kw7">right</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; i = <span class="kw7">InStr</span><span class="br0">(</span>Source,mask<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">while</span> <span class="br0">(</span>i&#160;!= <span class="nu0">-1</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw7">Divide</span><span class="br0">(</span>Source,mask,<span class="kw7">left</span>,<span class="kw7">right</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Source = <span class="kw7">Left</span>$Right;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; i = <span class="kw7">InStr</span><span class="br0">(</span>Source,Mask<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> Source;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Prevents entering a zip file location for any package</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// that is already included with the game</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> <span class="kw4">bool</span> EpicPackage<span class="br0">(</span><span class="kw4">string</span> Package<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Check if we're dealing with a map or a mutator</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; i = <span class="kw7">InStr</span><span class="br0">(</span>Package, <span class="st0">"."</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="co1">// Dealing with a mutator - remove class name</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>i&#160;!= <span class="nu0">-1</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Package = <span class="kw7">Left</span><span class="br0">(</span>Package, i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>;i &lt; EPICNUMBER; i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Package ~= EpicPackages<span class="br0">[</span>i<span class="br0">]</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">false</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">function</span> CheckSettingValue<span class="br0">(</span><span class="kw4">string</span> SettingData, <span class="kw6">out</span> <span class="kw4">string</span> NewValue<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> sMaxLength, sMinMax, sMin, sMax;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> iMaxLength, iMin, iMax, iValue;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">float</span> <span class="kw7">fMin</span>, <span class="kw7">fMax</span>, fValue;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">bool</span> bFloat;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>SettingData == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// This setting has no valid min/max (it is a password setting or something)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span><span class="kw7">InStr</span><span class="br0">(</span>SettingData,<span class="st0">";"</span><span class="br0">)</span> &lt; <span class="nu0">0</span> <span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Allow only up to three times the configured max length</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; iMaxLength = <span class="nu0">3</span> * <span class="kw4">int</span><span class="br0">(</span>SettingData<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span><span class="kw7">Len</span><span class="br0">(</span>NewValue<span class="br0">)</span> &gt; iMaxLength<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewValue = <span class="kw7">Left</span><span class="br0">(</span>NewValue,iMaxLength<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw7">Divide</span><span class="br0">(</span>SettingData,<span class="st0">";"</span>,sMaxLength,sMinMax<span class="br0">)</span>;&#160; &#160; &#160;<span class="co1">// Split the Max Length &amp; MinMax Info</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw7">Divide</span><span class="br0">(</span>sMinMax,<span class="st0">":"</span>,sMin,sMax<span class="br0">)</span>;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Split the Min &amp; Max info for casting</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; iMaxLength = <span class="kw4">int</span><span class="br0">(</span>sMaxLength<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span> <span class="kw7">InStr</span><span class="br0">(</span>sMin,<span class="st0">"."</span><span class="br0">)</span> &gt;= <span class="nu0">0</span> || <span class="kw7">InStr</span><span class="br0">(</span>sMax,<span class="st0">"."</span><span class="br0">)</span> &gt;= <span class="nu0">0</span><span class="br0">)</span>&#160; &#160; &#160; <span class="co1">// Are we dealing with floating point numbers?</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bFloat = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw7">fMin</span> = <span class="kw4">float</span><span class="br0">(</span>sMin<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw7">fMax</span> = <span class="kw4">float</span><span class="br0">(</span>sMax<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; iMin = <span class="kw4">int</span><span class="br0">(</span>sMin<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; iMax = <span class="kw4">int</span><span class="br0">(</span>sMax<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// First check for length</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span><span class="kw7">Len</span><span class="br0">(</span>NewValue<span class="br0">)</span> &gt; iMaxLength<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewValue = <span class="kw7">Left</span><span class="br0">(</span>NewValue,iMaxLength<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>bFloat<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; fValue = <span class="kw4">float</span><span class="br0">(</span>NewValue<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; fValue = <span class="kw7">FClamp</span><span class="br0">(</span>fValue,<span class="kw7">fMin</span>,<span class="kw7">fMax</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewValue = <span class="kw4">string</span><span class="br0">(</span>fValue<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; iValue = <span class="kw4">int</span><span class="br0">(</span>NewValue<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; iValue = <span class="kw7">Clamp</span><span class="br0">(</span>iValue,iMin,iMax<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewValue = <span class="kw4">string</span><span class="br0">(</span>iValue<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//*****************************************************************************</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//*****************************************************************************</span></div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// Query Methods</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Passes the SessionID variable to all pages in this query action</span></div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// if SessionID is not present in WebRequest, generates one</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// (Helpful when dealing with frames)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> <span class="kw4">bool</span> PreQuery<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> SID;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>SID == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SID = SMaster.<span class="me1">getSession</span><span class="br0">(</span><span class="st0">"xxxxx"</span>,<span class="kw9">true</span><span class="br0">)</span>.<span class="me1">GetHash</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Req.<span class="me1">AddVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span>, SID<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SessionID"</span>, SID<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> <span class="kw4">bool</span> Query<span class="br0">(</span>WebRequest Request, WebResponse Response<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">switch</span> <span class="br0">(</span><span class="kw7">Mid</span><span class="br0">(</span>Request.<span class="me1">URI</span>, <span class="nu0">1</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">case</span> DefaultPage: &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QueryLadderFrame<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> ProfileMenuURI:&#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QueryLadderMenu<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> ProfileViewURI:&#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QueryLadderView<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> ProfileEditURI: &#160; &#160;<span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QueryLadderEdit<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> ProfileSwitchURI:&#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QueryLadderSwitch<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160; &#160; &#160;&#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">case</span> ProfileManageURI:&#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QueryLadderManage<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160; &#160; &#160;&#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Management subframes</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> SubFrameURI: &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QuerySubFrame<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> SubFrameMenuURI: &#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QuerySubMenu<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">case</span> SubGametypeURI:&#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QuerySubGameType<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> SubMapsURI:&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QuerySubMaps<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> SubMutatorsURI:&#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QuerySubMutators<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> SubRulesURI:&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QuerySubRules<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> SubReviewURI:&#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QuerySubReview<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">case</span> SubSavedURI:&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QuerySubSaved<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> SubImportURI: &#160; &#160; &#160;&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QuerySubImport<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> SubExportURI: &#160; &#160; &#160;&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!MapIsChanging<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> QuerySubExport<span class="br0">(</span>Request, Response<span class="br0">)</span>;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">true</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// This query is looking for a page from another query handler</span></div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// or the map is changing</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">return</span> <span class="kw9">false</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> QueryLadderFrame<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">String</span> Page;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> SID;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// if no page specified, use the default</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; Page = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"Page"</span>, ProfileViewURI<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Tell the menu page which page we're viewing (with the&#160;?Page=),</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// so that it can highlight the appropriate link</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"IndexURI"</span>,ProfileMenuURI$<span class="st0">"?Page="</span>$Page$<span class="st0">"?SessionID="</span>$SID<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Load the main page into the frameset</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"MainURI"</span>, Page$<span class="st0">"?SessionID="</span>$SID<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; ShowFrame<span class="br0">(</span>Res, DefaultPage<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> QuerySubFrame<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> Page, SID, TempStr, Action;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>SID, <span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Action = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"Actions"</span>,<span class="st0">"Add"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Action ~= <span class="st0">"Modify"</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"ProfileNameSelect"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span> CreateSessionInfo<span class="br0">(</span>TempStr,SID,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>Action ~= <span class="st0">"Add"</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"TextInput"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span> CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span>,TempStr,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// if no page specified, use the default</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Page = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"Page"</span>, SubGameTypeURI<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"CurrentPage"</span>, Page, <span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Tell the SubMenu page which page we're viewing, so that it can highlight</span></div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// the appropriate link</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SubMenuURI"</span>, SubFrameMenuURI$<span class="st0">"?SessionID="</span>$SID<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Load the main page into the frameset</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SubMainURI"</span>, Page$<span class="st0">"?SessionID="</span>$SID<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; ShowFrame<span class="br0">(</span>Res, SubFrame<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> QueryLadderMenu<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> SID;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">/*</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">If&#160;?SessionID= is appended to the link, PreQuery() will not generate</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">a new Session when this link is queried</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">*/</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Set URIs</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Lv"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ViewProfiles"</span>, <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$ProfileViewURI$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>main<span class="es0">\"</span>&gt;"</span>$LinkViewProfile$<span class="st0">"&lt;/a&gt;&lt;br /&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Le"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"EditProfiles"</span>, <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$ProfileEditURI$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>main<span class="es0">\"</span>&gt;"</span>$LinkEditProfile$<span class="st0">"&lt;/a&gt;&lt;br&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Ls"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SwitchProfiles"</span>, <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$ProfileSwitchURI$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>main<span class="es0">\"</span>&gt;"</span>$LinkSwitchProfile$<span class="st0">"&lt;/a&gt;&lt;br&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Lm"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ManageProfiles"</span>, <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$ProfileManageURI$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>main<span class="es0">\"</span>&gt;"</span>$LinkManageProfile$<span class="st0">"&lt;/a&gt;&lt;br&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; ShowPage<span class="br0">(</span>Res, ProfileMenuURI<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> QuerySubMenu<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// Highlight the current page</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> Highlighted, Background, SID;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> GameLink, MutatorLink, MapLink, RuleLink, ReviewLink;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> GameSpan, MutatorSpan, MapSpan, RuleSpan, ReviewSpan;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> Page;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Lm"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Highlighted = <span class="st0">"&lt;span class=<span class="es0">\"</span>blue<span class="es0">\"</span>&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Background = <span class="st0">"&lt;span class=<span class="es0">\"</span>red<span class="es0">\"</span>&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>SID, <span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// We are managing an existing profile</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">HasData</span><span class="br0">(</span><span class="st0">"ProfileIndex"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Section"</span>, LabelModifyProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Section"</span>, LabelAddProfile<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Page = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"CurrentPage"</span>,SubGametypeURI<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Including&#160;?SessionID= in link prevents PreQuery() from generating a new Session</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GameLink = &#160; &#160; &#160;&#160; &#160; &#160; &#160; <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$SubFrameURI$<span class="st0">"?SessionID="</span>$SID$<span class="st0">"?Page="</span>$SubGametypeURI$&#160; &#160; &#160;<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_parent<span class="es0">\"</span>&gt;"</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutatorLink = &#160; <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$SubFrameURI$<span class="st0">"?SessionID="</span>$SID$<span class="st0">"?Page="</span>$SubMutatorsURI$&#160; &#160; &#160;<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_parent<span class="es0">\"</span>&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MapLink = &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$SubFrameURI$<span class="st0">"?SessionID="</span>$SID$<span class="st0">"?Page="</span>$SubMapsURI$&#160;&#160; &#160; &#160; &#160; <span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_parent<span class="es0">\"</span>&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; RuleLink = &#160; &#160; &#160;&#160; &#160; &#160; &#160; <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$SubFrameURI$<span class="st0">"?SessionID="</span>$SID$<span class="st0">"?Page="</span>$SubRulesURI$&#160; &#160; &#160; &#160; <span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_parent<span class="es0">\"</span>&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewLink = &#160; &#160;<span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$SubFrameURI$<span class="st0">"?SessionID="</span>$SID$<span class="st0">"?Page="</span>$SubReviewURI$&#160; &#160; &#160; &#160;<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_parent<span class="es0">\"</span>&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="co1">// Initially set all spans to the background color</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GameSpan &#160; &#160; &#160; &#160;= Background;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutatorSpan = Background;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MapSpan &#160; &#160; &#160; &#160; = Background;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; RuleSpan &#160; &#160; &#160; &#160;= Background;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewSpan &#160; &#160; &#160;= Background;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Then set the appropriate span to the highlighted color</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SubTitle"</span>, CurS.<span class="me1">GetValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">switch</span> <span class="br0">(</span>Page<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">case</span> SubGametypeURI:</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Curs.<span class="me1">SetValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>,&#160; &#160; &#160;&#160; &#160; &#160; &#160; ProfileButtonName<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Curs.<span class="me1">SetValue</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, &#160; &#160;ProfileButtonValue<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageHelp"</span>, HelpGameType<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GameSpan = Highlighted; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">case</span> SubMutatorsURI:</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Curs.<span class="me1">SetValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, &#160; &#160; ProfileButtonName<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Curs.<span class="me1">SetValue</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, &#160; &#160;ProfileButtonValue<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageHelp"</span>, HelpMutators<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutatorSpan = Highlighted; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">case</span> SubMapsURI:</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Curs.<span class="me1">SetValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, &#160; &#160; ProfileButtonName<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Curs.<span class="me1">SetValue</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, &#160; &#160;ProfileButtonValue<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageHelp"</span>, HelpMaps<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mapspan = Highlighted; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">case</span> SubRulesURI:</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Curs.<span class="me1">SetValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, &#160; &#160; ProfileButtonName<span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Curs.<span class="me1">SetValue</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, &#160; &#160;ProfileButtonValue<span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageHelp"</span>, HelpPlayInfo<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; RuleSpan = Highlighted; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">case</span> SubReviewURI:</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Curs.<span class="me1">SetValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, &#160; &#160; ProfileButtonName<span class="br0">[</span><span class="nu0">5</span><span class="br0">]</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Curs.<span class="me1">SetValue</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, &#160; &#160;ProfileButtonValue<span class="br0">[</span><span class="nu0">5</span><span class="br0">]</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageHelp"</span>, HelpReview<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewSpan = Highlighted; <span class="kw1">break</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GameLink &#160; &#160; &#160; &#160;= GameLink &#160; &#160; &#160;&#160; &#160; &#160; &#160; $ GameSpan &#160; &#160; &#160;&#160; &#160; &#160; &#160; $ TableTitle<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span>$<span class="st0">"&lt;/span&gt;&lt;/a&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutatorLink = MutatorLink &#160; &#160; &#160; $ MutatorSpan &#160; $ TableTitle<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span>$<span class="st0">"&lt;/span&gt;&lt;/a&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MapLink &#160; &#160; &#160; &#160; = MapLink &#160; &#160; &#160; &#160; &#160; &#160; &#160; $ MapSpan &#160; &#160; &#160; &#160; &#160; &#160; &#160; $ TableTitle<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span>$<span class="st0">"&lt;/span&gt;&lt;/a&gt;"</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; RuleLink &#160; &#160; &#160; &#160;= RuleLink &#160; &#160; &#160;&#160; &#160; &#160; &#160; $ RuleSpan &#160; &#160; &#160;&#160; &#160; &#160; &#160; $ TableTitle<span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span>$<span class="st0">"&lt;/span&gt;&lt;/a&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewLink &#160; &#160; &#160;= ReviewLink &#160; &#160;$ ReviewSpan &#160; &#160;$ TableTitle<span class="br0">[</span><span class="nu0">5</span><span class="br0">]</span>$<span class="st0">"&lt;/span&gt;&lt;/a&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"GameTypeLink"</span>, &#160; &#160; &#160; GameLink<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"MutatorsLink"</span>, &#160; &#160; &#160; MutatorLink<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"MapsLink"</span>, &#160; &#160; &#160; &#160; &#160; MapLink<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RulesLink"</span>, &#160;&#160; &#160; &#160; &#160; RuleLink<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ReviewLink"</span>, &#160; &#160; &#160; &#160; ReviewLink<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowPage<span class="br0">(</span>Res, SubFrameMenu<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> AccessDenied<span class="br0">(</span>Res<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">function</span> QueryLadderView<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i,j;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session &#160; CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span>&#160; &#160; SID,</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ViewRows,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewProfile,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewGameType;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> StringArray &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators, GroupsOnly, ServerActors;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;GameInfo&gt; &#160; &#160; &#160; &#160; &#160; GIClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;AccessControl&gt; &#160; &#160; &#160;ACClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Mutator&gt;&#160; &#160; &#160; &#160; &#160; &#160; TempMut;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Info&gt;&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempSA;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Lv"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>SID,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Ls"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SetProfileName"</span>,<span class="st0">""</span><span class="br0">)</span>!=<span class="st0">""</span><span class="br0">)</span> <span class="co1">// We would like to view a different profile</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"ProfileNameSelect"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">If</span> <span class="br0">(</span>TempStr == <span class="st0">""</span><span class="br0">)</span>&#160; &#160; &#160; <span class="co1">// Not selecting a new profile to view</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// First, see if the current session is holding a profile</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewProfile = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileIndex"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>NewProfile == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// See if a profile is currently loaded</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = GetCurrentConfigIndex<span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>j!=<span class="nu0">-1</span><span class="br0">)</span>&#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Found an active profile - this profile should be selected</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewProfile = <span class="kw4">string</span><span class="br0">(</span>j<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr!=<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewProfile = TempStr;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, <span class="st0">"SetProfileName"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, ButtonLoadProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageCaption"</span>, <span class="st0">"&lt;select class=mini name='ProfileNameSelect'&gt;"</span>$GenerateSwitchProfileOptions<span class="br0">(</span>NewProfile<span class="br0">)</span>$<span class="st0">"&lt;/select&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// If admin doesn't have switch privileges, check for current profile</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>NewProfile == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewProfile = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileIndex"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>NewProfile == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = GetCurrentConfigIndex<span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>j&#160;!= <span class="nu0">-1</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewProfile = <span class="kw4">string</span><span class="br0">(</span>j<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>NewProfile&#160;!= <span class="st0">""</span> &amp;&amp; LadderRules.<span class="me1">AllLadderProfiles</span>.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"ProfileIndex"</span>, NewProfile, <span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; CreateSessionInfo<span class="br0">(</span>NewProfile,SID<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewGameType = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>NewGameType&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GIClass = class&lt;GameInfo&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>NewGameType,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>GIClass==<span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorGameClassTitle,ErrorGameClassText<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ACClass"</span>,<span class="kw8">Level</span>.<span class="me1">Game</span>.<span class="me1">AccessControlClass</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ACClass = class&lt;AccessControl&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ACClass == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorAccessControlTitle,ErrorAccessControlText<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GroupsOnly = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ServerActors = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Mutator Section</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getMutatorLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getMutator</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>j=<span class="nu0">0</span>;j&lt;AllMutators.<span class="kw6">Length</span>;j++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr ~= AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempMut = class&lt;Mutator&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempMut&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>j<span class="br0">)</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">FriendlyName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getSALength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">GetServerActor</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>j=<span class="nu0">0</span>;j&lt;ConfigM.<span class="me1">ManagedActors</span>.<span class="kw6">Length</span>;j++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr ~= <span class="kw4">string</span><span class="br0">(</span>ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SAClass</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempSA = class&lt;Info&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempSA&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ServerActors.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>j<span class="br0">)</span>,ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SAName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, TableTitle<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ViewRows = ViewRows$WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i&lt;ServerActors.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = <span class="kw4">int</span><span class="br0">(</span>ServerActors.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, ServerActors.<span class="me1">GetTag</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">SARequired</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SAClass</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, RequiredText<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ViewRows = ViewRows $ WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ViewRows = ViewRows $ <span class="st0">"&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;&amp;nbsp;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i&lt;Mutators.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = <span class="kw4">int</span><span class="br0">(</span>Mutators.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">FriendlyName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">MutRequired</span><span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, RequiredText<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ViewRows = ViewRows$WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, TableTitle<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ViewRows = ViewRows$WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, LabelMaxMaps<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"MaxMaps"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr == <span class="st0">"0"</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = UnlimitedText;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>, <span class="st0">"&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;&amp;nbsp;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ViewRows = ViewRows$WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getMapLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getMap</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, TempStr<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">MapRequired</span><span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, RequiredText<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ViewRows = ViewRows$WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, TableTitle<span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ViewRows = ViewRows $ WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ViewRows = ViewRows $ <span class="st0">"&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span> $ GeneratePlayInfoRows<span class="br0">(</span>Req, Res, IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// We have no profile currently active</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, PageCaption<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ViewRows = ViewRows $ WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span>, PageCaption<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderRules.<span class="me1">GetRemainingMatches</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0</span> &amp;&amp; TempStr == LadderRules.<span class="me1">Profiles</span><span class="br0">[</span>GetCurrentConfigIndex<span class="br0">(</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">ProfileName</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = TempStr @ LabelNumberMatchesLeft @ <span class="kw4">string</span><span class="br0">(</span>LadderRules.<span class="me1">GetRemainingMatches</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TableRows"</span>, ViewRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"LadderTable"</span>, WebInclude<span class="br0">(</span>IncludeCaptionButton<span class="br0">)</span>$WebInclude<span class="br0">(</span>IncludeTable<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Section"</span>, LinkViewProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SubTitle"</span>, TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageHelp"</span>, HelpViewProfile<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PostAction"</span>, ProfileViewURI$<span class="st0">"?SessionID="</span>$SID<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowPage<span class="br0">(</span>Res, MasterPage<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">else</span> AccessDenied<span class="br0">(</span>Res<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> QueryLadderEdit<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">bool</span> &#160; &#160; &#160;bAllMuts;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> &#160; &#160; &#160; i,j,k,z,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; id,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Count,</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MoveCount;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span>&#160; &#160; SID,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr, Tmp, NewProfile, NewGameType,</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; lastgroup, thisgroup, nextgroup, EmptyRow;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> ProfileConfigSet &#160;&#160; &#160; &#160; &#160; TempPCS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;string&gt; &#160; &#160; &#160; &#160; &#160; &#160; TempMutes;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;GameInfo&gt; &#160; &#160; &#160; &#160; &#160; GIClass;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;AccessControl&gt; &#160; &#160; &#160;ACClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;ProfileConfigSet.<span class="me1">ProfileMap</span>&gt; &#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; AllPCSMaps;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;ProfileConfigSet.<span class="me1">ProfileMutator</span>&gt; &#160; &#160;AllPCSMutators;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;ProfileConfigSet.<span class="me1">ProfileSA</span>&gt;&#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; AllPCSServerActors;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> StringArray</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators, GroupsOnly, Required, ServerActors, ReqSA,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; RequiredMaps, IncludeMaps, ExcludeMaps, MovedMaps;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>SID,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Le"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Ls"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SetProfileName"</span>,<span class="st0">""</span><span class="br0">)</span>!=<span class="st0">""</span><span class="br0">)</span> <span class="co1">// We would like to view a different profile</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"ProfileNameSelect"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">If</span> <span class="br0">(</span>TempStr == <span class="st0">""</span><span class="br0">)</span>&#160; &#160; &#160; <span class="co1">// Not selecting a new profile to view</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// First, see if the current session is holding a profile</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewProfile = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileIndex"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>NewProfile == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// See if a profile is currently loaded</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = GetCurrentConfigIndex<span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>j!=<span class="nu0">-1</span><span class="br0">)</span>&#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Found an active profile - this profile should be selected</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewProfile = <span class="kw4">string</span><span class="br0">(</span>j<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr!=<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewProfile = TempStr;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, <span class="st0">"SetProfileName"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, ButtonLoadProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageCaption"</span>, <span class="st0">"&lt;select class=mini name='ProfileNameSelect'&gt;"</span>$GenerateSwitchProfileOptions<span class="br0">(</span>NewProfile<span class="br0">)</span>$<span class="st0">"&lt;/select&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"CurrentPage"</span>, ProfileEditURI, <span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, <span class="st0">"ApplyProfileChanges"</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, ButtonApplyProfileChanges, <span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// If admin doesn't have switch privileges, check for current profile</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>NewProfile == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewProfile = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileIndex"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>NewProfile == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = GetCurrentConfigIndex<span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>j&#160;!= <span class="nu0">-1</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewProfile = <span class="kw4">string</span><span class="br0">(</span>j<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"ProfileIndex"</span>, NewProfile, <span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>NewProfile&#160;!= <span class="st0">""</span> &amp;&amp; LadderRules.<span class="me1">AllLadderProfiles</span>.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileMaps.<span class="me1">Reset</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Required = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> &#160; &#160;&#160; &#160; &#160; &#160; <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReqSA&#160; &#160;= <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span>&#160; &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> &#160; &#160;&#160; &#160; &#160; &#160; <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MovedMaps = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> &#160; &#160; &#160; &#160; &#160; <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GroupsOnly = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> &#160;&#160; &#160; &#160; &#160; <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ServerActors = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span>&#160; &#160; &#160; &#160; <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; IncludeMaps = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> &#160; &#160; &#160; &#160; <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ExcludeMaps = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> &#160; &#160; &#160; &#160; <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; RequiredMaps = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> &#160; &#160; &#160; &#160;<span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; CreateSessionInfo<span class="br0">(</span>NewProfile,SID<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS = LadderRules.<span class="me1">LadderProfiles</span><span class="br0">[</span><span class="kw4">int</span><span class="br0">(</span>NewProfile<span class="br0">)</span><span class="br0">]</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">StartEdit</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewGameType = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GIClass = class&lt;GameInfo&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>NewGameType,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>GIClass==<span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorGameClassTitle,ErrorGameClassText<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ACClass"</span>, <span class="kw8">Level</span>.<span class="me1">Game</span>.<span class="me1">AccessControlClass</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ACClass = class&lt;AccessControl&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; AllPCSMutators = TempPCS.<span class="me1">GetProfileMutators</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; AllPCSMaps = TempPCS.<span class="me1">GetProfileMaps</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; AllPCSServerActors = TempPCS.<span class="me1">GetProfileServerActors</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Load Exclude Maps</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;AllPCSMaps.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileMaps.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>, AllPCSMaps<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MapName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>AllPCSMaps<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">bRequired</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; RequiredMaps.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>,<span class="kw4">string</span><span class="br0">(</span>AllPCSMaps<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MapListOrder</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; IncludeMaps.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>,<span class="kw4">string</span><span class="br0">(</span>AllPCSMaps<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MapListOrder</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> ExcludeMaps.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>,<span class="kw4">string</span><span class="br0">(</span>AllPCSMaps<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MapListOrder</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">GetMapLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = ExcludeMaps.<span class="me1">FindItemId</span><span class="br0">(</span>ProfileMaps.<span class="me1">GetItem</span><span class="br0">(</span>ProfileMaps.<span class="me1">FindTagId</span><span class="br0">(</span>CurS.<span class="me1">getMap</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>j &gt;= <span class="nu0">0</span><span class="br0">)</span> IncludeMaps.<span class="me1">MoveFromId</span><span class="br0">(</span>ExcludeMaps, j<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"ApplyProfileChanges"</span>,<span class="st0">""</span><span class="br0">)</span>!=<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;AllPCSMutators.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>j=<span class="nu0">0</span>;j&lt;AllMutators.<span class="kw6">Length</span>;j++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>AllPCSMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MutatorName</span> ~= AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>j<span class="br0">)</span>,AllPCSMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MutatorName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;Mutators.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span><span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>Mutators.<span class="me1">GetTag</span><span class="br0">(</span>i<span class="br0">)</span>,<span class="st0">""</span><span class="br0">)</span>!=<span class="st0">""</span><span class="br0">)</span>||<span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>AllMutators<span class="br0">[</span><span class="kw4">int</span><span class="br0">(</span>Mutators.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">GroupName</span><span class="br0">)</span>~=Mutators.<span class="me1">GetTag</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">AddMutator</span><span class="br0">(</span>Mutators.<span class="me1">GetTag</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> TempPCS.<span class="me1">DelMutator</span><span class="br0">(</span>Mutators.<span class="me1">GetTag</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;AllPCSServerActors.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>AllPCSServerActors<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ActorClass</span>,<span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">AddServerActor</span><span class="br0">(</span>AllPCSServerActors<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ActorClass</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> TempPCS.<span class="me1">DelServerActor</span><span class="br0">(</span>AllPCSServerActors<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ActorClass</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;AllPCSMaps.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>AllPCSMaps<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">bRequired</span><span class="br0">)</span> TempPCS.<span class="me1">AddMap</span><span class="br0">(</span>AllPCSMaps<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MapName</span>,<span class="kw4">int</span><span class="br0">(</span>RequiredMaps.<span class="me1">GetTag</span><span class="br0">(</span>RequiredMaps.<span class="me1">FindItemId</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>IncludeMaps.<span class="me1">FindItemId</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span> &gt;= <span class="nu0">0</span><span class="br0">)</span> TempPCS.<span class="me1">AddMap</span><span class="br0">(</span>AllPCSMaps<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MapName</span>,<span class="kw4">int</span><span class="br0">(</span>IncludeMaps.<span class="me1">GetTag</span><span class="br0">(</span>IncludeMaps.<span class="me1">FindItemId</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> TempPCS.<span class="me1">RemoveMap</span><span class="br0">(</span>AllPCSMaps<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MapName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CreateSessionInfo<span class="br0">(</span>NewProfile,SID,<span class="kw9">false</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"AddMap"</span>, <span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Count = Req.<span class="me1">GetVariableCount</span><span class="br0">(</span><span class="st0">"ExcludeMapsSelect"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>; i&lt;Count; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>IncludeMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span> &gt;= TempPCS.<span class="me1">MaxMaps</span> &amp;&amp; TempPCS.<span class="me1">MaxMaps</span> &gt; <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ExcludeMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; id = IncludeMaps.<span class="me1">MoveFromId</span><span class="br0">(</span>ExcludeMaps, ExcludeMaps.<span class="me1">FindItemId</span><span class="br0">(</span>ProfileMaps.<span class="me1">GetItem</span><span class="br0">(</span>ProfileMaps.<span class="me1">FindTagId</span><span class="br0">(</span>Req.<span class="me1">GetVariableNumber</span><span class="br0">(</span><span class="st0">"ExcludeMapsSelect"</span>, i<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>id &gt;= <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">AddMap</span><span class="br0">(</span>AllPCSMaps<span class="br0">[</span><span class="kw4">int</span><span class="br0">(</span>IncludeMaps.<span class="me1">getItem</span><span class="br0">(</span>id<span class="br0">)</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">MapName</span>,<span class="kw4">int</span><span class="br0">(</span>IncludeMaps.<span class="me1">getTag</span><span class="br0">(</span>id<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MovedMaps.<span class="me1">CopyFromId</span><span class="br0">(</span>IncludeMaps, id<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw7">Log</span><span class="br0">(</span>ErrorExcludeMapNotFound@Req.<span class="me1">GetVariableNumber</span><span class="br0">(</span><span class="st0">"ExcludeMapsSelect"</span>, i<span class="br0">)</span>,LOGNAME<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;IncludeMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">AddMap</span><span class="br0">(</span>AllPCSMaps<span class="br0">[</span><span class="kw4">int</span><span class="br0">(</span>IncludeMaps.<span class="me1">getItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">MapName</span>,i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CreateSessionInfo<span class="br0">(</span>NewProfile,SID,<span class="kw9">false</span>,<span class="kw9">true</span>,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"DelMap"</span>, <span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span> &amp;&amp; Req.<span class="me1">GetVariableCount</span><span class="br0">(</span><span class="st0">"IncludeMapsSelect"</span><span class="br0">)</span> &gt; <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Count = Req.<span class="me1">GetVariableCount</span><span class="br0">(</span><span class="st0">"IncludeMapsSelect"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>; i&lt;Count; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>RequiredMaps.<span class="me1">FindItemId</span><span class="br0">(</span>ProfileMaps.<span class="me1">GetItem</span><span class="br0">(</span>ProfileMaps.<span class="me1">FindTagId</span><span class="br0">(</span>Req.<span class="me1">GetVariableNumber</span><span class="br0">(</span><span class="st0">"IncludeMapsSelect"</span>, i<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> &lt; <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>IncludeMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; id = ExcludeMaps.<span class="me1">MoveFromId</span><span class="br0">(</span>IncludeMaps, IncludeMaps.<span class="me1">FindItemId</span><span class="br0">(</span>ProfileMaps.<span class="me1">GetItem</span><span class="br0">(</span>ProfileMaps.<span class="me1">FindTagId</span><span class="br0">(</span>Req.<span class="me1">GetVariableNumber</span><span class="br0">(</span><span class="st0">"IncludeMapsSelect"</span>, i<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>id &gt;= <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">RemoveMap</span><span class="br0">(</span>AllPCSMaps<span class="br0">[</span><span class="kw4">int</span><span class="br0">(</span>ExcludeMaps.<span class="me1">GetItem</span><span class="br0">(</span>id<span class="br0">)</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">MapName</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MovedMaps.<span class="me1">CopyFromId</span><span class="br0">(</span>ExcludeMaps, id<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw7">Log</span><span class="br0">(</span>ErrorIncludeMapNotFound@Req.<span class="me1">GetVariableNumber</span><span class="br0">(</span><span class="st0">"IncludeMapsSelect"</span>, i<span class="br0">)</span>,LOGNAME<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CreateSessionInfo<span class="br0">(</span>NewProfile,SID,<span class="kw9">false</span>,<span class="kw9">true</span>,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"AddAllMap"</span>, <span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">while</span> <span class="br0">(</span>ExcludeMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0</span> &amp;&amp; <span class="br0">(</span>IncludeMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span> &lt; TempPCS.<span class="me1">MaxMaps</span> || TempPCS.<span class="me1">MaxMaps</span> == <span class="nu0">0</span><span class="br0">)</span> <span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; id = IncludeMaps.<span class="me1">MoveFromId</span><span class="br0">(</span>ExcludeMaps, ExcludeMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span><span class="nu0">-1</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>id &gt;= <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">AddMap</span><span class="br0">(</span>AllPCSMaps<span class="br0">[</span><span class="kw4">int</span><span class="br0">(</span>IncludeMaps.<span class="me1">getItem</span><span class="br0">(</span>id<span class="br0">)</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">MapName</span>,<span class="kw4">int</span><span class="br0">(</span>IncludeMaps.<span class="me1">getTag</span><span class="br0">(</span>id<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MovedMaps.<span class="me1">CopyFromId</span><span class="br0">(</span>IncludeMaps, id<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;IncludeMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">AddMap</span><span class="br0">(</span>AllPCSMaps<span class="br0">[</span><span class="kw4">int</span><span class="br0">(</span>IncludeMaps.<span class="me1">getItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">MapName</span>,i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;CreateSessionInfo<span class="br0">(</span>NewProfile,SID,<span class="kw9">false</span>,<span class="kw9">true</span>,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"DelAllMap"</span>, <span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; i = IncludeMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">while</span> <span class="br0">(</span>i &gt; <span class="nu0">0</span> &amp;&amp; IncludeMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span> &gt; RequiredMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>RequiredMaps.<span class="me1">FindItemId</span><span class="br0">(</span>IncludeMaps.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="nu0">-1</span><span class="br0">)</span><span class="br0">)</span> &lt; <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; id = &#160;ExcludeMaps.<span class="me1">MoveFromId</span><span class="br0">(</span>IncludeMaps, i<span class="nu0">-1</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>id &gt;= <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">RemoveMap</span><span class="br0">(</span>AllPCSMaps<span class="br0">[</span><span class="kw4">int</span><span class="br0">(</span>ExcludeMaps.<span class="me1">GetItem</span><span class="br0">(</span>id<span class="br0">)</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">MapName</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MovedMaps.<span class="me1">CopyFromId</span><span class="br0">(</span>ExcludeMaps, id<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; i--;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CreateSessionInfo<span class="br0">(</span>NewProfile,SID,<span class="kw9">false</span>,<span class="kw9">true</span>,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"MoveMap"</span>, <span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MoveCount = <span class="kw4">int</span><span class="br0">(</span><span class="kw7">Abs</span><span class="br0">(</span><span class="kw4">float</span><span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"MoveMapCount"</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>MoveCount&#160;!= <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Count = Req.<span class="me1">GetVariableCount</span><span class="br0">(</span><span class="st0">"IncludeMapsSelect"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// 1) Create a sorted MovedMaps list</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i&lt;Count; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MovedMaps.<span class="me1">CopyFromId</span><span class="br0">(</span>IncludeMaps, IncludeMaps.<span class="me1">FindItemId</span><span class="br0">(</span>ProfileMaps.<span class="me1">GetItem</span><span class="br0">(</span>ProfileMaps.<span class="me1">FindTagId</span><span class="br0">(</span>Req.<span class="me1">GetVariableNumber</span><span class="br0">(</span><span class="st0">"IncludeMapsSelect"</span>, i<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"MoveMap"</span><span class="br0">)</span> ~= <span class="st0">"Down"</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// 2) Browse from Last to 0 until all maps are moved by count</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// &#160; &#160;but stop moving them if hitting bottom</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = IncludeMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span><span class="nu0">-1</span>; i &gt;= <span class="nu0">0</span>; i--<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>MovedMaps.<span class="me1">FindItemId</span><span class="br0">(</span>IncludeMaps.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span> &gt;= <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; IncludeMaps.<span class="me1">ShiftStrict</span><span class="br0">(</span>i, MoveCount<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MoveCount = -MoveCount;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i&lt;IncludeMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>MovedMaps.<span class="me1">FindItemId</span><span class="br0">(</span>IncludeMaps.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span> &gt;= <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; IncludeMaps.<span class="me1">ShiftStrict</span><span class="br0">(</span>i, MoveCount<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;IncludeMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">AddMap</span><span class="br0">(</span>AllPCSMaps<span class="br0">[</span><span class="kw4">int</span><span class="br0">(</span>IncludeMaps.<span class="me1">getItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">MapName</span>,i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CreateSessionInfo<span class="br0">(</span>NewProfile,SID,<span class="kw9">false</span>,<span class="kw9">true</span>,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempPCS.<span class="me1">CanEdit</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">StartEdit</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Mutator Section</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators.<span class="me1">Reset</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="co1">// Set active ServerActors</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempMutes = LoadActiveProfileServerActors<span class="br0">(</span>NewProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="kw5">class</span><span class="st0">'wUtils103.wArray'</span>.<span class="kw6">static</span>.<span class="me1">Join</span><span class="br0">(</span>TempMutes,<span class="st0">","</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bAllMuts = TempMutes.<span class="kw6">Length</span> == ConfigM.<span class="me1">ManagedActors</span>.<span class="kw6">Length</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;AllPCSServerActors.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>j = <span class="nu0">0</span>; j &lt; ConfigM.<span class="me1">ManagedActors</span>.<span class="kw6">Length</span>; j++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>AllPCSServerActors<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ActorClass</span> ~= <span class="kw4">string</span><span class="br0">(</span>ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SAClass</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>AllPCSServerActors<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">bRequired</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReqSA.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>j<span class="br0">)</span>, ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SAName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> ServerActors.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>j<span class="br0">)</span>,ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SAName</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempMutes = LoadActiveProfileMutators<span class="br0">(</span>NewProfile<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="kw5">class</span><span class="st0">'wUtils103.wArray'</span>.<span class="kw6">static</span>.<span class="me1">Join</span><span class="br0">(</span>TempMutes,<span class="st0">","</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Set Available Mutators for this profile</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bAllMuts = bAllMuts &amp;&amp; AllPCSMutators.<span class="kw6">Length</span> == AllMutators.<span class="kw6">Length</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;AllPCSMutators.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>j=<span class="nu0">0</span>;j&lt;AllMutators.<span class="kw6">Length</span>;j++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span> ~= AllPCSMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MutatorName</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>AllPCSMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">bRequired</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Required.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>j<span class="br0">)</span>,AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">FriendlyName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Don't add available mutator if it belongs in the same group as a required mutator</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>k=<span class="nu0">0</span>;k&lt;Required.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;k++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>AllMutators<span class="br0">[</span><span class="kw4">int</span><span class="br0">(</span>Required.<span class="me1">GetItem</span><span class="br0">(</span>k<span class="br0">)</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">GroupName</span> ~= AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">GroupName</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>k==Required.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>j<span class="br0">)</span>,AllPCSMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">MutatorName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// BEGIN OUTPUT ////////////////////////////////////////////</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">/*</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; TempMutes is an array of active mutators, including required ones</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; AllPCSMutators is a ProfileMutator array, which includes a required flag</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; Need to generate a regular mutator selection list, but list all required</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; first, followed by the list of all other mutators which are available</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">*/</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// MAPS</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpanLength"</span>, <span class="st0">"2"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpanContent"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EmptyRow = <span class="st0">"&lt;tr&gt;"</span> $ WebInclude<span class="br0">(</span>CellColSpan<span class="br0">)</span> $ <span class="st0">"&lt;/tr&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, TableTitle<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="kw4">string</span><span class="br0">(</span>TempPCS.<span class="me1">GetMaxMaps</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr == <span class="st0">"0"</span><span class="br0">)</span> TempStr = <span class="st0">"Unlimited"</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, LabelMaxMaps$<span class="st0">":"</span>@TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows += WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = RequiredMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>j &gt; <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows = EditRows $ EmptyRow $ <span class="st0">"&lt;tr&gt;&lt;td class=ttext&gt;"</span> $ RequiredText @ MapText $ <span class="st0">"&lt;/td&gt;&lt;td class=ttext&gt;"</span> $ FollowingMaps@AreAssignedText $ <span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; i=<span class="nu0">0</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">while</span> <span class="br0">(</span>i&lt;j<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, AllPCSMaps<span class="br0">[</span><span class="kw4">int</span><span class="br0">(</span>RequiredMaps.<span class="me1">GetItem</span><span class="br0">(</span>i++<span class="br0">)</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">MapName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, StringIf<span class="br0">(</span>i &lt; j, AllPCSMaps<span class="br0">[</span><span class="kw4">int</span><span class="br0">(</span>RequiredMaps.<span class="me1">GetItem</span><span class="br0">(</span>i++<span class="br0">)</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">MapName</span>, <span class="st0">""</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows += WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows = EditRows $ EmptyRow $ <span class="st0">"&lt;tr&gt;&lt;td class=ttext&gt;"</span> $ AvailableText@MapText $ <span class="st0">"&lt;/td&gt;&lt;td class=ttext&gt;"</span> $ LabelChangeMaplist $ <span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ExcludeMapsOptions"</span>, CreateMapListSelect<span class="br0">(</span>AllPCSMaps, ExcludeMaps,MovedMaps<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"IncludeMapsOptions"</span>, CreateMapListSelect<span class="br0">(</span>AllPCSMaps, IncludeMaps,MovedMaps<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpanContent"</span>, WebInclude<span class="br0">(</span>IncludeMapSelect<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, WebInclude<span class="br0">(</span>CellColSpan<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// MUTATORS</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CreateFullMutatorList<span class="br0">(</span>Mutators,GroupsOnly<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, TableTitle<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows += WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ReqSA.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0</span> || Required.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows = EditRows $ EmptyRow $ <span class="st0">"&lt;tr&gt;&lt;td class=ttext&gt;"</span> $ RequiredText@MutatorText $ <span class="st0">"&lt;/td&gt;&lt;td class=ttext&gt;"</span> $ FollowingMutators@AreAssignedText $ <span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Include ServerActors first</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;ReqSA.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = <span class="kw4">int</span><span class="br0">(</span>ReqSA.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, ReqSA.<span class="me1">GetTag</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SADescription</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows += WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;Required.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j=<span class="kw4">int</span><span class="br0">(</span>Required.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">FriendlyName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Description</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows += WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows = EditRows $ EmptyRow $ <span class="st0">"&lt;tr&gt;&lt;td class=ttext&gt;"</span> $ AvailableText@MutatorText $ <span class="st0">"&lt;/td&gt;&lt;td class=ttext&gt;"</span> $ FollowingMutators@AreAvailableText $ <span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;GroupsOnly.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j=<span class="kw4">int</span><span class="br0">(</span>GroupsOnly.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">GroupName</span>==<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; thisgroup=<span class="st0">"Z"</span>$string<span class="br0">(</span>z++<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> thisgroup = AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">GroupName</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span> <span class="br0">(</span>i + <span class="nu0">1</span><span class="br0">)</span> == GroupsOnly.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; nextgroup = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Assign nextgroup to the next mutators group</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; k = <span class="kw4">int</span><span class="br0">(</span>GroupsOnly.<span class="me1">GetItem</span><span class="br0">(</span>i + <span class="nu0">1</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>AllMutators<span class="br0">[</span>k<span class="br0">]</span>.<span class="me1">GroupName</span>==<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; nextgroup=<span class="st0">"Z"</span>$string<span class="br0">(</span>z<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> nextgroup = AllMutators<span class="br0">[</span>k<span class="br0">]</span>.<span class="me1">GroupName</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"GroupName"</span>, thisgroup<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"MutatorClass"</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"MutatorName"</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">FriendlyName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"MutatorDesc"</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Description</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span><span class="br0">(</span>lastgroup&#160;!= thisgroup<span class="br0">)</span> &amp;&amp; <span class="br0">(</span>thisgroup == nextgroup<span class="br0">)</span><span class="br0">)</span> <span class="co1">// and the next mut is in the same group as this one</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Checked"</span>, <span class="st0">" checked"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows += WebInclude<span class="br0">(</span><span class="st0">"current_mutators_group"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Checked"</span>, StringIf<span class="br0">(</span>CurS.<span class="me1">HasMutator</span><span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span>, <span class="st0">" checked"</span>, <span class="st0">""</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows += WebInclude<span class="br0">(</span><span class="st0">"current_mutators_group_row"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; lastgroup=thisgroup;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Add ServerActors first</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i &lt; ServerActors.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = <span class="kw4">int</span><span class="br0">(</span>ServerActors.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, Checkbox<span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SAClass</span><span class="br0">)</span>, CurS.<span class="me1">HasServerActor</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SAClass</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> $ <span class="st0">"&amp;nbsp;"</span> $ ServerActors.<span class="me1">GetTag</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = WebInclude<span class="br0">(</span>NowrapLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SADescription</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, TempStr $ WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i&lt;Mutators.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="st0">""</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = <span class="kw4">int</span><span class="br0">(</span>Mutators.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, Checkbox<span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span>,CurS.<span class="me1">HasMutator</span><span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span><span class="br0">)</span> $ <span class="st0">"&amp;nbsp;"</span> $ AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">FriendlyName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr += WebInclude<span class="br0">(</span>NowrapLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Description</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, TempStr $ WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">EndEdit</span><span class="br0">(</span><span class="kw9">False</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="co1">// We have no profile currently active</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, PageCaption<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EditRows += WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TableRows"</span>, EditRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = WebInclude<span class="br0">(</span>IncludeCaptionButton<span class="br0">)</span>$Tmp$WebInclude<span class="br0">(</span>IncludeTable<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>NewProfile&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, curS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>,<span class="st0">"ApplyProfileChanges"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, ButtonApplyProfileChanges<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageCaption"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr += WebInclude<span class="br0">(</span>IncludeCaptionButton<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Tmp = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span>,PageCaption<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderRules.<span class="me1">GetRemainingMatches</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0</span> &amp;&amp; Tmp == LadderRules.<span class="me1">Profiles</span><span class="br0">[</span>GetCurrentConfigIndex<span class="br0">(</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">ProfileName</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Tmp = Tmp @ LabelNumberMatchesLeft @ <span class="kw4">string</span><span class="br0">(</span>LadderRules.<span class="me1">GetRemainingMatches</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"LadderTable"</span>, &#160; &#160; &#160; &#160;TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Section"</span>,&#160; &#160; &#160;&#160; &#160; &#160; &#160;LinkEditProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SubTitle"</span>, &#160; &#160; &#160; &#160; &#160; Tmp<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageHelp"</span>, &#160; &#160; &#160; &#160; &#160; HelpEditProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PostAction"</span>, &#160; &#160; &#160; &#160; ProfileEditURI$<span class="st0">"?SessionID="</span>$SID<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowPage<span class="br0">(</span>Res, MasterPage<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">else</span> AccessDenied<span class="br0">(</span>Res<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> QueryLadderSwitch<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> &#160; &#160; &#160; &#160; &#160; &#160; &#160; j, NumMatches;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">bool</span>&#160; &#160; &#160; &#160; &#160; &#160; &#160; bDelayChange, bSwitching;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session &#160; CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> &#160; &#160;SID,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr, Tmp,</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Checked;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>SID,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Ls"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"ProfileNameSelect"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Tmp = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SetNewProfile"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Tmp&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NumMatches = <span class="kw4">int</span><span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"NumMatches"</span>, <span class="st0">"0"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bDelayChange = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"DelaySwitch"</span>,<span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>bDelayChange<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderRules.<span class="me1">WaitApplyProfile</span><span class="br0">(</span>TempStr, NumMatches<span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"ProfileIndex"</span>, TempStr, <span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bSwitching = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// We would like to switch immediately</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; LadderRules.<span class="me1">ApplyProfile</span><span class="br0">(</span>TempStr, NumMatches<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MapIsChanging<span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> StatusError<span class="br0">(</span>Res, ErrorNoProfilesExist<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>LadderRules.<span class="me1">Profiles</span>.<span class="kw6">Length</span> &gt; <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = GetCurrentConfigIndex<span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>j &gt;= <span class="nu0">0</span><span class="br0">)</span> TempStr = <span class="kw4">string</span><span class="br0">(</span>j<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bDelayChange = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"DelaySwitch"</span>,<span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span> || LadderRules.<span class="me1">bWaitingToSwitch</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>bDelayChange<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Checked = <span class="st0">" checked"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> Checked = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ProfileSelect"</span>, &#160; &#160; &#160;&#160; &#160; &#160; &#160; GenerateSwitchProfileOptions<span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"NumberGamesText"</span>, &#160; &#160;LabelNumberGames<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TextName"</span>, &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="st0">"NumMatches"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TextValue"</span>, &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw4">string</span><span class="br0">(</span>NumMatches<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TextSize"</span>, &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="st0">"3"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TextLength"</span>, &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="st0">"3"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SwitchButtonName"</span>, &#160; <span class="st0">"SetNewProfile"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SwitchButtonValue"</span>, &#160;ButtonLoadProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"DelayCheckName"</span>, &#160; &#160; <span class="st0">"DelaySwitch"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Checked"</span>, &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Checked<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"DelayCheckLabel"</span>, &#160; &#160;LabelDelayProfileChange<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Tmp&#160;!= <span class="st0">""</span> &amp;&amp; bSwitching<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; StatusOK<span class="br0">(</span>Res, SuccessSwitchProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Tmp = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span>, PageCaption<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderRules.<span class="me1">GetRemainingMatches</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0</span> &amp;&amp; Tmp == LadderRules.<span class="me1">Profiles</span><span class="br0">[</span>GetCurrentConfigIndex<span class="br0">(</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">ProfileName</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Tmp = Tmp @ LabelNumberMatchesLeft @ <span class="kw4">string</span><span class="br0">(</span>LadderRules.<span class="me1">GetRemainingMatches</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"LadderTable"</span>, &#160; &#160; &#160; &#160;WebInclude<span class="br0">(</span>IncludeSwitch<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Section"</span>, &#160; &#160;&#160; &#160; &#160; &#160; LinkSwitchProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SubTitle"</span>, &#160; &#160; &#160; &#160; &#160; Tmp<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageHelp"</span>, &#160; &#160; &#160; &#160; &#160; HelpSwitchProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PostAction"</span>, &#160; &#160; &#160; &#160; ProfileSwitchURI$<span class="st0">"?SessionID="</span>$SID<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowPage<span class="br0">(</span>Res, MasterPage<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> AccessDenied<span class="br0">(</span>Res<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">function</span> QuerySubImport<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SID;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> ProfileConfigSet &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>SID,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Lm"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="co1">// We've gotten our profile - want to integrate it into the server now</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"ImportRemoteProfile"</span>,<span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS = CreateImportSessionInfo<span class="br0">(</span>CurS<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempPCS == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res, ImportProfileFailTitle, ImportProfileFailText<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res, SuccessImportProfileTitle, SuccessImportProfile<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> AccessDenied<span class="br0">(</span>Res<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> RemoteImport<span class="br0">(</span>ProfileImporter ProfileConn<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i,j;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session &#160; CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> &#160; &#160;Tmp, TempStr,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ImportRows,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; PackageLink,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewGameType, CustomGameLocation,</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewAccessType, CustomAccessLocation,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ImportProfileHTML,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MapLocation, MutatorLocation, MutatorName;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> StringArray ImportMaps, ImportMutators;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> WebRequest &#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; Req;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> WebResponse &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Req = ProfileConn.<span class="me1">QueryRequest</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res = ProfileConn.<span class="me1">QueryResponse</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Res == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res, ErrorText, ErrorTimeout<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">switch</span> <span class="br0">(</span>ProfileConn.<span class="me1">ImportResult</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> IMPORT_BadURL: &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorText,ErrorBadURL<span class="br0">)</span>; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CleanupQuery<span class="br0">(</span><span class="br0">)</span>;&#160;<span class="kw1">return</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">case</span> IMPORT_ResolveError: &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorText,ErrorResolve<span class="br0">)</span>; &#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; CleanupQuery<span class="br0">(</span><span class="br0">)</span>;&#160;<span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> IMPORT_BindError:&#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorText,ErrorBind<span class="br0">)</span>; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CleanupQuery<span class="br0">(</span><span class="br0">)</span>;&#160;<span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> IMPORT_TimeOut:&#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorText,ErrorTimeout<span class="br0">)</span>;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CleanupQuery<span class="br0">(</span><span class="br0">)</span>;&#160;<span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> IMPORT_ServerError:&#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorText,ErrorServer<span class="br0">)</span>; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CleanupQuery<span class="br0">(</span><span class="br0">)</span>;&#160;<span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> IMPORT_BadRequest:&#160;&#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorText,ErrorBadRequest<span class="br0">)</span>; &#160; &#160; CleanupQuery<span class="br0">(</span><span class="br0">)</span>;&#160;<span class="kw1">return</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">case</span> IMPORT_Unauthorized:&#160; &#160; &#160; &#160;ShowMessage<span class="br0">(</span>Res,ErrorText,ErrorUnauthorized<span class="br0">)</span>;&#160; &#160;CleanupQuery<span class="br0">(</span><span class="br0">)</span>;&#160;<span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> IMPORT_Forbidden:&#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorText,ErrorForbidden<span class="br0">)</span>;&#160; &#160; &#160; &#160; &#160; &#160; &#160; CleanupQuery<span class="br0">(</span><span class="br0">)</span>;&#160;<span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> IMPORT_NotFound:&#160; &#160;&#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorText,ErrorNotFound<span class="br0">)</span>; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CleanupQuery<span class="br0">(</span><span class="br0">)</span>;&#160;<span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">case</span> IMPORT_InvalidProfile:&#160; &#160; &#160;ShowMessage<span class="br0">(</span>Res,ErrorText,ErrorProfile<span class="br0">)</span>;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CleanupQuery<span class="br0">(</span><span class="br0">)</span>;&#160;<span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CurS = ProfileConn.<span class="me1">ImportS</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; ImportMaps = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; ImportMutators = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// General Profile Info</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, LabelGeneralProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; ImportRows += WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, LabelProfileName<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>,<span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; ImportRows += WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// Profile Gametype Class</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; NewGameType = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CustomGameLocation = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"CustomGameLoc"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CustomGameLocation&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; PackageLink = <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$CustomGameLocation$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_blank<span class="es0">\"</span>&gt;"</span>$CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameName"</span><span class="br0">)</span>$<span class="st0">"&lt;/a&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> PackageLink = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameName"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, LabelGameType<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, PackageLink<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>,<span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; ImportRows += WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Profile access control class</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; NewAccessType = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ACClass"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; CustomAccessLocation = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"CustomACLoc"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CustomAccessLocation&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; PackageLink = <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$CustomAccessLocation$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_blank<span class="es0">\"</span>&gt;"</span>$NewAccessType$<span class="st0">"&lt;/a&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> PackageLink = NewAccessType;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, LabelAccessControl<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, PackageLink<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>,<span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; ImportRows += WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Map Information</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, TableTitle<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; ImportRows += WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i &lt; CurS.<span class="me1">getMapLength</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ImportMaps.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>, <span class="kw4">string</span><span class="br0">(</span>CurS.<span class="me1">MapOrder</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i &lt; ImportMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getMap</span><span class="br0">(</span> <span class="kw4">int</span><span class="br0">(</span>ImportMaps.<span class="me1">getItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span> <span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MapLocation = ProfileConn.<span class="me1">FindRemoteZipLocation</span><span class="br0">(</span>TempStr,ProfileConn.<span class="me1">ProfileServerAddress</span> $ ProfileConn.<span class="me1">RemoteProfilePath</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>MapLocation&#160;!= <span class="st0">""</span><span class="br0">)</span> PackageLink = <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$MapLocation$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_blank<span class="es0">\"</span>&gt;"</span>$TempStr$<span class="st0">"&lt;/a&gt;"</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> PackageLink = TempStr;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">MapRequired</span><span class="br0">(</span> TempStr <span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="st0">"&lt;font color=<span class="es0">\"</span>red<span class="es0">\"</span>&gt;"</span>$RequiredText$<span class="st0">"&lt;/font&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> TempStr = AvailableText;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, PackageLink<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ImportRows = ImportRows $ WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Mutator Information</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, TableTitle<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; ImportRows += WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i &lt; CurS.<span class="me1">getMutatorLength</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ImportMutators.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>, CurS.<span class="me1">getMutator</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i &lt; ImportMutators.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getMutator</span><span class="br0">(</span> <span class="kw4">int</span><span class="br0">(</span>ImportMutators.<span class="me1">getItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span> <span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>j=<span class="nu0">0</span>;j&lt;CurS.<span class="me1">getDataLength</span><span class="br0">(</span><span class="br0">)</span>;j++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">getIDValue</span><span class="br0">(</span>j,MutatorName,Tmp<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Tmp ~= TempStr<span class="br0">)</span> <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutatorLocation = ProfileConn.<span class="me1">FindRemoteZipLocation</span><span class="br0">(</span>TempStr,ProfileConn.<span class="me1">ProfileServerAddress</span> $ ProfileConn.<span class="me1">RemoteProfilePath</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; PackageLink = StringIf<span class="br0">(</span>MutatorLocation&#160;!= <span class="st0">""</span>, <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$MutatorLocation$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_blank<span class="es0">\"</span>&gt;"</span>$MutatorName$<span class="st0">"&lt;/a&gt;"</span>, MutatorName<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = Stringif<span class="br0">(</span>CurS.<span class="me1">MutRequired</span><span class="br0">(</span>TempStr<span class="br0">)</span>, <span class="st0">"&lt;font color=<span class="es0">\"</span>red<span class="es0">\"</span>&gt;"</span>$RequiredText$<span class="st0">"&lt;/font&gt;"</span>, AvailableText<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, PackageLink<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ImportRows += WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// PlayInfo Information</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, TableTitle<span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; ImportRows += WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; ImportRows = ImportRows $<span class="st0">"&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span>$ GeneratePlayInfoRows<span class="br0">(</span>Req,Res,IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// Build Subst's</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, <span class="st0">"ImportRemoteProfile"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, ButtonApplyImportProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageCaption"</span>, LabelApplyImportProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; ImportProfileHTML = WebInclude<span class="br0">(</span>IncludeCaptionButton<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TableRows"</span>, ImportRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"LadderTable"</span>, WebInclude<span class="br0">(</span>IncludeTable<span class="br0">)</span> $ ImportProfileHTML<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Tmp = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span>, PageCaption<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderRules.<span class="me1">GetRemainingMatches</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0</span> &amp;&amp; Tmp == LadderRules.<span class="me1">Profiles</span><span class="br0">[</span>GetCurrentConfigIndex<span class="br0">(</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">ProfileName</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Tmp = Tmp @ LabelNumberMatchesLeft @ <span class="kw4">string</span><span class="br0">(</span>LadderRules.<span class="me1">GetRemainingMatches</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Section"</span>, LinkImportProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SubTitle"</span>, Tmp<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageHelp"</span>, HelpImportProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PostAction"</span>, SubImportURI$<span class="st0">"?SessionID="</span>$CurS.<span class="me1">getHash</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; ShowPage<span class="br0">(</span>Res, MasterPage<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CleanupQuery<span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> QuerySubExport<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i,j;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> PlayInfo &#160;TempPI;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> FileLog &#160; EProfile;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session &#160; CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> &#160; &#160;SID, Logname,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr, Tmp,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; dataname, datavalue,</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileIndex, NewGameType,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ExportRows, Location;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;GameInfo&gt; &#160; &#160; &#160; &#160; &#160; GIClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;AccessControl&gt; &#160; &#160; &#160;ACClass;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Mutator&gt;&#160; &#160; &#160; &#160; &#160; &#160; TempMut;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;class&lt;Mutator&gt; &gt; MClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Info&gt;&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempSA;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;class&lt;Info&gt; &gt;&#160; &#160; &#160; &#160;SAClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> StringArray Mutators,GroupsOnly;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Lm"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>SID,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileIndex = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"ProfileNameSelect"</span>, CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileIndex"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CreateSessionInfo<span class="br0">(</span>ProfileIndex,SID,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Logname = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"Logname"</span>,Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"TextInput"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Logname == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Logname = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"Logname"</span>,Logname,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getMutatorLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getMutator</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>EpicPackage<span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">continue</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"Save"</span>$TempStr,<span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SetLocation<span class="br0">(</span>TempStr,Req.<span class="me1">GetVariable</span><span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getMapLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getMap</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>EpicPackage<span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">continue</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"Save"</span>$TempStr,<span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SetLocation<span class="br0">(</span>TempStr,Req.<span class="me1">GetVariable</span><span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewGameType = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>NewGameType&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GIClass = class&lt;GameInfo&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>NewGameType,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>GIClass==<span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorGameClassTitle,ErrorGameClassText<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ACClass"</span>, <span class="kw8">Level</span>.<span class="me1">Game</span>.<span class="me1">AccessControlClass</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ACClass = class&lt;AccessControl&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ACClass == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res,ErrorAccessControlTitle,ErrorAccessControlText<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"Export"</span>,<span class="st0">""</span><span class="br0">)</span>!=<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Write file locations to .ini</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EProfile = <span class="kw8">Level</span>.<span class="me1">Spawn</span><span class="br0">(</span><span class="kw5">class</span><span class="st0">'FileLog'</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>EProfile == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res, ErrorText, ErrorExportingProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EProfile.<span class="me1">OpenLog</span><span class="br0">(</span>RemoveStr<span class="br0">(</span>CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"Logname"</span><span class="br0">)</span>,<span class="st0">" "</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EProfile.<span class="me1">Logf</span><span class="br0">(</span><span class="st0">"Profile:"</span>$CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span><span class="br0">)</span>$Chr<span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span>$CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span>$Chr<span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span>$CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"MaxMaps"</span><span class="br0">)</span>$Chr<span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span>$GIClass.<span class="kw1">default</span>.<span class="me1">GameName</span>$Chr<span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span>$string<span class="br0">(</span>ACClass<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getMapLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getMap</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>TempStr,<span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Location = <span class="kw7">Chr</span><span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span> $ Req.<span class="me1">GetVariable</span><span class="br0">(</span>TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> Location = <span class="st0">""</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EProfile.<span class="me1">Logf</span><span class="br0">(</span><span class="st0">"Map:"</span>$TempStr$Chr<span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span>$CurS.<span class="me1">MapOrder</span><span class="br0">(</span>i<span class="br0">)</span>$Chr<span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span>$CurS.<span class="me1">MapRequired</span><span class="br0">(</span>TempStr<span class="br0">)</span>$Location<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getSALength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getServerActor</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>j=<span class="nu0">0</span>;j&lt;ConfigM.<span class="me1">ManagedActors</span>.<span class="kw6">Length</span>;j++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SAClass</span><span class="br0">)</span> ~= TempStr<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; DataName = ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SAName</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>TempStr,<span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Location = <span class="kw7">Chr</span><span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span> $ Req.<span class="me1">GetVariable</span><span class="br0">(</span>TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> Location = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EProfile.<span class="me1">Logf</span><span class="br0">(</span><span class="st0">"Mutator:"</span>$DataName$Chr<span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span>$TempStr$Chr<span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span>$CurS.<span class="me1">SARequired</span><span class="br0">(</span>TempStr<span class="br0">)</span>$Location<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getMutatorLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getMutator</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>j=<span class="nu0">0</span>;j&lt;AllMutators.<span class="kw6">Length</span>;j++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span> == TempStr<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; DataName = AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">FriendlyName</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>TempStr,<span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Location = <span class="kw7">Chr</span><span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span> $ Req.<span class="me1">GetVariable</span><span class="br0">(</span>TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> Location = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EProfile.<span class="me1">Logf</span><span class="br0">(</span><span class="st0">"Mutator:"</span>$DataName$Chr<span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span>$TempStr$Chr<span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span>$CurS.<span class="me1">MutRequired</span><span class="br0">(</span>TempStr<span class="br0">)</span>$Location<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; i=<span class="nu0">0</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j=<span class="nu0">0</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">while</span> <span class="br0">(</span>i&lt;CurS.<span class="me1">getDataLength</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">getIdValue</span><span class="br0">(</span>i,dataname,datavalue<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span><span class="kw7">InStr</span><span class="br0">(</span>dataname,<span class="st0">"."</span><span class="br0">)</span>&#160;!= <span class="nu0">-1</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EProfile.<span class="me1">Logf</span><span class="br0">(</span><span class="st0">"Data:"</span>$DataName$Chr<span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span>$DataValue<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; i++;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EProfile.<span class="me1">Destroy</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res, SuccessText, SuccessExportProfile$RemoveStr<span class="br0">(</span>LogName,<span class="st0">" "</span><span class="br0">)</span>$<span class="st0">".txt"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Mutator Section</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GroupsOnly = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getMutatorLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getMutator</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>j=<span class="nu0">0</span>;j&lt;AllMutators.<span class="kw6">Length</span>;j++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr ~= AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>j<span class="br0">)</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">FriendlyName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempMut = class&lt;Mutator&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempMut&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MClass<span class="br0">[</span>MClass.<span class="kw6">Length</span><span class="br0">]</span> = TempMut;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, TableTitle<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ExportRows += WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i&lt;Mutators.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = <span class="kw4">int</span><span class="br0">(</span>Mutators.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">FriendlyName</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>EpicPackage<span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, Textbox<span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span>,<span class="kw7">Min</span><span class="br0">(</span><span class="kw7">Max</span><span class="br0">(</span>GetLongestURL<span class="br0">(</span><span class="br0">)</span>,<span class="nu0">16</span><span class="br0">)</span>,<span class="nu0">64</span><span class="br0">)</span>,<span class="nu0">128</span>,GetLocation<span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span><span class="br0">)</span> $ <span class="st0">"&amp;nbsp;&amp;nbsp;"</span> $ SubmitButton<span class="br0">(</span><span class="st0">"Save"</span>$AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span>,ProfileButtonName<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ExportRows += WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getSALength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getServerActor</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempSA = class&lt;Info&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempSA&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SAClass<span class="br0">[</span>SAClass.<span class="kw6">Length</span><span class="br0">]</span> = TempSA;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPI = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'PlayInfo'</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; LoadThisPlayInfo<span class="br0">(</span>TempPI, GIClass, ACClass, MClass, SAClass<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, TableTitle<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ExportRows += WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, LabelMaxMaps<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"MaxMaps"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr == <span class="st0">"0"</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = UnlimitedText;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>, <span class="st0">"&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;&amp;nbsp;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ExportRows += WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Map Section</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getMapLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getMap</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>EpicPackage<span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, Textbox<span class="br0">(</span>TempStr,<span class="kw7">Min</span><span class="br0">(</span><span class="kw7">Max</span><span class="br0">(</span>GetLongestURL<span class="br0">(</span><span class="br0">)</span>,<span class="nu0">16</span><span class="br0">)</span>,<span class="nu0">64</span><span class="br0">)</span>,<span class="nu0">128</span>,GetLocation<span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span> $ <span class="st0">"&amp;nbsp;&amp;nbsp;"</span> $ SubmitButton<span class="br0">(</span><span class="st0">"Save"</span>$TempStr,ProfileButtonName<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ExportRows += WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// PlayInfo section</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, TableTitle<span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ExportRows += WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ExportRows += <span class="br0">(</span><span class="st0">"&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span> $ GeneratePlayInfoRows<span class="br0">(</span>Req, Res, IncludeRows<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ExportRows += <span class="br0">(</span><span class="st0">"&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;"</span>$LabelApplyExportProfile$<span class="st0">"&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;"</span>$SubmitButton<span class="br0">(</span><span class="st0">"Export"</span>,ButtonApplyExportProfile<span class="br0">)</span>$<span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TableRows"</span>, ExportRows<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"LadderTable"</span>, WebInclude<span class="br0">(</span>IncludeTable<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Tmp = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span>, PageCaption<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderRules.<span class="me1">GetRemainingMatches</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0</span> &amp;&amp; Tmp == LadderRules.<span class="me1">Profiles</span><span class="br0">[</span>GetCurrentConfigIndex<span class="br0">(</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">ProfileName</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Tmp = Tmp @ LabelNumberMatchesLeft @ <span class="kw4">string</span><span class="br0">(</span>LadderRules.<span class="me1">GetRemainingMatches</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Section"</span>, LinkExportProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageHelp"</span>, HelpExportProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SubTitle"</span>, Tmp<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PostAction"</span>, SubExportURI$<span class="st0">"?SessionID="</span>$SID<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowPage<span class="br0">(</span>Res, MasterPage<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> AccessDenied<span class="br0">(</span>Res<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//****************************************************************</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//****************************************************************</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Query subpages for Add &amp; Manage Modules</span></div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//</span></div>
</li>
<li class="li2">
<div class="de2"><span class="co1">//</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Page 0</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> QueryLadderManage<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> &#160; &#160;HeaderRows, ManagementRows,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr, Tmp, SID;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">bool</span>&#160; &#160; &#160; &#160; &#160; &#160; &#160; bAdd, bModify, bCopy, bDelete, bImport, bExport;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session &#160; CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> ProfileImporter ProfileConn;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Lm"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>SID, <span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Submit button was pressed</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>ProfileButtonName<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>, <span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">switch</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"Actions"</span>,<span class="st0">""</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">case</span> <span class="st0">"Add"</span>:</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bAdd = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; QuerySubFrame<span class="br0">(</span>Req, Res<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">case</span> <span class="st0">"Modify"</span>:</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bModify = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"ProfileNameSelect"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; StatusError<span class="br0">(</span>Res, ErrorNoProfilesExist<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; QuerySubFrame<span class="br0">(</span>Req, Res<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">case</span> <span class="st0">"Copy"</span>:</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bCopy = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Tmp = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"ProfileNameSelect"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Tmp == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; StatusError<span class="br0">(</span>Res, ErrorNoProfilesExist<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"TextInput"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; StatusError<span class="br0">(</span>Res, ErrorCopyNoName<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderRules.<span class="me1">CopyProfile</span><span class="br0">(</span><span class="kw4">int</span><span class="br0">(</span>Tmp<span class="br0">)</span>,TempStr<span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; StatusOK<span class="br0">(</span>Res,SuccessCopyProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> StatusError<span class="br0">(</span>Res, ErrorCopyFrom<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">case</span> <span class="st0">"Delete"</span>:</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bDelete = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"ProfileNameSelect"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderRules.<span class="me1">RemoveProfile</span><span class="br0">(</span><span class="kw4">int</span><span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; StatusOK<span class="br0">(</span>Res, SuccessDeleteProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> StatusError<span class="br0">(</span>Res, ErrorDeletingProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> StatusError<span class="br0">(</span>Res, ErrorNoProfilesExist<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">case</span> <span class="st0">"Import"</span>:</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bImport = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"TextInput"</span>,<span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!<span class="br0">(</span><span class="kw7">Left</span><span class="br0">(</span>TempStr,<span class="nu0">7</span><span class="br0">)</span> ~= <span class="st0">"http://"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; StatusError<span class="br0">(</span>Res, ErrorBadURL<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Spawn class to handle network interaction to receive remote profile</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileConn = <span class="kw8">Level</span>.<span class="me1">Spawn</span><span class="br0">(</span><span class="kw5">Class</span><span class="st0">'ProfileImporter'</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">If</span> <span class="br0">(</span>ProfileConn == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res, ErrorText, ImportClassSpawnError<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Assign local connection objects to importer class</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileConn.<span class="me1">QueryPage</span> = <span class="kw8">Self</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileConn.<span class="me1">QueryRequest</span> = Req;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileConn.<span class="me1">QueryResponse</span> = Res;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Setting bDelayCleanup prevents the connection from being closed</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// when QueryProfileImport() returns to Query()</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Set this prior to initializing connection, to ensure correct behavior</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Connection</span>.<span class="me1">bDelayCleanup</span> = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Initialize connection to foreign host, pass Importer class a Session</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// object to allow it to build a profile config set.</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ProfileConn.<span class="me1">Connect</span><span class="br0">(</span>TempStr, CurS<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">case</span> <span class="st0">"Export"</span>:</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bExport = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"ProfileNameSelect"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; StatusError<span class="br0">(</span>Res, ErrorNoProfilesExist<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; QuerySubExport<span class="br0">(</span>Req,Res<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">default</span>:</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bModify = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="co1">// Output code -</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// TODO: move to .inc file</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; HeaderRows = <span class="st0">"&lt;tr&gt;&lt;td nowrap&gt;"</span>$LabelChooseAction$<span class="st0">"&lt;/td&gt;&lt;td nowrap&gt;"</span>$LabelInputDescription$<span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; ManagementRows += <span class="br0">(</span><span class="st0">"&lt;tr&gt;&lt;td nowrap&gt;"</span>$RadioButton<span class="br0">(</span><span class="st0">"Actions"</span>, <span class="st0">"Add"</span>, bAdd<span class="br0">)</span>$LabelAddProfile$<span class="st0">"&lt;br&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ManagementRows += <span class="br0">(</span>RadioButton<span class="br0">(</span><span class="st0">"Actions"</span>, <span class="st0">"Modify"</span>, bModify<span class="br0">)</span>$LabelModifyProfile$<span class="st0">"&lt;/td&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ManagementRows += <span class="br0">(</span><span class="st0">"&lt;td&gt;&lt;select class=mini name='ProfileNameSelect'&gt;"</span>$GenerateSwitchProfileOptions<span class="br0">(</span>TempStr<span class="br0">)</span>$<span class="st0">"&lt;/select&gt;&amp;nbsp;"</span>$LabelSelectActions$<span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ManagementRows += <span class="br0">(</span><span class="st0">"&lt;tr&gt;&lt;td nowrap&gt;"</span>$RadioButton<span class="br0">(</span><span class="st0">"Actions"</span>, <span class="st0">"Copy"</span>, bCopy<span class="br0">)</span>$LabelCopyProfile$<span class="st0">"&lt;br&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ManagementRows += <span class="br0">(</span>RadioButton<span class="br0">(</span><span class="st0">"Actions"</span>, <span class="st0">"Delete"</span>, bDelete<span class="br0">)</span>$LabelDeleteProfile$<span class="st0">"&lt;/td&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ManagementRows += <span class="br0">(</span><span class="st0">"&lt;td nowrap&gt;"</span>$Textbox<span class="br0">(</span><span class="st0">"TextInput"</span>,<span class="nu0">64</span>,<span class="nu0">128</span><span class="br0">)</span>$<span class="st0">"&amp;nbsp;"</span>$LabelTextboxActions$<span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ManagementRows += <span class="br0">(</span><span class="st0">"&lt;tr&gt;&lt;td nowrap&gt;"</span>$RadioButton<span class="br0">(</span><span class="st0">"Actions"</span>, <span class="st0">"Import"</span>, bImport<span class="br0">)</span>$LabelImportProfile$<span class="st0">"&lt;br&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ManagementRows += <span class="br0">(</span>RadioButton<span class="br0">(</span><span class="st0">"Actions"</span>, <span class="st0">"Export"</span>, bExport<span class="br0">)</span>$LabelExportProfile$<span class="st0">"&lt;/td&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ManagementRows += <span class="br0">(</span><span class="st0">"&lt;td&gt;"</span>$SubmitButton<span class="br0">(</span>ProfileButtonName<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>,ProfileButtonValue<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span>$<span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TableTitle"</span>, TableTitle<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"HeaderRow"</span>, HeaderRows<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TableRows"</span>,ManagementRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Tmp = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span>, PageCaption<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderRules.<span class="me1">GetRemainingMatches</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0</span> &amp;&amp; Tmp == LadderRules.<span class="me1">Profiles</span><span class="br0">[</span>GetCurrentConfigIndex<span class="br0">(</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">ProfileName</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Tmp @= <span class="br0">(</span>LabelNumberMatchesLeft @ <span class="kw4">string</span><span class="br0">(</span>LadderRules.<span class="me1">GetRemainingMatches</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Section"</span>, LabelManagement<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageHelp"</span>, HelpManageProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SubTitle"</span>, Tmp<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"LadderTable"</span>, WebInclude<span class="br0">(</span>IncludeTable<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PostAction"</span>, ProfileManageURI<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowPage<span class="br0">(</span>Res, MasterPage<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> AccessDenied<span class="br0">(</span>Res<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Page 1</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> QuerySubGameType<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> DataName, DataValue, SID, NewName, OldName;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> GameTypeRows, OldGameType, CommandLineRows;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> GameTypeTable, CommandLineTable, ApplyTable;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session CurS;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> LadderProfiles LadderMaster;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Lm"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>SID, <span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>,<span class="st0">""</span><span class="br0">)</span>,<span class="st0">""</span><span class="br0">)</span>!=<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewName = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"NewProfile"</span>,DefaultProfileName<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; OldName = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span><span class="br0">(</span>OldName&#160;!= <span class="st0">""</span> &amp;&amp;&#160;!<span class="br0">(</span>OldName ~= NewName<span class="br0">)</span><span class="br0">)</span> || OldName == <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;LadderRules.<span class="me1">Profiles</span>.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>NewName ~= LadderRules.<span class="me1">Profiles</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ProfileName</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; StatusError<span class="br0">(</span>Res, ErrorSameProfileName<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; NewName = DefaultProfileName;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span>, NewName, <span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"GameType"</span>, Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"NewGameType"</span><span class="br0">)</span>, <span class="kw9">True</span>, OldGameType<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!<span class="br0">(</span>OldGameType ~= CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">ClearMaps</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Reset all stored PlayInfo information</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getDataLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">getIDValue</span><span class="br0">(</span>i,DataName,DataValue<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span><span class="kw7">InStr</span><span class="br0">(</span>DataName, <span class="st0">"."</span><span class="br0">)</span>&#160;!= <span class="nu0">-1</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">delValue</span><span class="br0">(</span>DataName<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; i--;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"NewProfileName"</span>, CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span>, DefaultProfileName<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GameTypeRows = WebInclude<span class="br0">(</span>IncludeProfileName<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;AGameType.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"GameTypeClass"</span>, &#160; &#160; &#160;AGameType.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"GameTypeName"</span>, &#160; &#160; &#160; AGameType.<span class="me1">GetTag</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Selected"</span>, &#160; &#160; &#160; &#160; &#160; StringIf<span class="br0">(</span>CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span> ~= AGameType.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span>, <span class="st0">" checked"</span>, <span class="st0">""</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GameTypeRows += WebInclude<span class="br0">(</span>IncludeGameType<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Fill in caption table values</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageCaption"</span>, &#160; &#160; &#160; &#160;CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"PageCaption"</span>, PageCaption<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, &#160; &#160; &#160; &#160; CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, ProfileButtonName<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, &#160; &#160; &#160; &#160;CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, ProfileButtonValue<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TableRows"</span>, &#160;&#160; &#160; &#160; &#160; GameTypeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"LadderTable"</span>, &#160; &#160; &#160; &#160;WebInclude<span class="br0">(</span>IncludeTable<span class="br0">)</span>$WebInclude<span class="br0">(</span>IncludeCaptionButton<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PostAction"</span>, &#160; &#160; &#160; &#160; CurS.<span class="me1">GetValue</span><span class="br0">(</span><span class="st0">"CurrentPage"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowPage<span class="br0">(</span>Res, SubFrameContent<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> AccessDenied<span class="br0">(</span>Res<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Page 2</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> QuerySubMutators<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i,j;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">bool</span> &#160; &#160; &#160;&#160; &#160; &#160; &#160; bAllMuts,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bClearMuts,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bChecked;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> &#160; &#160;MutatorRows,</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SID, TempStr;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> StringArray Mutators, ServerActors;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Mutator&gt; MutClass;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Lm"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>SID, <span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>,<span class="st0">""</span><span class="br0">)</span>,<span class="st0">""</span><span class="br0">)</span>!=<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bAllMuts = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"AllowAllMutators"</span><span class="br0">)</span>!=<span class="st0">""</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bClearMuts = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"ClearAllMutators"</span><span class="br0">)</span>!=<span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.ClearMutators();</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;ConfigM.<span class="me1">ManagedActors</span>.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="kw4">string</span><span class="br0">(</span>ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SAClass</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>bAllMuts || <span class="br0">(</span>!bClearMuts &amp;&amp; Req.<span class="me1">GetVariable</span><span class="br0">(</span>TempStr,<span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setServerActor</span><span class="br0">(</span>TempStr, <span class="kw9">True</span>, CurS.<span class="me1">SARequired</span><span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> CurS.<span class="me1">delServerActor</span><span class="br0">(</span>TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;AllMutators.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>bAllMuts || <span class="br0">(</span>!bClearMuts &amp;&amp; <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span>,<span class="st0">""</span><span class="br0">)</span>!=<span class="st0">""</span> || Req.<span class="me1">GetVariable</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">GroupName</span><span class="br0">)</span>~=AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setMutator</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span>,<span class="kw9">true</span>,CurS.<span class="me1">MutRequired</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">GroupName</span><span class="br0">)</span> ~= <span class="st0">"None"</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setMutator</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">GroupName</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">delMutator</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">delMutator</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">GroupName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ServerActors = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">//&#160; &#160; &#160; &#160; &#160; &#160; &#160; GroupsOnly = new(None) class'SortedStringArray';</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i&lt;AllMutators.<span class="kw6">Length</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutClass = class&lt;Mutator&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span>, <span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>MutClass&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>,AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">FriendlyName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;ConfigM.<span class="me1">ManagedActors</span>.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SAClass</span>&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ServerActors.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>,ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SAName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Uncomment this to allow mutators to be grouped according to MutatorGroup</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">/*</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CreateFullMutatorList(Mutators,GroupsOnly);</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; for (i=0;i&lt;CurS.GetMutatorLength();i++)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; {</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; k = 0-1;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; for (j=0;j&lt;AllMutators.Length;j++)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (CurS.GetMutator(i) ~= AllMutators[j].ClassName)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; break;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (j&lt;AllMutators.Length) k = GroupsOnly.FindItemId(string(j));</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (k &gt;= 0)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; {</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; for (z=0;z&lt;TempA.Length;z++)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; {</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (TempA[z] ~= AllMutators[j].GroupName)</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; {</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bAllMuts = True;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; break;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; }</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; }</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (!bAllMuts) TempA[TempA.Length] = AllMutators[j].GroupName;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; }</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (bAllMuts)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160;&#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; break;</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; }</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; lastgroup = "";</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; thisgroup = "";</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; nextgroup = "";</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutatorRows="";</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; for (i=0;i&lt;GroupsOnly.Count();i++)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; {</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j=int(GroupsOnly.GetItem(i));</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (AllMutators[j].GroupName=="")</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; thisgroup="Z"$string(z++);</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; else thisgroup = AllMutators[j].GroupName;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if ( (i + 1) == GroupsOnly.Count())</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; nextgroup = "";</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; else</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; {</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; // Assign nextgroup to the next mutators group</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; k = int(GroupsOnly.GetItem(i + 1));</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (AllMutators[k].GroupName=="")</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; nextgroup="Z"$string(z);</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; else nextgroup = AllMutators[k].GroupName;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; }</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.Subst("GroupName", thisgroup);</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.Subst("MutatorClass", AllMutators[j].ClassName);</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.Subst("MutatorName", AllMutators[j].FriendlyName);</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.Subst("MutatorDesc", AllMutators[j].Description);</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if ((lastgroup&#160;!= thisgroup) &amp;&amp; (thisgroup == nextgroup)) // and the next mut is in the same group as this one</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; {</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (bAllMuts||CurS.HasMutator(thisgroup)) Res.Subst("Checked", "checked");</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutatorRows = MutatorRows$WebInclude("current_mutators_group");</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; }</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; else</span></div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; {</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; if (CurS.HasMutator(AllMutators[j].ClassName) &amp;&amp;&#160;!bAllMuts) Res.Subst("Checked", "checked"); else Res.Subst("Checked", "");</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutatorRows = MutatorRows$WebInclude("current_mutators_group_row");</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; }</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; lastgroup=thisgroup;</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; }</span></div>
</li>
<li class="li1">
<div class="de1"><span class="coMULTI">*/</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bAllMuts = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i&lt;ServerActors.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="st0">""</span>; bChecked = <span class="kw9">False</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = <span class="kw4">int</span><span class="br0">(</span>ServerActors.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">HasServerActor</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SAClass</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bChecked = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>bAllMuts<span class="br0">)</span> bAllMuts = <span class="kw9">False</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, Checkbox<span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SAClass</span><span class="br0">)</span>,bChecked<span class="br0">)</span> $ <span class="st0">"&amp;nbsp;"</span> $ ServerActors.<span class="me1">GetTag</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = WebInclude<span class="br0">(</span>NowrapLeft<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SADescription</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, TempStr $ WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutatorRows += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i&lt;Mutators.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="st0">""</span>; bChecked = <span class="kw9">False</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = <span class="kw4">int</span><span class="br0">(</span>Mutators.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">HasMutator</span><span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bChecked = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>bAllMuts<span class="br0">)</span> bAllMuts = <span class="kw9">False</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, CheckBox<span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span>, bChecked<span class="br0">)</span> $ <span class="st0">"&amp;nbsp;"</span> $ AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">FriendlyName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = WebInclude<span class="br0">(</span>NowrapLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Description</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, TempStr $ WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutatorRows += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>bAllMuts<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, Checkbox<span class="br0">(</span><span class="st0">"ClearAllMutators"</span>, <span class="kw9">False</span><span class="br0">)</span>@LabelUncheckAllMutator<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, Checkbox<span class="br0">(</span><span class="st0">"AllowAllMutators"</span>, <span class="kw9">False</span><span class="br0">)</span>@LabelCheckAllMutator<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpanLength"</span>, <span class="st0">"2"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpanContent"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, WebInclude<span class="br0">(</span>CellColSpan<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutatorRows += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutatorRows += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TableRows"</span>, MutatorRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Fill in caption table values</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageCaption"</span>, &#160; &#160; &#160; &#160;CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"PageCaption"</span>, PageCaption<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, &#160; &#160; &#160; &#160; CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, ProfileButtonName<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, &#160; &#160; &#160; &#160;CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, ProfileButtonValue<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"LadderTable"</span>, &#160; &#160; &#160; &#160;WebInclude<span class="br0">(</span>IncludeTable<span class="br0">)</span>$WebInclude<span class="br0">(</span>IncludeCaptionButton<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PostAction"</span>, &#160; &#160; &#160; &#160; CurS.<span class="me1">GetValue</span><span class="br0">(</span><span class="st0">"CurrentPage"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowPage<span class="br0">(</span>Res, SubFrameContent<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> AccessDenied<span class="br0">(</span>Res<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Page3</span></div>
</li>
<li class="li2">
<div class="de2"><span class="kw5">function</span> QuerySubMaps<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> &#160; &#160;SID,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MapRows,</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr, Temp,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CheckString;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">bool</span> &#160; &#160; &#160;&#160; &#160; &#160; &#160; bAllMaps,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bClearMaps,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bChecked;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> StringArray SortedMaps;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;string&gt; TempMaps;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;GameInfo&gt; GIClass;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Lm"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>SID<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GIClass = class&lt;GameInfo&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>GIClass == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowFramedMessage<span class="br0">(</span>Res,ErrorGameClassText,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Build a string array of maps valid for this gametype.</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GIClass.<span class="kw6">static</span>.<span class="me1">LoadMapList</span><span class="br0">(</span>GIClass.<span class="kw1">default</span>.<span class="me1">MapPrefix</span>, TempMaps<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>,<span class="st0">""</span><span class="br0">)</span>,<span class="st0">""</span><span class="br0">)</span>!=<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bAllMaps = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"AllowAllMaps"</span>,<span class="st0">""</span><span class="br0">)</span>!=<span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bClearMaps = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"ClearAllMaps"</span>,<span class="st0">""</span><span class="br0">)</span>!=<span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;TempMaps.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>bAllMaps || <span class="br0">(</span>!bClearMaps &amp;&amp; Req.<span class="me1">GetVariable</span><span class="br0">(</span>TempMaps<span class="br0">[</span>i<span class="br0">]</span><span class="br0">)</span>!=<span class="st0">""</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setMap</span><span class="br0">(</span>TempMaps<span class="br0">[</span>i<span class="br0">]</span>,<span class="nu0">0</span>,<span class="kw9">True</span>,CurS.<span class="me1">MapRequired</span><span class="br0">(</span>TempMaps<span class="br0">[</span>i<span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> CurS.<span class="me1">delMap</span><span class="br0">(</span>TempMaps<span class="br0">[</span>i<span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Add the map name array to a sorted string array for sorting</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SortedMaps = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span><span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;TempMaps.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SortedMaps.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>,TempMaps<span class="br0">[</span>i<span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bAllMaps = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Now build the map rows</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;SortedMaps.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Temp = <span class="st0">""</span>; bChecked = <span class="kw9">False</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = SortedMaps.<span class="me1">GetTag</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">HasMap</span><span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bChecked = <span class="kw9">True</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>bAllMaps<span class="br0">)</span> bAllMaps = <span class="kw9">False</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, Checkbox<span class="br0">(</span>TempStr, bChecked<span class="br0">)</span> $ <span class="st0">"&amp;nbsp;"</span> $ TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Build string for javascript function</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CheckString!=<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CheckString += <span class="st0">"','"</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CheckString += TempStr;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MapRows += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Fill Javascript substs</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"JavaScripts"</span>,<span class="st0">"&lt;script language=<span class="es0">\"</span>JavaScript<span class="es0">\"</span> type=<span class="es0">\"</span>text/JavaScript<span class="es0">\"</span>&gt;function MM_findObj(n,d){var p,i,x;if(!d)d=document;if((p=n.indexOf(<span class="es0">\"</span>?<span class="es0">\"</span>))&gt;0&amp;&amp;parent.frames.length){d=parent.frames[n.substring(p+1)].document;n=n.substring(0,p);}if(!(x=d[n])&amp;&amp;d.all)x=d.all[n];for(i=0;!x&amp;&amp;i&lt;d.forms.length;i++)x=d.forms[i][n];for(i=0;!x&amp;&amp;d.layers&amp;&amp;i&lt;d.layers.length;i++)x=MM_findObj(n,d.layers[i].document);if(!x&amp;&amp;d.getElementById)x=d.getElementById(n);return x;}function CheckMaps(){var maps=CheckMaps.arguments;var MapChecked=false;for(var i=0;i&lt;maps.length;i++){var myObj=MM_findObj(maps[i]);if(myObj.checked==true){MapChecked=true}}if(MapChecked==false){alert('You must check at least one map to continue!')}document.MM_returnValue=(MapChecked);}&lt;/script&gt;"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"JCheck"</span>,<span class="st0">" onClick=<span class="es0">\"</span>CheckMaps('AllowAllMaps','"</span>$CheckString$<span class="st0">"');return document.MM_returnValue<span class="es0">\"</span>"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Checked"</span>,<span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>bAllMaps<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, Checkbox<span class="br0">(</span><span class="st0">"ClearAllMaps"</span>, <span class="kw9">False</span><span class="br0">)</span> @ LabelUncheckAllMap<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, Checkbox<span class="br0">(</span><span class="st0">"AllowAllMaps"</span>, <span class="kw9">False</span><span class="br0">)</span> @ LabelCheckAllMap<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpanLength"</span>, <span class="st0">"2"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpanContent"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, WebInclude<span class="br0">(</span>CellColSpan<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MapRows += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MapRows += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Set ladder_caption_table subst's</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageCaption"</span>, &#160; &#160; &#160; &#160;CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"PageCaption"</span>,PageCaption<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, &#160; &#160; &#160; &#160; CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, ProfileButtonName<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, &#160; &#160; &#160; &#160;CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, ProfileButtonValue<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TableRows"</span>, MapRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"LadderTable"</span>, &#160; &#160; &#160; &#160;WebInclude<span class="br0">(</span>IncludeTable<span class="br0">)</span>$WebInclude<span class="br0">(</span>IncludeCaptionButton<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PostAction"</span>, &#160; &#160; &#160; &#160; CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"CurrentPage"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowPage<span class="br0">(</span>Res, SubFrameContent<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> AccessDenied<span class="br0">(</span>Res<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2"><span class="co1">// Page 4</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> QuerySubRules<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> &#160; &#160;TempStr,</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SID;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session &#160; CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> PlayInfo &#160;TempPI;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Mutator&gt; &#160; &#160;&#160; &#160; &#160; &#160; TempClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;GameInfo&gt; &#160; &#160; &#160; &#160; &#160; GIClass;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;AccessControl&gt; &#160; &#160; &#160;ACClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;class&lt;Mutator&gt; &gt; MClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Info&gt;&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempSA;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;class&lt;Info&gt; &gt;&#160; &#160; &#160; &#160;SAClass;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Lm"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">GetSession</span><span class="br0">(</span>SID<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GIClass = class&lt;GameInfo&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>GIClass == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowFramedMessage<span class="br0">(</span>Res,ErrorGameClassText,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ACClass"</span>, <span class="kw8">Level</span>.<span class="me1">Game</span>.<span class="me1">AccessControlClass</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ACClass = class&lt;AccessControl&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ACClass == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowFramedMessage<span class="br0">(</span>Res,ErrorAccessControlText,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>,<span class="st0">""</span><span class="br0">)</span>,<span class="st0">""</span><span class="br0">)</span>!=<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">GetMutatorLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getMutator</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempClass = class&lt;Mutator&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempClass&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MClass<span class="br0">[</span>MClass.<span class="kw6">Length</span><span class="br0">]</span> = TempClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPI = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'PlayInfo'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">getSALength</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getServerActor</span><span class="br0">(</span>i<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempSA = class&lt;Info&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempSA&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SAClass<span class="br0">[</span>SAClass.<span class="kw6">Length</span><span class="br0">]</span> = TempSA;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; LoadThisPlayInfo<span class="br0">(</span>TempPI, GIClass, ACClass, MClass, SAClass<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;TempPI.<span class="me1">Settings</span>.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!SettingIsAllowed<span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SecLevel</span><span class="br0">)</span><span class="br0">)</span> <span class="kw1">continue</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = Req.<span class="me1">GetVariable</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span>,TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">Value</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">RenderType</span> == <span class="st0">"Text"</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CheckSettingValue<span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">Data</span>, TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span>,TempStr,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TableRows"</span>,&#160; &#160; &#160; &#160; &#160; GeneratePlayInfoRows<span class="br0">(</span>Req, Res, <span class="st0">"defaults_row"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Set ladder_caption_table subst's</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageCaption"</span>, &#160; &#160; &#160; &#160;CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"PageCaption"</span>,PageCaption<span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, &#160; &#160; &#160; &#160; CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, ProfileButtonName<span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, &#160; &#160; &#160; &#160;CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, ProfileButtonValue<span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"LadderTable"</span>, &#160; &#160; &#160; &#160;WebInclude<span class="br0">(</span>IncludeTable<span class="br0">)</span>$WebInclude<span class="br0">(</span>IncludeCaptionButton<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PostAction"</span>, &#160; &#160; &#160; &#160; CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"CurrentPage"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowPage<span class="br0">(</span>Res, SubFrameContent<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> AccessDenied<span class="br0">(</span>Res<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Page 5</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> QuerySubReview<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i,j,k,z;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> &#160; &#160;SID,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr, TempSA,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewRows,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; thisgroup, lastgroup, nextgroup;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> StringArray Mutators, GroupsOnly;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Mutator&gt; &#160; &#160;&#160; &#160; &#160; &#160; TempClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Info&gt;&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempSAClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;GameInfo&gt; &#160; &#160; &#160; &#160; &#160; GIClass;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;AccessControl&gt; &#160; &#160; &#160;ACClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;class&lt;Mutator&gt; &gt; MClass;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Lm"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>SID<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GIClass = class&lt;GameInfo&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>GIClass == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowFramedMessage<span class="br0">(</span>Res,ErrorGameClassText,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ACClass"</span>,<span class="kw8">Level</span>.<span class="me1">Game</span>.<span class="me1">AccessControlClass</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ACClass = class&lt;AccessControl&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ACClass == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowFramedMessage<span class="br0">(</span>Res,ErrorAccessControlText,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GroupsOnly = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'SortedStringArray'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i&lt;AllMutators.<span class="kw6">Length</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">HasMutator</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span>||CurS.<span class="me1">HasMutator</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">GroupName</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempClass = class&lt;Mutator&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span>, <span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempClass&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MClass<span class="br0">[</span>MClass.<span class="kw6">Length</span><span class="br0">]</span> = TempClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>,AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">FriendlyName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CreateFullMutatorList<span class="br0">(</span>Mutators,GroupsOnly<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; lastgroup = <span class="st0">""</span>; thisgroup = <span class="st0">""</span>; nextgroup = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, TableTitle<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, LabelRequiredMutators<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewRows += WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;GroupsOnly.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j=<span class="kw4">int</span><span class="br0">(</span>GroupsOnly.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">GroupName</span>==<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; thisgroup=<span class="st0">"Z"</span>$string<span class="br0">(</span>z++<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> thisgroup = AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">GroupName</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span> <span class="br0">(</span>i + <span class="nu0">1</span><span class="br0">)</span> == GroupsOnly.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; nextgroup = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// Assign nextgroup to the next mutators group</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; k = <span class="kw4">int</span><span class="br0">(</span>GroupsOnly.<span class="me1">GetItem</span><span class="br0">(</span>i + <span class="nu0">1</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>AllMutators<span class="br0">[</span>k<span class="br0">]</span>.<span class="me1">GroupName</span>==<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; nextgroup=<span class="st0">"Z"</span>$string<span class="br0">(</span>z<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> nextgroup = AllMutators<span class="br0">[</span>k<span class="br0">]</span>.<span class="me1">GroupName</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"GroupName"</span>, thisgroup<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"MutatorClass"</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"MutatorName"</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">FriendlyName</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"MutatorDesc"</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Description</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span><span class="br0">(</span>lastgroup&#160;!= thisgroup<span class="br0">)</span> &amp;&amp; <span class="br0">(</span>thisgroup == nextgroup<span class="br0">)</span><span class="br0">)</span> <span class="co1">// and the next mut is in the same group as this one</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Checked"</span>, <span class="st0">" checked"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewRows += WebInclude<span class="br0">(</span><span class="st0">"current_mutators_group"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Checked"</span>, StringIf<span class="br0">(</span>CurS.<span class="me1">MutRequired</span><span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span>, <span class="st0">" checked"</span>, <span class="st0">""</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewRows += WebInclude<span class="br0">(</span><span class="st0">"current_mutators_group_row"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; lastgroup=thisgroup;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i&lt;Mutators.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>; i++<span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = <span class="kw4">int</span><span class="br0">(</span>Mutators.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, CheckBox<span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span>, CurS.<span class="me1">MutRequired</span><span class="br0">(</span>AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span><span class="br0">)</span> $ <span class="st0">"&amp;nbsp;"</span> $ AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">FriendlyName</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = WebInclude<span class="br0">(</span>NowrapLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, AllMutators<span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">Description</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, TempStr $ WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewRows += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators.<span class="me1">Reset</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i &lt; ConfigM.<span class="me1">ManagedActors</span>.<span class="kw6">Length</span>; i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempSA = <span class="kw4">string</span><span class="br0">(</span>ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SAClass</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">HasServerActor</span><span class="br0">(</span>TempSA<span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempSAClass = class&lt;Info&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempSA,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempSAClass&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Mutators.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>i<span class="br0">)</span>,ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SAName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; lastgroup = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpanLength"</span>, <span class="st0">"2"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpanContent"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, WebInclude<span class="br0">(</span>CellColSpan<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; lastgroup = WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewRows += lastgroup;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;Mutators.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="st0">""</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; j = <span class="kw4">int</span><span class="br0">(</span>Mutators.<span class="me1">GetItem</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, Checkbox<span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SAClass</span><span class="br0">)</span>, CurS.<span class="me1">SARequired</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SAClass</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> $ <span class="st0">"&amp;nbsp;"</span> $ Mutators.<span class="me1">GetTag</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = WebInclude<span class="br0">(</span>NowrapLeft<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Content"</span>, ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>j<span class="br0">]</span>.<span class="me1">SADescription</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"RowContent"</span>, TempStr $ WebInclude<span class="br0">(</span>CellLeft<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewRows += WebInclude<span class="br0">(</span>RowLeft<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, TableTitle<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, LabelRequiredMaps<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewRows += WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, LabelMaxMaps<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, Textbox<span class="br0">(</span><span class="st0">"MaxMaps"</span>, <span class="nu0">3</span>, <span class="nu0">3</span>, CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"MaxMaps"</span>,<span class="st0">"3"</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>, lastgroup<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewRows += WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;CurS.<span class="me1">GetMapLength</span><span class="br0">(</span><span class="br0">)</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingName"</span>, CurS.<span class="me1">getMap</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>, <span class="st0">""</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SettingData"</span>, Checkbox<span class="br0">(</span>CurS.<span class="me1">getMap</span><span class="br0">(</span>i<span class="br0">)</span>, CurS.<span class="me1">MapRequired</span><span class="br0">(</span>CurS.<span class="me1">getMap</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewRows += WebInclude<span class="br0">(</span>IncludeRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SectionName"</span>, TableTitle<span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SpecialInstructions"</span>, LabelPlayInfo<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"Extra"</span>, lastgroup<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewRows += WebInclude<span class="br0">(</span>IncludeSection<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ReviewRows += <span class="br0">(</span>lastgroup $ GeneratePlayInfoRows<span class="br0">(</span>Req, Res, IncludeRows<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"TableRows"</span>, ReviewRows<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="co1">// Set ladder_caption_table subst's</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PageCaption"</span>, &#160; &#160; &#160; &#160;CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"PageCaption"</span>,PageCaption<span class="br0">[</span><span class="nu0">5</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, &#160; &#160; &#160; &#160; CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonName"</span>, ProfileButtonName<span class="br0">[</span><span class="nu0">5</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, &#160; &#160; &#160; &#160;CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ButtonValue"</span>, ProfileButtonValue<span class="br0">[</span><span class="nu0">5</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"LadderTable"</span>, &#160; &#160; &#160; &#160;WebInclude<span class="br0">(</span>IncludeTable<span class="br0">)</span>$WebInclude<span class="br0">(</span>IncludeCaptionButton<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"PostAction"</span>, &#160; &#160; &#160; &#160; SubSavedURI$<span class="st0">"?SessionID="</span>$SID<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"NewTarget"</span>,&#160; &#160; &#160; &#160; &#160; <span class="st0">" target=<span class="es0">\"</span>_parent<span class="es0">\"</span>"</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowPage<span class="br0">(</span>Res, SubFrameContent<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> AccessDenied<span class="br0">(</span>Res<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="co1">// Page 6</span></div>
</li>
<li class="li1">
<div class="de1"><span class="kw5">function</span> QuerySubSaved<span class="br0">(</span>WebRequest Req, WebResponse Res<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">int</span> i,k, x;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> <span class="kw4">string</span> &#160; &#160;SID,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; tmp, tmp1,</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> Session &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> PlayInfo &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPI;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> ProfileConfigSet &#160;&#160; &#160; &#160; &#160; TempPCS;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;string&gt; &#160; &#160; &#160; &#160; &#160; &#160; TempArr;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;class&lt;Mutator&gt; &gt; MClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> array&lt;class&lt;Info&gt; &gt;&#160; &#160; &#160; &#160;SAClass;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Mutator&gt; &#160; &#160;&#160; &#160; &#160; &#160; MutClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;GameInfo&gt; &#160; &#160; &#160; &#160; &#160; GIClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;AccessControl&gt; &#160; &#160; &#160;ACClass;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw5">local</span> class&lt;Info&gt;&#160; &#160; &#160; &#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempSA;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; SID = Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"SessionID"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; CurS = SMaster.<span class="me1">getSession</span><span class="br0">(</span>SID<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CanPerform<span class="br0">(</span><span class="st0">"Lm"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GIClass = class&lt;GameInfo&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>GIClass == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowFramedMessage<span class="br0">(</span>Res,ErrorGameClassText,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ACClass"</span>,<span class="kw8">Level</span>.<span class="me1">Game</span>.<span class="me1">AccessControlClass</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempStr&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ACClass = class&lt;AccessControl&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>TempStr,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>ACClass == <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowFramedMessage<span class="br0">(</span>Res,ErrorAccessControlText,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPI = <span class="kw6">new</span><span class="br0">(</span><span class="kw9">None</span><span class="br0">)</span> <span class="kw5">class</span><span class="st0">'PlayInfo'</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="co1">// We are managing an existing profile</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">hasData</span><span class="br0">(</span><span class="st0">"ProfileIndex"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; k = <span class="kw4">int</span><span class="br0">(</span>CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileIndex"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; TempPCS = LadderRules.<span class="me1">LadderProfiles</span><span class="br0">[</span>k<span class="br0">]</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderRules.<span class="me1">Profiles</span><span class="br0">[</span>k<span class="br0">]</span>.<span class="me1">ProfileName</span>&#160;!= CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; LadderRules.<span class="me1">Profiles</span><span class="br0">[</span>k<span class="br0">]</span>.<span class="me1">ProfileName</span> = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; LadderRules.<span class="me1">AllLadderProfiles</span>.<span class="kw6">Remove</span><span class="br0">(</span>LadderRules.<span class="me1">AllLadderProfiles</span>.<span class="me1">FindItemId</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>k<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; LadderRules.<span class="me1">AllLadderProfiles</span>.<span class="me1">Add</span><span class="br0">(</span><span class="kw4">string</span><span class="br0">(</span>k<span class="br0">)</span>,LadderRules.<span class="me1">Profiles</span><span class="br0">[</span>k<span class="br0">]</span>.<span class="me1">ProfileName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; LadderRules.<span class="kw7">SaveConfig</span><span class="br0">(</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempPCS.<span class="me1">StartEdit</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">SetGameType</span><span class="br0">(</span>CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">EndEdit</span><span class="br0">(</span><span class="kw9">False</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> TempPCS = LadderRules.<span class="me1">AddProfile</span><span class="br0">(</span>CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span><span class="br0">)</span>, CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"GameType"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempPCS.<span class="me1">StartEdit</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;AllMutators.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MutClass = class&lt;Mutator&gt;<span class="br0">(</span><span class="kw7">DynamicLoadObject</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span>,<span class="kw5">class</span><span class="st0">'Class'</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>MutClass&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span><span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span>,<span class="st0">""</span><span class="br0">)</span>!=<span class="st0">""</span><span class="br0">)</span>||<span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">GroupName</span>,<span class="st0">""</span><span class="br0">)</span>~=AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setMutator</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span>,<span class="kw9">true</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> CurS.<span class="me1">setMutator</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span>,<span class="kw9">false</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">HasMutator</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MClass<span class="br0">[</span>MClass.<span class="kw6">Length</span><span class="br0">]</span> = MutClass;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">AddProfileMutator</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span>,CurS.<span class="me1">MutRequired</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> TempPCS.<span class="me1">DelProfileMutator</span><span class="br0">(</span>AllMutators<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">ClassName</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;ConfigM.<span class="me1">ManagedActors</span>.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempSA = ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SAClass</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempSA&#160;!= <span class="kw9">None</span><span class="br0">)</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempStr = <span class="kw4">string</span><span class="br0">(</span>ConfigM.<span class="me1">ManagedActors</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SAClass</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>TempStr,<span class="st0">""</span><span class="br0">)</span>&#160;!= <span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setServerActor</span><span class="br0">(</span>TempStr, <span class="kw9">True</span>, <span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> CurS.<span class="me1">setServerActor</span><span class="br0">(</span>TempStr, <span class="kw9">False</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">HasServerActor</span><span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SAClass<span class="br0">[</span>SAClass.<span class="kw6">Length</span><span class="br0">]</span> = TempSA;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">AddProfileServerActor</span><span class="br0">(</span>TempStr,CurS.<span class="me1">SARequired</span><span class="br0">(</span>TempStr<span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> TempPCS.<span class="me1">DelProfileServerActor</span><span class="br0">(</span>TempStr<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; x = LoadThisPlayInfo<span class="br0">(</span>TempPI, GIClass, ACClass, MClass, SAClass<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>x &gt;= <span class="nu0">0</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowFramedMessage<span class="br0">(</span>Res, ErrorLoadingPlayInfoText<span class="br0">[</span>x<span class="br0">]</span>,<span class="kw9">True</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setValue</span><span class="br0">(</span><span class="st0">"MaxMaps"</span>,Req.<span class="me1">GetVariable</span><span class="br0">(</span><span class="st0">"MaxMaps"</span><span class="br0">)</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">MaxMaps</span> = <span class="kw4">int</span><span class="br0">(</span>CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"MaxMaps"</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; GIClass.<span class="kw6">static</span>.<span class="me1">LoadMapList</span><span class="br0">(</span>GIClass.<span class="kw1">default</span>.<span class="me1">MapPrefix</span>, TempArr<span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;TempArr.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>Req.<span class="me1">GetVariable</span><span class="br0">(</span>TempArr<span class="br0">[</span>i<span class="br0">]</span>,<span class="st0">""</span><span class="br0">)</span>!=<span class="st0">""</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CurS.<span class="me1">setMap</span><span class="br0">(</span>TempArr<span class="br0">[</span>i<span class="br0">]</span>,<span class="nu0">0</span>,<span class="kw9">true</span>,<span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> CurS.<span class="me1">setMap</span><span class="br0">(</span>TempArr<span class="br0">[</span>i<span class="br0">]</span>,<span class="nu0">0</span>,<span class="kw9">false</span>,<span class="kw9">false</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">HasMap</span><span class="br0">(</span>TempArr<span class="br0">[</span>i<span class="br0">]</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">AddProfileMap</span><span class="br0">(</span>TempArr<span class="br0">[</span>i<span class="br0">]</span>, CurS.<span class="me1">MapRequired</span><span class="br0">(</span>TempArr<span class="br0">[</span>i<span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span> TempPCS.<span class="me1">DelProfileMap</span><span class="br0">(</span>TempArr<span class="br0">[</span>i<span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">for</span> <span class="br0">(</span>i=<span class="nu0">0</span>;i&lt;TempPI.<span class="me1">Settings</span>.<span class="kw6">Length</span>;i++<span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SecLevel</span> &gt; CurAdmin.<span class="me1">MaxSecLevel</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="kw1">continue</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; tmp = <span class="st0">""</span>; tmp1=<span class="st0">""</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>CurS.<span class="me1">getIdValue</span><span class="br0">(</span>i,tmp,tmp1<span class="br0">)</span> == <span class="nu0">-1</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">break</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>!TempPCS.<span class="me1">SetProfileNamedParam</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span>, CurS.<span class="me1">getValue</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span>,TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">Value</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">SetProfileParam</span><span class="br0">(</span>TempPCS.<span class="me1">Count</span><span class="br0">(</span><span class="br0">)</span>,TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span>,CurS.<span class="me1">getValue</span><span class="br0">(</span>TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">SettingName</span>,TempPI.<span class="me1">Settings</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">Value</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; TempPCS.<span class="me1">EndEdit</span><span class="br0">(</span><span class="kw9">true</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">else</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; StatusError<span class="br0">(</span>Res,ErrorSavingProfile<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; QuerySubReview<span class="br0">(</span>Req, Res<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Tmp = CurS.<span class="me1">getValue</span><span class="br0">(</span><span class="st0">"ProfileName"</span>, PageCaption<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">if</span> <span class="br0">(</span>LadderRules.<span class="me1">GetRemainingMatches</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0</span> &amp;&amp; Tmp == LadderRules.<span class="me1">Profiles</span><span class="br0">[</span>GetCurrentConfigIndex<span class="br0">(</span><span class="br0">)</span><span class="br0">]</span>.<span class="me1">ProfileName</span><span class="br0">)</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Tmp = Tmp @ LabelNumberMatchesLeft @ <span class="kw4">string</span><span class="br0">(</span>LadderRules.<span class="me1">GetRemainingMatches</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Res.<span class="me1">Subst</span><span class="br0">(</span><span class="st0">"SubTitle"</span>, Tmp<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ShowMessage<span class="br0">(</span>Res, TableTitle<span class="br0">[</span><span class="nu0">6</span><span class="br0">]</span>, PageCaption<span class="br0">[</span><span class="nu0">6</span><span class="br0">]</span><span class="br0">)</span>;</div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; <span class="kw1">return</span>;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="br0">}</span></div>
</li>
<li class="li1">
<div class="de1">&#160;</div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160; &#160; <span class="kw1">else</span> AccessDenied<span class="br0">(</span>Res<span class="br0">)</span>;</div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
<li class="li2">
<div class="de2">&#160;</div>
</li>
<li class="li1">
<div class="de1"><span class="kw1">defaultproperties</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">{</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"BR-Anubis"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"BR-Bifrost"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"BR-Disclosure"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"BR-IceFields"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span>=<span class="st0">"BR-Skyline"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">5</span><span class="br0">)</span>=<span class="st0">"BR-Slaughterhouse"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">6</span><span class="br0">)</span>=<span class="st0">"BR-TwinTombs"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">7</span><span class="br0">)</span>=<span class="st0">"CTF-Chrome"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">8</span><span class="br0">)</span>=<span class="st0">"CTF-Citadel"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">9</span><span class="br0">)</span>=<span class="st0">"CTF-December"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">10</span><span class="br0">)</span>=<span class="st0">"CTF-Face3"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">11</span><span class="br0">)</span>=<span class="st0">"CTF-Geothermal"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">12</span><span class="br0">)</span>=<span class="st0">"CTF-Lostfaith"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">13</span><span class="br0">)</span>=<span class="st0">"CTF-Magma"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">14</span><span class="br0">)</span>=<span class="st0">"CTF-Maul"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">15</span><span class="br0">)</span>=<span class="st0">"CTF-Orbital2"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">16</span><span class="br0">)</span>=<span class="st0">"DM-Antalus"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">17</span><span class="br0">)</span>=<span class="st0">"DM-Asbestos"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">18</span><span class="br0">)</span>=<span class="st0">"DM-Compressed"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">19</span><span class="br0">)</span>=<span class="st0">"DM-Curse3"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">20</span><span class="br0">)</span>=<span class="st0">"DM-Flux2"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">21</span><span class="br0">)</span>=<span class="st0">"DM-Gael"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">22</span><span class="br0">)</span>=<span class="st0">"DM-Inferno"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">23</span><span class="br0">)</span>=<span class="st0">"DM-Insidious"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">24</span><span class="br0">)</span>=<span class="st0">"DM-Leviathan"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">25</span><span class="br0">)</span>=<span class="st0">"DM-Oceanic"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">26</span><span class="br0">)</span>=<span class="st0">"DM-Phobos2"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">27</span><span class="br0">)</span>=<span class="st0">"DM-Plunge"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">28</span><span class="br0">)</span>=<span class="st0">"DM-Serpentine"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">29</span><span class="br0">)</span>=<span class="st0">"DM-TokaraForest"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">30</span><span class="br0">)</span>=<span class="st0">"DM-TrainingDay"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">31</span><span class="br0">)</span>=<span class="st0">"DOM-Core"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">32</span><span class="br0">)</span>=<span class="st0">"DOM-OutRigger"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">33</span><span class="br0">)</span>=<span class="st0">"DOM-Ruination"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">34</span><span class="br0">)</span>=<span class="st0">"DOM-ScorchedEarth"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">35</span><span class="br0">)</span>=<span class="st0">"DOM-SepukkuGorge"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">36</span><span class="br0">)</span>=<span class="st0">"DOM-Suntemple"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">37</span><span class="br0">)</span>=<span class="st0">"Entry"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">38</span><span class="br0">)</span>=<span class="st0">"NvidiaLogo"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">39</span><span class="br0">)</span>=<span class="st0">"TUT-BR"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">40</span><span class="br0">)</span>=<span class="st0">"TUT-CTF"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">41</span><span class="br0">)</span>=<span class="st0">"TUT-DM"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">42</span><span class="br0">)</span>=<span class="st0">"TUT-DOM"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">43</span><span class="br0">)</span>=<span class="st0">"UT2-intro"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">44</span><span class="br0">)</span>=<span class="st0">"VehicleDemo"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">45</span><span class="br0">)</span>=<span class="st0">"endgame"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">46</span><span class="br0">)</span>=<span class="st0">"Core"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">47</span><span class="br0">)</span>=<span class="st0">"Editor"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">48</span><span class="br0">)</span>=<span class="st0">"Engine"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">49</span><span class="br0">)</span>=<span class="st0">"Fire"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">50</span><span class="br0">)</span>=<span class="st0">"GamePlay"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">51</span><span class="br0">)</span>=<span class="st0">"IpDrv"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">52</span><span class="br0">)</span>=<span class="st0">"UWeb"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">53</span><span class="br0">)</span>=<span class="st0">"UnrealEd"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">54</span><span class="br0">)</span>=<span class="st0">"UnrealGame"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">55</span><span class="br0">)</span>=<span class="st0">"Vehicles"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">56</span><span class="br0">)</span>=<span class="st0">"XAdmin"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">57</span><span class="br0">)</span>=<span class="st0">"XEffects"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">58</span><span class="br0">)</span>=<span class="st0">"XGame"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">59</span><span class="br0">)</span>=<span class="st0">"XGame_rc"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">60</span><span class="br0">)</span>=<span class="st0">"XInterface"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">61</span><span class="br0">)</span>=<span class="st0">"XPickups"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">62</span><span class="br0">)</span>=<span class="st0">"XPickups_rc"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">63</span><span class="br0">)</span>=<span class="st0">"XWeapons"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">64</span><span class="br0">)</span>=<span class="st0">"XWeapons_rc"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">65</span><span class="br0">)</span>=<span class="st0">"XWebAdmin"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">66</span><span class="br0">)</span>=<span class="st0">"BR-DE-ElecFields"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">67</span><span class="br0">)</span>=<span class="st0">"CTF-DE-ElecFields"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">68</span><span class="br0">)</span>=<span class="st0">"CTF-DE-LavaGiant2"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">69</span><span class="br0">)</span>=<span class="st0">"DM-DE-Grendelkeep"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">70</span><span class="br0">)</span>=<span class="st0">"DM-DE-Ironic"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">71</span><span class="br0">)</span>=<span class="st0">"DM-DE-Osiris2"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">72</span><span class="br0">)</span>=<span class="st0">"BR-Canyon"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">73</span><span class="br0">)</span>=<span class="st0">"CTF-Avaris"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">74</span><span class="br0">)</span>=<span class="st0">"DM-1on1-Crash"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">75</span><span class="br0">)</span>=<span class="st0">"DM-1on1-Mixer"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">76</span><span class="br0">)</span>=<span class="st0">"DM-Icetomb"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">77</span><span class="br0">)</span>=<span class="st0">"DM-Injector"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">78</span><span class="br0">)</span>=<span class="st0">"DM-IronDeity"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">79</span><span class="br0">)</span>=<span class="st0">"DM-Rustatorium"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">80</span><span class="br0">)</span>=<span class="st0">"DOM-Junkyard"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">81</span><span class="br0">)</span>=<span class="st0">"SkaarjPack"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">82</span><span class="br0">)</span>=<span class="st0">"SkaarjPack_rc"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">83</span><span class="br0">)</span>=<span class="st0">"BonusPack"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;EpicPackages<span class="br0">(</span><span class="nu0">84</span><span class="br0">)</span>=<span class="st0">"OGGPlayer"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;MasterPage=<span class="st0">"ladder"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SubFrame=<span class="st0">"ladder_frame"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;SubFrameMenu=<span class="st0">"ladder_frame1"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SubFrameContent=<span class="st0">"ladder_frame2"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;IncludeTable=<span class="st0">"ladder_table"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;IncludeSection=<span class="st0">"ladder_section"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;IncludeRows=<span class="st0">"ladder_rows"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;IncludeCaptionButton=<span class="st0">"ladder_caption"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;IncludeMapSelect=<span class="st0">"ladder_mapselect"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;IncludeProfileName=<span class="st0">"ladder_name"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;IncludeGameType=<span class="st0">"ladder_gametype"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;IncludeCheckBox=<span class="st0">"ladder_checkrow"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;IncludeSwitch=<span class="st0">"ladder_switch"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileViewURI=<span class="st0">"ladder_view"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileEditURI=<span class="st0">"ladder_edit"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileMenuURI=<span class="st0">"ladder_menu"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileSwitchURI=<span class="st0">"ladder_switch"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;ProfileManageURI=<span class="st0">"ladder_manage"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SubFrameURI=<span class="st0">"profile_management"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SubFrameMenuURI=<span class="st0">"management_menu"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SubMapsURI=<span class="st0">"ladder_maps"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SubSavedURI=<span class="st0">"ladder_save"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;SubRulesURI=<span class="st0">"ladder_rules"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SubReviewURI=<span class="st0">"ladder_review"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SubGametypeURI=<span class="st0">"management_game_type"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SubMutatorsURI=<span class="st0">"ladder_mutators"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SubImportURI=<span class="st0">"profile_import"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;SubExportURI=<span class="st0">"profile_export"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LinkEditProfile=<span class="st0">"Edit Profiles"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LinkViewProfile=<span class="st0">"View Profiles"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LinkSwitchProfile=<span class="st0">"Switch Profiles"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LinkManageProfile=<span class="st0">"Manage Profiles"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;LinkImportProfile=<span class="st0">"Import Profile"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LinkExportProfile=<span class="st0">"Export Profile"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;TableTitle<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Profile Management Portal"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;TableTitle<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Profile GameType"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;TableTitle<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Profile Mutators"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;TableTitle<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Profile Maps"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;TableTitle<span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span>=<span class="st0">"Profile Settings"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;TableTitle<span class="br0">(</span><span class="nu0">5</span><span class="br0">)</span>=<span class="st0">"Review Profile"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;TableTitle<span class="br0">(</span><span class="nu0">6</span><span class="br0">)</span>=<span class="st0">"Profile Saved"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;PageCaption<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"No Profile Loaded"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;PageCaption<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Select the gametype that will be associated with this profile."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;PageCaption<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Select the mutators that will be available in this profile."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;PageCaption<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Select the maps that will be available in this profile."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;PageCaption<span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span>=<span class="st0">"Select the settings that will be associated with this profile."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;PageCaption<span class="br0">(</span><span class="nu0">5</span><span class="br0">)</span>=<span class="st0">"Review all settings for accuracy before saving to file."</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;PageCaption<span class="br0">(</span><span class="nu0">6</span><span class="br0">)</span>=<span class="st0">"Settings were saved successfully!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileButtonName<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Save Location"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileButtonName<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"GameType"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileButtonName<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Mutators"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileButtonName<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Maps"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;ProfileButtonName<span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span>=<span class="st0">"Rules"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileButtonName<span class="br0">(</span><span class="nu0">5</span><span class="br0">)</span>=<span class="st0">"Review"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileButtonName<span class="br0">(</span><span class="nu0">6</span><span class="br0">)</span>=<span class="st0">"Saved"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileButtonValue<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Proceed"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileButtonValue<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Set GameType"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;ProfileButtonValue<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Set Mutators"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileButtonValue<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Set Maps"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileButtonValue<span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span>=<span class="st0">"Set Rules"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileButtonValue<span class="br0">(</span><span class="nu0">5</span><span class="br0">)</span>=<span class="st0">"Save Profile"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ProfileButtonValue<span class="br0">(</span><span class="nu0">6</span><span class="br0">)</span>=<span class="st0">"Profile Saved"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;MapText=<span class="st0">"Maps"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorText=<span class="st0">"Error"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;MutatorText=<span class="st0">"Mutators"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;RequiredText=<span class="st0">"Required"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;AvailableText=<span class="st0">"Available"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;UnlimitedText=<span class="st0">"Unlimited"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;FollowingMaps=<span class="st0">"The following maps"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;AreAssignedText=<span class="st0">"are assigned to this profile and cannot be removed."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;AreAvailableText=<span class="st0">"may be added to this profile."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;FollowingMutators=<span class="st0">"The following mutators"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;CommandLineOptionsTitle=<span class="st0">"Command Line Options"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ButtonLoadProfile=<span class="st0">"Load Profile"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ButtonDeleteProfile=<span class="st0">"Delete Profile"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ButtonPreviewProfile=<span class="st0">"Load Profile"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ButtonApplyImportProfile=<span class="st0">"Import Profile"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;ButtonApplyExportProfile=<span class="st0">"Export Profile"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ButtonApplyProfileChanges=<span class="st0">"Apply Profile Changes"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelCopyProfile=<span class="st0">"Copy Profile"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelDeleteProfile=<span class="st0">"Delete Profile"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelImportProfile=<span class="st0">"Import Profile"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;LabelExportProfile=<span class="st0">"Export Profile"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelAddProfile=<span class="st0">"Add Profile"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelSelectActions=<span class="st0">"(Copy, Modify, Delete, Export)"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelTextboxActions=<span class="st0">"(Add, Copy, Import)"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelPlayInfo=<span class="st0">"Profile Game Parameters"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;LabelGeneralProfile=<span class="st0">"General Profile Information"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelGameType=<span class="st0">"Profile Game Type"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelProfileName=<span class="st0">"Profile Name"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelAccessControl=<span class="st0">"Profile Access Control"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelChooseAction=<span class="st0">"Choose action to perform:"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;LabelManagement=<span class="st0">"Profile Management"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelInputDescription=<span class="st0">"Actions which require input from this field are listed on the right."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelMaxMaps=<span class="st0">"Maximum maps allowed in this profile's maplist"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelNumberGames=<span class="st0">"Number of matches (0 = unlimited)"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelCheckAllMap=<span class="st0">"Select all maps"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;LabelRequiredMaps=<span class="st0">"Check each map that will be required (non-removable) for this profile."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelUncheckAllMap=<span class="st0">"Deselect all maps"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelChangeMaplist=<span class="st0">"Changes to the maplist are saved immediately."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelCheckAllMutator=<span class="st0">"Select all mutators"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelRequiredMutators=<span class="st0">"Check each mutator that will be required (non-removable) for this profile."</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;LabelNumberMatchesLeft=<span class="st0">"Matches Remaining:"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelUncheckAllMutator=<span class="st0">"Deselect all mutators"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelDelayProfileChange=<span class="st0">"Check to delay applying profile until end of current match."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelApplyImportProfile=<span class="st0">"Click Apply Import to make this profile available in your server's list of profiles."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;LabelApplyExportProfile=<span class="st0">"Click Apply Export to save this profile to a .txt file."</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;LabelModifyProfile=<span class="st0">"Modify Profile"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SuccessText=<span class="st0">"Success"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SuccessDeleteProfile=<span class="st0">"Profile successfully deleted! &#160;It will no longer appear in your list of available profiles."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SuccessExportProfile=<span class="st0">"Profile exported successfully! &#160;Exported profile has been saved to the server's System folder as "</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SuccessImportProfile=<span class="st0">"Profile imported successfully! The remote profile will now appear in your list of available profiles."</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;SuccessImportProfileTitle=<span class="st0">"Import Successful!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SuccessCopyProfile=<span class="st0">"Profile copied successfully! Copied profile will now be available in your list of available profiles."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;SuccessSwitchProfile=<span class="st0">"Profile successfully applied! Changes take effect at the end of the current match."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorLoadingPlayInfoText<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Error while loading playinfo. &#160;LoadThisPlayInfo() received bad playinfo object!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorLoadingPlayInfoText<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Error while loading playinfo. &#160;LoadThisPlayInfo() could not load incoming game class!"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;ErrorLoadingPlayInfoText<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Error while loading playinfo. &#160;LoadThisPlayInfo() could not load associated access control!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorLoadingPlayInfoText<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Error while loading playinfo. &#160;LoadThisPlayInfo() had exception while loading mutators!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorLoadingPlayInfoText<span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span>=<span class="st0">"Error while loading playinfo. &#160;LoadThisPlayInfo() had exception while loading server actors!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorGameClassText=<span class="st0">"No gametype was selected, or the files required by this gametype do not exist on this server."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorGameClassTitle=<span class="st0">"Invalid GameType"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;ErrorAccessControlText=<span class="st0">"Exception while loading access control. &#160;Please double check the AccessControlClass= line of the [Engine.GameInfo] section of your server's .ini file."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorAccessControlTitle=<span class="st0">"Invalid Access Control"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorSameProfileName=<span class="st0">"Another profile already exists with that name. Please select a different name!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorRemoteMutator=<span class="st0">"Error loading mutator from remote profile. Could not find mutator package:"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorRemoteServerActor=<span class="st0">"Error loading ServerActor from remote profile. &#160;Could not find ServerActor package:"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;ErrorSavingProfile=<span class="st0">"Exception while saving new profile! Please resubmit save request."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorDeletingProfile=<span class="st0">"Error deleting profile! &#160;Please check server log for details."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorExportingProfile=<span class="st0">"Error exporting profile! Export class could not be spawned!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorNoProfilesExist=<span class="st0">"No profiles exist! Could not perform selected action!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorCopyFrom=<span class="st0">"Error copying profile. &#160;No Profile Found!"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;ErrorCopyNoName=<span class="st0">"You must specify a unique name for the new profile!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorExcludeMapNotFound=<span class="st0">"Error! Exclude map not found:"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorIncludeMapNotFound=<span class="st0">"Error! Include map not found:"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorReplacingWebConnection=<span class="st0">"Exception replacing WebServer.AcceptClass! (Very bad) Please send an email to Evolution containing your server's ini and log files."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ImportClassSpawnError=<span class="st0">"Exception occured spawning connection class. &#160;Please try again!"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;ImportProfileFailText=<span class="st0">"Error while importing profile. &#160;Please ensure you have all the files necessary to load this remote profile."</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ImportProfileFailTitle=<span class="st0">"Import Failed!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorBind=<span class="st0">"Failed to bind port! Please try again!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorBadURL=<span class="st0">"URL must start with 'http://'&#160;!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorServer=<span class="st0">"Unspecified error while importing profile!"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;ErrorResolve=<span class="st0">"URL could not be resolved!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorProfile=<span class="st0">"Attempted to import a file that does not contain a profile!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorTimeout=<span class="st0">"Timed out while waiting for response from foreign host!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorNotFound=<span class="st0">"Profile does not exist on remote server!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorForbidden=<span class="st0">"Remote profile could not be imported: Forbidden"</span></div>
</li>
<li class="li2">
<div class="de2">&#160; &#160; &#160;ErrorBadRequest=<span class="st0">"Request could not be processed by remote server!"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;ErrorUnauthorized=<span class="st0">"Remote profile could not be imported: Unauthorized"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;DefaultPage=<span class="st0">"ladder_main"</span></div>
</li>
<li class="li1">
<div class="de1">&#160; &#160; &#160;Title=<span class="st0">"Ladder"</span></div>
</li>
<li class="li1">
<div class="de1"><span class="br0">}</span></div>
</li>
</ol>
</div>
</div>

<!-- 
NewPP limit report
Preprocessor node count: 10/1000000
Post-expand include size: 243/2097152 bytes
Template argument size: 187/2097152 bytes
#ifexist count: 0/100
-->
<div class="printfooter">
</div>
	    	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-legacy"
	       class="selected"	       ><a href="../../../../articles/l/a/d/Legacy%7ELadderQuery_df35.html">Legacy</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../../articles/l/a/d/Legacy_talk%7ELadderQuery_3320.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://wiki.beyondunreal.com/Legacy:LadderQuery">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../../misc/uewiki.png);"
	    href="../../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-mainpage"><a href="../../../../index.html">Main Page</a></li>
	     	      <li id="n-portal"><a href="../../../../articles/c/o/m/Unreal_Wiki%7ECommunity_Portal_3311.html">Community portal</a></li>
	     	      <li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt='Attribution-Noncommercial-Share Alike 3.0' /></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 23:31, 19 March 2003 by Anonymous user(s) of Unreal Wiki. </li>	  <li id="f-copyright">Licensed as <a href="../../../../articles/c/o/p/Unreal_Wiki%7ECopyrights_e561.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>	  <li id="f-about"><a href="../../../../articles/a/b/o/Unreal_Wiki%7EAbout_9ce6.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>	  <li id="f-disclaimer"><a href="../../../../articles/g/e/n/Unreal_Wiki%7EGeneral_disclaimer_a0a2.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
