<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- headlinks removed -->
	<link rel="shortcut icon" href="../../../../misc/uewiki-favicon.png"/>
    <title>Legacy:Wormbo/Developer Journal - Unreal Wiki</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../../skins/offline/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/md5.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/utf8.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/lookup.js"></script>
    <script type="text/javascript" src="../../../../articles/-/_/_/-.html"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../../articles/c/o/m/MediaWiki%7ECommon.css_d42e.html";
@import "../../../../articles/m/o/n/MediaWiki%7EMonobook.css_fb19.html";
@import "../../../../articles/-/_/_/-.html";
/*]]>*/</style>          </head>
  <body
    class="ns-100">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Legacy:Wormbo/Developer Journal</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</h3>
	    <div id="contentSub"><span class="subpages">&lt; <a href="../../../../articles/w/o/r/Legacy%7EWormbo_2470.html" title="Legacy:Wormbo">Legacy:Wormbo</a></span></div>
	    	    	    <!-- start content -->
	    <table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Reversed_CTF"><span class="tocnumber">1</span> <span class="toctext">Reversed CTF</span></a>
<ul>
<li class="toclevel-2"><a href="#How_Do_I_Start.3F"><span class="tocnumber">1.1</span> <span class="toctext">How Do I Start?</span></a>
<ul>
<li class="toclevel-3"><a href="#The_Rules"><span class="tocnumber">1.1.1</span> <span class="toctext">The Rules</span></a></li>
<li class="toclevel-3"><a href="#A_Look_At_Existing_Classes"><span class="tocnumber">1.1.2</span> <span class="toctext">A Look At Existing Classes</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#Starting_The_Real_Work"><span class="tocnumber">1.2</span> <span class="toctext">Starting The Real Work</span></a>
<ul>
<li class="toclevel-3"><a href="#Easy_Start"><span class="tocnumber">1.2.1</span> <span class="toctext">Easy Start</span></a></li>
<li class="toclevel-3"><a href="#Helpful_Tools"><span class="tocnumber">1.2.2</span> <span class="toctext">Helpful Tools</span></a></li>
<li class="toclevel-3"><a href="#Gameplay_and_Scoring"><span class="tocnumber">1.2.3</span> <span class="toctext">Gameplay and Scoring</span></a></li>
<li class="toclevel-3"><a href="#AI_.E2.86.92_Explaining_The_Rules_To_The_Bots"><span class="tocnumber">1.2.4</span> <span class="toctext">AI → Explaining The Rules To The Bots</span></a>
<ul>
<li class="toclevel-4"><a href="#The_First_Major_Bug.21_:.28"><span class="tocnumber">1.2.4.1</span> <span class="toctext">The First Major Bug!&#160;:(</span></a></li>
<li class="toclevel-4"><a href="#Back_To_AI"><span class="tocnumber">1.2.4.2</span> <span class="toctext">Back To AI</span></a></li>
<li class="toclevel-4"><a href="#Months_pass..."><span class="tocnumber">1.2.4.3</span> <span class="toctext">Months pass...</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1"><a href="#Comments"><span class="tocnumber">2</span> <span class="toctext">Comments</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Reversed_CTF" id="Reversed_CTF"></a></p>
<h2><span class="mw-headline"><a href="../../../../articles/m/o/d/Legacy%7EMod_Ideas_Reversed_CTF_873b.html" title="Legacy:Mod Ideas/Reversed CTF">Reversed CTF</a></span></h2>
<p><i>This mod started out quite nicely, but then came to halt due to a lack of interest in messing with bot AI and the existance of other, more interesting projects.</i></p>
<p>Status of this project: Canceled. You can get the unfinished but basically working mod without bot support from <a href="http://www.koehler-homepage.de/Wormbo/spareparts.html" class="external text" title="http://www.koehler-homepage.de/Wormbo/spareparts.html" rel="nofollow">my spare parts page</a>.</p>
<p><a name="How_Do_I_Start.3F" id="How_Do_I_Start.3F"></a></p>
<h3><span class="mw-headline">How Do I Start?</span></h3>
<p>I think this mod should be quite simple to do since it's only a small change. (I'll see about that after understanding the CTF code.)</p>
<p><a name="The_Rules" id="The_Rules"></a></p>
<h4><span class="mw-headline">The Rules</span></h4>
<p>The first step obviously is to specify the new gametype's rules:</p>
<ul>
<li>The gametype will use CTF maps.</li>
<li>Each team starts in its base. (the base with the flag of the same color)</li>
<li>Players can pick up and carry their team's flag.</li>
<li>Touching the enemy flag sends it back to its base.</li>
<li>Points are scored by a player who touches the enemy flag at its base while holding his/her team's flag.</li>
<li>The Translocator is enabled by default, but if a player translocates while carrying the flag causes him/her to drop the flag.</li>
</ul>
<p>I'll examine the relevant UScript classes now, before I start scripting at all. This will allow me to think up a possible class tree for the mod. (Which classes need to be subclassed at all and which classes can I extend from?)</p>
<p><a name="A_Look_At_Existing_Classes" id="A_Look_At_Existing_Classes"></a></p>
<h4><span class="mw-headline">A Look At Existing Classes</span></h4>
<p>The mod might be more difficult than I though in the first place. There are lots of classes for CTF and I'm sure most of them need to be subclassed.</p>
<p>Some Info subclasses:</p>
<dl>
<dt>GameInfo &gt;&gt; UnrealMPGameInfo &gt;&gt; DeathMatch &gt;&gt; TeamGame &gt;&gt; CTFGame &gt;&gt; xCTFGame&#160;</dt>
<dd>CTFGame obviously is the base class for CTF gametypes and xCTFGame is the gametype used in UT 2003. I'm not yet sure which of them should be subclassed.</dd>
<dt>TeamAI &gt;&gt; CTFTeamAI</dt>
<dt>ReplicationInfo &gt;&gt; SquadAI &gt;&gt; CTFSquadAI&#160;</dt>
<dd>I don't know, what exactly these are used for, but they seem to handle the bot AI. Need to look into those classes.</dd>
<dt>LocalMessage &gt;&gt; CTFHUDMessage</dt>
<dt>LocalMessage &gt;&gt; CriticalEventPlus &gt;&gt; CTFMessage&#160;</dt>
<dd>The message classes. CTFMessage is ok, but CTFHUDMessage needs to be subclassed.</dd>
</dl>
<p>Other <a href="../../../../articles/a/c/t/Legacy%7EActor_5985.html" title="Legacy:Actor">Actor</a> classes:</p>
<dl>
<dt>Decoration &gt;&gt; GameObject &gt;&gt; CTFFlag&#160;</dt>
<dd>The flag itself. Needs to be subclassed.</dd>
<dt>NavigationPoint &gt;&gt; JumpDest &gt;&gt; JumpSpot &gt;&gt; GameObjectives &gt;&gt; CTFBase&#160;</dt>
<dd>The flag base. I can't replace it because it's bNoDelete=True, but I'm sure I can handle all the important stuff from the flags. It's not bStatic, so I might be able to change the FlagType to my own CTFFlag subclass before the flags are spawned.</dd>
<dt>HUD &gt;&gt; HudBase &gt;&gt; HudBDeathMatch &gt;&gt; HudBTeamDeathMatch &gt;&gt; HudBCaptureTheFlag&#160;</dt>
<dd>The HUD class. I'm not sure whether I need to subclass it.</dd>
</dl>
<p><a name="Starting_The_Real_Work" id="Starting_The_Real_Work"></a></p>
<h3><span class="mw-headline">Starting The Real Work</span></h3>
<p><a name="Easy_Start" id="Easy_Start"></a></p>
<h4><span class="mw-headline">Easy Start</span></h4>
<p>I decided to subclass xCTFGame and not CTFGame and also found out that I need to subclass HudBCaptureTheFlag to replace the CTFHUDMessage with my own class.</p>
<p>Currently I have these:</p>
<dl>
<dt>ReversedCTFGame (extends xCTFGame)&#160;</dt>
<dd>The <a href="../../../../articles/g/a/m/Legacy%7EGameInfo_4922.html" title="Legacy:GameInfo">GameInfo</a> class. Currently only replaces the HUD.</dd>
<dt>HudReversedCTF (extends HudBCaptureTheFlag)&#160;</dt>
<dd>The HUD class. Currently only replaces the CTFHUDMessage.</dd>
<dt>ReversedCTFHUDMessage (extends CTFHUDMessage)&#160;</dt>
<dd>Displays the warn messages when a player of the enemy team or the local player has the flag.</dd>
<dt>ReversedCTF.int&#160;</dt>
<dd>Adds the new game type to the list of game types.</dd>
</dl>
<p>Up to this point I didn't have to do any real coding work: The GameInfo and the message class only change some default properties and the HUD class has two small changes in its <tt>Timer</tt> function. Tomorrow I'll start with the real work, i.e. the changes in the CTFFlag and CTFGame code to allow the flag's team to pick it up, score points, etc.</p>
<p><a name="Helpful_Tools" id="Helpful_Tools"></a></p>
<h4><span class="mw-headline">Helpful Tools</span></h4>
<p>Before continuing with the actual coding work I set up a batch file for recompiling the package:</p>
<p><b>UCCMakeReversedCTF.bat</b></p>
<pre>
@echo off
d:
cd\ut2003\system
:start
del reversedctf.u
ucc make
echo.
pause
goto start
</pre>
<p>This little script automatically deletes ReversedCTF.u and runs UCC Make to recompile it. It might be even better if I creaded a special INI file for UCC to use, but with only one project this almost seems too much work...</p>
<p>Hmm, gotta get used to the new look of the Make commandlet.&#160;:)</p>
<dl>
<dd><b>Mychaeel:</b> Note to self: I <i>need</i> to get (a new version of) UMake out to the public.</dd>
</dl>
<p><a name="Gameplay_and_Scoring" id="Gameplay_and_Scoring"></a></p>
<h4><span class="mw-headline">Gameplay and Scoring</span></h4>
<p>First I'm going to change what happens when a player touches a flag and how scored are awarded, i.e. which flag must be carried by whom. The ReversedCTFFlag script only contains this function:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">function</span> <span class="kw4">bool</span> SameTeam<span class="br0">(</span>Controller c<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">if</span> <span class="br0">(</span>c == <span class="kw9">None</span> || c.<span class="me1">PlayerReplicationInfo</span>.<span class="me1">Team</span> == Team<span class="br0">)</span> <span class="co1">// changed from "!= Team"</span>
        <span class="kw1">return</span> <span class="kw9">false</span>;
 
    <span class="kw1">return</span> <span class="kw9">true</span>;
<span class="br0">}</span>
</pre></div>
<p>This tiny change of a single character effectively switches around the teams from the flag's view. Now the blue flag can only be picked up by the blue team and will be returned to its (blue) base by the red team.</p>
<p>The scoring required a bit more work. Exactly two changes in the ScoreFlag function, to be precice:&#160;:rolleyes:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">function</span> ScoreFlag<span class="br0">(</span>Controller Scorer, CTFFlag theFlag<span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw5">local</span> <span class="kw4">float</span> Dist,oppDist;
        <span class="kw5">local</span> <span class="kw4">int</span> i;
        <span class="kw5">local</span> <span class="kw4">float</span> ppp,numtouch;
        <span class="kw5">local</span> <span class="kw4">vector</span> FlagLoc;
 
        <span class="kw1">if</span> <span class="br0">(</span> Scorer.<span class="me1">PlayerReplicationInfo</span>.<span class="me1">Team</span> != theFlag.<span class="me1">Team</span> <span class="br0">)</span> <span class="br0">{</span>     <span class="co1">// was "== theFlag.Team"</span>
                Scorer.<span class="me1">AwardAdrenaline</span><span class="br0">(</span>ADR_Return<span class="br0">)</span>;
                FlagLoc = TheFlag.<span class="me1">Position</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">Location</span>;
                Dist = vsize<span class="br0">(</span>FlagLoc - TheFlag.<span class="me1">HomeBase</span>.<span class="me1">Location</span><span class="br0">)</span>;
 
                <span class="kw1">if</span> <span class="br0">(</span> TheFlag.<span class="me1">TeamNum</span> != <span class="nu0">0</span> <span class="br0">)</span>   <span class="co1">// was "== 0"</span>
                        oppDist = vsize<span class="br0">(</span>FlagLoc - Teams<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span>.<span class="me1">HomeBase</span>.<span class="me1">Location</span><span class="br0">)</span>;
                <span class="kw1">else</span>
                        oppDist = vsize<span class="br0">(</span>FlagLoc - Teams<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>.<span class="me1">HomeBase</span>.<span class="me1">Location</span><span class="br0">)</span>; 
...
</pre></div>
<p>The gametype almost works as intended and could even be played online already. The only problem now is the AI: The bots gather around their team's flag carrier and keep saying "enemy flag carrier is here" while the bot that has the flag doesn't move at all.</p>
<p>This will be the next problem to solve.</p>
<p><a name="AI_.E2.86.92_Explaining_The_Rules_To_The_Bots" id="AI_.E2.86.92_Explaining_The_Rules_To_The_Bots"></a></p>
<h4><span class="mw-headline">AI → Explaining The Rules To The Bots</span></h4>
<p>AI is the most difficult part in creating a new gametype. (not counting tweaking and bug-fixing)</p>
<p>Luckily in <a href="../../../../articles/u/t/2/Legacy%7EUT2003_f97b.html" class="mw-redirect" title="Legacy:UT2003">UT2003</a> gametype-specific bot AI is stored in seperate classes: SquadAI and (for team games) TeamAI.</p>
<p>But first:</p>
<p><a name="The_First_Major_Bug.21_:.28" id="The_First_Major_Bug.21_:.28"></a></p>
<h5><span class="mw-headline">The First Major Bug!&#160;:(</span></h5>
<p>The flags are invisible while they are not at their bases.</p>
<p>It turned out that my class analysis was incomplete, the CTFFlag class has some subclasses:</p>
<p><b>CTFFlag &gt;&gt; xBlueFlag/xRedFlag</b></p>
<p>I copied the xRedFlag and xBlueFlag classes and made them subclasses of my ReversedCTFFlag class.</p>
<p><a name="Back_To_AI" id="Back_To_AI"></a></p>
<h5><span class="mw-headline">Back To AI</span></h5>
<p>I need to create completely new code for at least one of the larger CTFSquadAI functions. It might take some time to get the basic structure and I will do that on paper first.</p>
<p><a name="Months_pass..." id="Months_pass..."></a></p>
<h5><span class="mw-headline">Months pass...</span></h5>
<p>Meanwhile I switched from batch file compiling to <a href="../../../../articles/u/m/a/Legacy%7EUMake_c884.html" title="Legacy:UMake">UMake</a> and finished the Mercury Missile InstaGib mutator but instead of continuing with Reversed CTF I started playing Diablo 2 again – bad thing.&#160;:P</p>
<p>Reversed CTF is now in the "Overload v100 state", i.e. it works online perfectly and you could try to play it offline with bots, but don't expect too much from them. They just grab the flag and run towards the enemy base.</p>
<hr />
<p><a name="Comments" id="Comments"></a></p>
<h2><span class="mw-headline">Comments</span></h2>
<p><b>EntropicLqd:</b> Jolly good, it might be finished by the time I get back on-line.</p>
<p><b>Wormbo:</b> I didn't look at the details of the AI classes, but I guess in this case it will be mostly swapping EnemyFlag and FriendlyFlag or the teams.</p>
<p><b>Wormbo:</b> Urgh, I take back everything I said. This gametype requires a completely different strategy, since you have to prevent the enemies from breaking into <b>your</b> base instead of reaching their base after escaping from yours. I need to completely rewrite that part of the SquadAI class. Also I just noticed, why the flags are invisible when they are carried or otherwise not at their base: CTFFlag has two subclasses xRedFlag and xBlueFlag.&#160;:/</p>
<p><b>Wormbo:</b> Oh well, I'll have to take a break from this mod. Not because I needed it, but because I forgot to copy it to my notebook.&#160;:/ Actual coding work will be delayed till Monday, but in the meantime I could try to create the main structure for the bot behavior.</p>
<p><b>Aphelion:</b> Thought I'd wish you luck... Looks like you're going well...</p>
<p><b>Nuclear Fuzz Grunge:</b> This is an interesting exploratory type of tutorial. Perfect for Retro characters. Excellent. Complete clarity. An Exposition of Your Thinking Process. Thanks.</p>
<dl>
<dd>Weeks pass...</dd>
</dl>
<p><b>Wormbo:</b> I should really continue this sometimes... o_O</p>
<p><b>Trystan:</b> hehehe. I've said that myself <b>so</b> many times. =)</p>
<dl>
<dd>More week pass...</dd>
</dl>
<p><b>GRAF!K:</b> Are you going to continue this?</p>
<p><b>Wormbo:</b> Yes, I planned to... sometimes at least...&#160;:rolleyes:</p>
<dl>
<dd>Even more weeks (or better: months) pass...</dd>
</dl>
<p><b>Wormbo:</b> Enough is enough. This project got stuck at the bot AI and I hereby officially cancel development. You can get the mod and its source code at <a href="http://www.koehler-homepage.de/Wormbo/spareparts.html" class="external text" title="http://www.koehler-homepage.de/Wormbo/spareparts.html" rel="nofollow">my spare parts page</a>. If you want you can continue it, the only thing really missing is the bot AI. Reversed CTF itself is in "Overload v100 state", i.e. it works online without any problems as long as no bots are involved.</p>

<!-- 
NewPP limit report
Preprocessor node count: 26/1000000
Post-expand include size: 24/2097152 bytes
Template argument size: 0/2097152 bytes
#ifexist count: 0/100
-->
<div class="printfooter">
</div>
	    <div id="catlinks"><p class='catlinks'><a href="../../../../articles/c/a/t/Special%7ECategories_101d.html" title="Special:Categories">Category</a>: <span dir='ltr'><a href="../../../../articles/l/e/g/Category%7ELegacy_Journal_a8a9.html" title="Category:Legacy Journal">Legacy Journal</a></span></p></div>	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-legacy"
	       class="selected"	       ><a href="../../../../articles/w/o/r/Legacy%7EWormbo_Developer_Journal_6555.html">Legacy</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../../articles/w/o/r/Legacy_talk%7EWormbo_Developer_Journal_d6e5.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://wiki.beyondunreal.com/Legacy:Wormbo/Developer_Journal">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../../misc/uewiki.png);"
	    href="../../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-mainpage"><a href="../../../../index.html">Main Page</a></li>
	     	      <li id="n-portal"><a href="../../../../articles/c/o/m/Unreal_Wiki%7ECommunity_Portal_3311.html">Community portal</a></li>
	     	      <li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt='Attribution-Noncommercial-Share Alike 3.0' /></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 21:47, 4 October 2003 by Unreal Wiki user <a href="../../../../articles/w/o/r/User%7EWormbo_7d13.html" title="User:Wormbo">Wormbo</a>. Based on work by Anonymous user(s) of Unreal Wiki.</li>	  <li id="f-copyright">Licensed as <a href="../../../../articles/c/o/p/Unreal_Wiki%7ECopyrights_e561.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>	  <li id="f-about"><a href="../../../../articles/a/b/o/Unreal_Wiki%7EAbout_9ce6.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>	  <li id="f-disclaimer"><a href="../../../../articles/g/e/n/Unreal_Wiki%7EGeneral_disclaimer_a0a2.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
