<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- headlinks removed -->
	<link rel="shortcut icon" href="../../../../misc/uewiki-favicon.png"/>
    <title>Legacy:Basic AI Scripting Tutorial - Unreal Wiki</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../../skins/offline/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/md5.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/utf8.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/lookup.js"></script>
    <script type="text/javascript" src="../../../../articles/-/_/_/-.html"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../../articles/c/o/m/MediaWiki%7ECommon.css_d42e.html";
@import "../../../../articles/m/o/n/MediaWiki%7EMonobook.css_fb19.html";
@import "../../../../articles/-/_/_/-.html";
/*]]>*/</style>          </head>
  <body
    class="ns-100">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Legacy:Basic AI Scripting Tutorial</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</h3>
	    <div id="contentSub"></div>
	    	    	    <!-- start content -->
	    <p>This is a tutorial on UScripting a custom AI.</p>
<p><b>This page is under construction.</b></p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-1"><a href="#Prerequisites"><span class="tocnumber">2</span> <span class="toctext">Prerequisites</span></a></li>
<li class="toclevel-1"><a href="#Behavior_Design"><span class="tocnumber">3</span> <span class="toctext">Behavior Design</span></a>
<ul>
<li class="toclevel-2"><a href="#AI_Design_Plan"><span class="tocnumber">3.1</span> <span class="toctext">AI Design Plan</span></a></li>
<li class="toclevel-2"><a href="#Provided_Animation_and_Sounds"><span class="tocnumber">3.2</span> <span class="toctext">Provided Animation and Sounds</span></a></li>
<li class="toclevel-2"><a href="#AI_Design_Flow"><span class="tocnumber">3.3</span> <span class="toctext">AI Design Flow</span></a>
<ul>
<li class="toclevel-3"><a href="#NaliCow_Behaviors"><span class="tocnumber">3.3.1</span> <span class="toctext">NaliCow Behaviors</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1"><a href="#Coding_Elements"><span class="tocnumber">4</span> <span class="toctext">Coding Elements</span></a>
<ul>
<li class="toclevel-2"><a href="#Animation_.26_Sound"><span class="tocnumber">4.1</span> <span class="toctext">Animation &amp; Sound</span></a></li>
<li class="toclevel-2"><a href="#Navigation"><span class="tocnumber">4.2</span> <span class="toctext">Navigation</span></a></li>
<li class="toclevel-2"><a href="#Movement"><span class="tocnumber">4.3</span> <span class="toctext">Movement</span></a></li>
<li class="toclevel-2"><a href="#Damage"><span class="tocnumber">4.4</span> <span class="toctext">Damage</span></a></li>
<li class="toclevel-2"><a href="#Death"><span class="tocnumber">4.5</span> <span class="toctext">Death</span></a></li>
<li class="toclevel-2"><a href="#Effects"><span class="tocnumber">4.6</span> <span class="toctext">Effects</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Class_Construction"><span class="tocnumber">5</span> <span class="toctext">Class Construction</span></a>
<ul>
<li class="toclevel-2"><a href="#NaliCow"><span class="tocnumber">5.1</span> <span class="toctext">NaliCow</span></a>
<ul>
<li class="toclevel-3"><a href="#Pawn_Default_Properties"><span class="tocnumber">5.1.1</span> <span class="toctext">Pawn Default Properties</span></a></li>
<li class="toclevel-3"><a href="#Pawn_Default_Methods"><span class="tocnumber">5.1.2</span> <span class="toctext">Pawn Default Methods</span></a></li>
<li class="toclevel-3"><a href="#AIController_Properties"><span class="tocnumber">5.1.3</span> <span class="toctext">AIController Properties</span></a></li>
<li class="toclevel-3"><a href="#Final_Source_Code"><span class="tocnumber">5.1.4</span> <span class="toctext">Final Source Code</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#NaliCowPoop"><span class="tocnumber">5.2</span> <span class="toctext">NaliCowPoop</span></a>
<ul>
<li class="toclevel-3"><a href="#BioGlob_Default_Properties"><span class="tocnumber">5.2.1</span> <span class="toctext">BioGlob Default Properties</span></a></li>
<li class="toclevel-3"><a href="#BioGlob_Default_Methods"><span class="tocnumber">5.2.2</span> <span class="toctext">BioGlob Default Methods</span></a></li>
<li class="toclevel-3"><a href="#Final_Source_Code_2"><span class="tocnumber">5.2.3</span> <span class="toctext">Final Source Code</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1"><a href="#Testing_and_Implementation"><span class="tocnumber">6</span> <span class="toctext">Testing and Implementation</span></a>
<ul>
<li class="toclevel-2"><a href="#Compiling"><span class="tocnumber">6.1</span> <span class="toctext">Compiling</span></a></li>
<li class="toclevel-2"><a href="#Implementation"><span class="tocnumber">6.2</span> <span class="toctext">Implementation</span></a></li>
<li class="toclevel-2"><a href="#Replication"><span class="tocnumber">6.3</span> <span class="toctext">Replication</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Further_Development"><span class="tocnumber">7</span> <span class="toctext">Further Development</span></a>
<ul>
<li class="toclevel-2"><a href="#DrawScale_Adjustments"><span class="tocnumber">7.1</span> <span class="toctext">DrawScale Adjustments</span></a></li>
<li class="toclevel-2"><a href="#Cow_and_Baby_Relationships"><span class="tocnumber">7.2</span> <span class="toctext">Cow and Baby Relationships</span></a>
<ul>
<li class="toclevel-3"><a href="#bHasBaby_and_BabyCow"><span class="tocnumber">7.2.1</span> <span class="toctext">bHasBaby and BabyCow</span></a></li>
<li class="toclevel-3"><a href="#bStayClose_and_WanderRadius"><span class="tocnumber">7.2.2</span> <span class="toctext">bStayClose and WanderRadius</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#Ridable_NaliCows"><span class="tocnumber">7.3</span> <span class="toctext">Ridable NaliCows</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#External_Links"><span class="tocnumber">8</span> <span class="toctext">External Links</span></a></li>
<li class="toclevel-1"><a href="#Related_Topics"><span class="tocnumber">9</span> <span class="toctext">Related Topics</span></a></li>
<li class="toclevel-1"><a href="#Discussion"><span class="tocnumber">10</span> <span class="toctext">Discussion</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Overview" id="Overview"></a></p>
<h2><span class="mw-headline">Overview</span></h2>
<p>This tutorial will detail re-construction of the NaliCow NPC for UT2004. It was originally available in UT as a <a href="../../../../articles/c/o/w/Legacy%7ECow_6533.html" title="Legacy:Cow">Cow</a>, but this tutorial will revise its AI design as if it were new. The stock meshes and sounds that are available will allow us to concentrate purely on the AI that drives its behavior. We will start will a comprehensive behavior design before coding the elements and constructing the custom classes that will give this NPC life and then implement it in the game environment.</p>
<div class="center">
<div class="floatnone"><span><a href="../../../../articles/l/e/g/Image%7ELegacy_scriptedpawn.nalicows.jpeg_a9ab.html" class="image" title="The NaliCow and BabyCow from Unreal Tournament."><img alt="The NaliCow and BabyCow from Unreal Tournament." src="../../../../images/Legacy_scriptedpawn.nalicows.jpeg" width="348" height="121" border="0" /></a></span></div>
</div>
<p><a name="Prerequisites" id="Prerequisites"></a></p>
<h2><span class="mw-headline">Prerequisites</span></h2>
<p>Although creating only a simple AI for this NPC, this will be an advanced tutorial that assumes a solid understanding of <a href="../../../../articles/u/n/r/Legacy%7EUnrealScript_a9c5.html" title="Legacy:UnrealScript">UnrealScript</a>. This tutorial will assume you know how to <a href="../../../../articles/c/r/e/Legacy%7ECreate_A_Subclass_2675.html" title="Legacy:Create A Subclass">Create A Subclass</a>, <a href="../../../../articles/s/e/t/Legacy%7ESet_Up_Package_Folders_6a30.html" title="Legacy:Set Up Package Folders">Set up package folders</a>, <a href="../../../../articles/l/a/u/Legacy%7ELaunch_A_Local_Netgame_df6b.html" title="Legacy:Launch A Local Netgame">Launch a local netgame</a> and <a href="../../../../articles/a/d/d/Legacy%7EAdd_EditPackage_caba.html" title="Legacy:Add EditPackage">Add EditPackage</a>. In terms of <a href="../../../../articles/m/a/k/Legacy%7EMaking_Mods_187d.html" title="Legacy:Making Mods">Making Mods</a>, this tutorial will assume that you know about <a href="../../../../articles/r/e/p/Legacy%7EReplication_1109.html" title="Legacy:Replication">Replication</a>, <a href="../../../../articles/c/o/d/Legacy%7ECoding_Guidelines_5ef3.html" title="Legacy:Coding Guidelines">Coding Guidelines</a> and <a href="../../../../articles/c/o/m/Legacy%7ECompiling_With_UCC_0337.html" title="Legacy:Compiling With UCC">Compiling with UCC</a>.</p>
<p>Even if you aren't confident in your understanding of these many topics, this tutorial will still serve as an overview discussion of designing a simple <a href="../../../../articles/a/r/t/Legacy%7EArtificial_Intelligence_63c0.html" title="Legacy:Artificial Intelligence">Artificial Intelligence</a> construct.</p>
<p><a name="Behavior_Design" id="Behavior_Design"></a></p>
<h2><span class="mw-headline">Behavior Design</span></h2>
<p>We will begin by defining a design for the NaliCow's behavior.</p>
<p><a name="AI_Design_Plan" id="AI_Design_Plan"></a></p>
<h3><span class="mw-headline">AI Design Plan</span></h3>
<p>The behavior design is the roadmap for our AI scripting, giving us a clear set of coding elements to complete before it's AI takes shape.</p>
<p>Although there are many different methods of designing AI (including sophisticated methods such as neural networks and artificial evolution), with a simple creature like this, our tutorial will follow the most basic and standard method used by all stock Unreal AI; conditional decision-making. This is the method that takes stimuli as a constant condition or trigger to either do this or that; also known as "if this, then do that", or "if-then" decision-making. A common example of this kind of AI is the AI Script in a <a href="../../../../articles/s/c/r/Legacy%7EScriptedSequence_4caa.html" title="Legacy:ScriptedSequence">ScriptedSequence</a>, but even Bots use this method, just in an extremely complex form.</p>
<p>We have some features of our NPC already defined for us; it's model, textures, animation and sounds. Normally, a custom character would be started by defining it's purpose or goal and then design those features around it. But for this behavior design, we will work "backwards"; starting with those features and finding the purpose and behavior design that fits it.</p>
<p>With that in mind, we will first look at what we have to work with.</p>
<p><a name="Provided_Animation_and_Sounds" id="Provided_Animation_and_Sounds"></a></p>
<h3><span class="mw-headline">Provided Animation and Sounds</span></h3>
<p>There are plenty of stock animations provided in UT2004 for the NaliCow even though there is no <a href="../../../../articles/m/o/n/Legacy%7EMonster_d9bb.html" title="Legacy:Monster">Monster</a> subclass for it. With these animation sequences, we can easily construct an AI design flow that will convey a creature of convincing realism and range of ability. The following is a list of the NaliCow animations found the <a href="../../../../articles/m/e/s/Legacy%7EMesh_Browser_f56f.html" title="Legacy:Mesh Browser">Mesh Browser</a>. The number of animation frames in the sequence are shown in brackets. <i>Loop</i> indicates the last frame matches a common start pose of all other <i>Loop</i> animations. <i>SingleFrame</i> is just one frame, a pose. <i>Sequence</i> indicates an animation sequence that is meant to only play through once and does not end on the common starting pose of the <i>Loop</i> animations.</p>
<ul>
<li><b>root</b> [20]&#160;: Loop. Bends down to graze.</li>
<li><b>Breath</b> [6]&#160;: Loop. Breathes. Prone.</li>
<li><b>Chew</b> [7]&#160;: Loop. Chews.</li>
<li><b>Poop</b> [20]&#160;: Loop. Lifts tail and poops.</li>
<li><b>Shake</b> [18]&#160;: Loop. Shakes head, as if shaking off water or dust.</li>
<li><b>Swish</b> [20]&#160;: Loop. Swishes it's tail from side to side and stamps foot.</li>
<li><b>Walk</b> [15]&#160;: Loop. A walk cycle.</li>
<li><b>Run</b> [10]&#160;: Loop. A run cycle.</li>
<li><b>Landed</b> [1]&#160;: Single frame. Indicates recovery from a fall.</li>
<li><b>TakeHit1</b> [1]&#160;: Single frame. Indicates recovery from damage.</li>
<li><b>TakeHit2</b> [1]&#160;: Single frame. Indicates recovery from more damage.</li>
<li><b>BigHit</b> [1]&#160;: Single frame. Indicates recovery from a lot of damage. (both feet in the air)</li>
<li><b>Dead</b> [23]&#160;: Sequence. Indicates a slow death, slumping to the side.</li>
<li><b>Dead2</b> [13]&#160;: Sequence. Death animation, starting from <b>TakeHit2</b>, slumping forward.</li>
<li><b>Dead3</b> [23]&#160;: Sequence. Severe death, starting from <b>BigHit</b>, showing a complete back flip.</li>
</ul>
<p>These stock sounds are available in the <a href="../../../../articles/s/o/u/Legacy%7ESound_Browser_823d.html" title="Legacy:Sound Browser">Sound Browser</a>, under <tt>SkaarjPack_rc</tt>, that relate to the NaliCow:</p>
<ul>
<li><b>ambCow</b>&#160;: Breath of a NaliCow.</li>
<li><b>cMoo1c</b>&#160;: NaliCow call. (sounds suspiciously like a Doom creature's death cry)</li>
<li><b>cMoo2c</b>&#160;: Another call.</li>
<li><b>DeathC1c</b>&#160;: "Urgent" call.</li>
<li><b>DeathC2c</b>&#160;: Another "urgent" call.</li>
<li><b>injurC1c</b>&#160;: Pained call.</li>
<li><b>injurC2c</b>&#160;: A call that sounds a little like, "Ow".</li>
<li><b>munch1p</b>&#160;: A biting sound (normally used for the SkaarjPupae).</li>
<li><b>shakeC</b>&#160;: Ears flapping as the NaliCow shakes.</li>
<li><b>swishC</b>&#160;: Swishing sound of the NaliCow tail.</li>
<li><b>Thump</b>&#160;: Generic hard landing sound.</li>
<li><b>WalkC</b>&#160;: NaliCow footstep.</li>
</ul>
<p><a name="AI_Design_Flow" id="AI_Design_Flow"></a></p>
<h3><span class="mw-headline">AI Design Flow</span></h3>
<p>With these pieces, we can begin to analyze the potential behavior and assemble the design in such a way that we understand how one piece leads to the next.</p>
<ul>
<li>Some of these pieces indicate behavior that's initiated by the NaliCow; such as Grazing, Swishing, Pooping. Others are behaviors that are in reaction to external stimuli; such as TakeHit or Death.</li>
<li>We know we will want the NaliCow to navigate from place to place. Some decision making will involve where to go and whether to walk or run. Running away from danger will serve a self-preservation purpose while walking toward a goal, such as another NaliCow, may serve to support the idea these are real creatures (an immersion purpose) through a percieved flocking behavior.</li>
<li>Obvious connections can be made between the animation sequences and the sounds that correspond to them. We will want to have these sounds play whenever those animations are played. Other connections can be made between some of these pieces, where one will likely lead to another; such as Grazing leading to Chewing, a TakeHit leading to either Death or Run, etc.</li>
<li>One piece of this behavior, Pooping, appears to need an extra effect; the NaliCowPoop itself. It will have to be an extra actor class with it's own code.</li>
</ul>
<p>We can see a prone state, where the <b>Breath</b> animation and <b>ambCow</b> sound would be looped. This appears to be a good place to start. We will be able to branch out from this prone state to any other looping animation sequence and corresponding sound, building up the behavior design flow, piece by piece.</p>
<p>The following chart attempts to describe all the possible behaviors, their animation, their sound and what behaviors might preceed and follow them.</p>
<table class="wikitable">
<tr>
<td colspan="12" style="text-align: center"><a name="NaliCow_Behaviors" id="NaliCow_Behaviors"></a>
<h4><span class="mw-headline"><b>NaliCow Behaviors</b></span></h4>
</td>
</tr>
<tr>
<td></td>
<td style="text-align: center"><b>1. Prone</b></td>
<td style="text-align: center"><b>2. Graze</b></td>
<td style="text-align: center"><b>3. Chew</b></td>
<td style="text-align: center"><b>4. Poop</b></td>
<td style="text-align: center"><b>5. Shake</b></td>
<td style="text-align: center"><b>6. Swish</b></td>
<td style="text-align: center"><b>7. Walk</b></td>
<td style="text-align: center"><b>8. Run</b></td>
<td style="text-align: center"><b>9. Land</b></td>
<td style="text-align: center"><b>10. TakeHit</b></td>
<td style="text-align: center"><b>11. Dying</b></td>
</tr>
<tr>
<td style="text-align: left"><b>Animation</b></td>
<td>Breath</td>
<td>root</td>
<td>Chew</td>
<td>Poop</td>
<td>Shake</td>
<td>Swish</td>
<td>Walk</td>
<td>Run</td>
<td>Landed</td>
<td>TakeHit1, 2 or BigHit</td>
<td>Dead, 2, 3</td>
</tr>
<tr>
<td style="text-align: left"><b>Sound</b></td>
<td>ambCow</td>
<td>munch1p</td>
<td>munch1p</td>
<td>cMoo1c, 2c</td>
<td>shakeC</td>
<td>swishC</td>
<td>WalkC</td>
<td>WalkC</td>
<td>Thump</td>
<td>injurC1c, 2c</td>
<td>DeathC1c, 2c</td>
</tr>
<tr>
<td style="text-align: left"><b>Lead From</b></td>
<td>1-7</td>
<td>1-7</td>
<td>2</td>
<td>1-7</td>
<td>1-7</td>
<td>1-7</td>
<td>1-10</td>
<td>7-10</td>
<td>7 or 8**</td>
<td>1-9***</td>
<td>10</td>
</tr>
<tr>
<td style="text-align: left"><b>Lead To</b></td>
<td>1-7</td>
<td>3</td>
<td>1-7</td>
<td>1-7*</td>
<td>1-7</td>
<td>1-7</td>
<td>1-8</td>
<td>7-8</td>
<td>1, 5, 7</td>
<td>7, 8, 11</td>
<td><i>None</i>†</td>
</tr>
<tr>
<td colspan="12" style="text-align: center">* – <i>A NaliCowPoop actor should be spawned during this behavior.</i></td>
</tr>
<tr>
<td colspan="12" style="text-align: center">** – <i>This behavior will activate immeditately upon landing from a fall, without waiting for animation loops to end..</i></td>
</tr>
<tr>
<td colspan="12" style="text-align: center">*** – <i>This behavior will activate immeditately upon taking damage, without waiting for animation loops to end.</i></td>
</tr>
<tr>
<td colspan="12" style="text-align: center">† – <i>The NaliCow carcass will DeRes and disappear a short time after this behavior.</i></td>
</tr>
</table>
<p><a name="Coding_Elements" id="Coding_Elements"></a></p>
<h2><span class="mw-headline">Coding Elements</span></h2>
<p>With the AI Design Flow sketched out, we will be able to code the AI behaviors appropriately. But first, we will have to complete the code that will handle the basic tasks these behaviors will have to perform. These tasks include animation, sound, movement, damage, death, etc.</p>
<p><a name="Animation_.26_Sound" id="Animation_.26_Sound"></a></p>
<h3><span class="mw-headline">Animation &amp; Sound</span></h3>
<p>As shown in the above chart, animation sequences and sounds are linked together. A couple exceptions to that rule include animations that can play one of a few available sounds and actions that play one animation, but more than one sound, such as Walk or Run, where two footsteps should be heard. We will use the animation sequence as a handle for the action and have that dictate the possible sounds.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="co1">// DisplayBehavior() takes a BehaviorIndex value and sets the appropriate animation and sound.</span>
<span class="co1">// Degrees of behavior will be taken into account via an optional arguement.</span>
<span class="kw5">function</span> DisplayBehavior<span class="br0">(</span> <span class="kw4">int</span> BehaviorIndex, <span class="kw6">optional</span> <span class="kw4">int</span> Degree <span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">switch</span><span class="br0">(</span> BehaviorIndex <span class="br0">)</span> <span class="br0">{</span>
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span> :
            Acting<span class="br0">(</span> <span class="st0">'Breath'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.ambCow'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span> : 
            Acting<span class="br0">(</span> <span class="st0">'root'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.munch1p'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span> : 
            Acting<span class="br0">(</span> <span class="st0">'Chew'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.munch1p'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span> : 
            <span class="kw1">if</span> <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0.5</span> <span class="br0">)</span>
                Acting<span class="br0">(</span> <span class="st0">'Poop'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.cMoo1c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">else</span>
                Acting<span class="br0">(</span> <span class="st0">'Poop'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.cMoo2c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">5</span><span class="br0">)</span> : 
            Acting<span class="br0">(</span> <span class="st0">'Shake'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.shakeC'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">6</span><span class="br0">)</span> : 
            Acting<span class="br0">(</span> <span class="st0">'Swish'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.swishC'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">7</span><span class="br0">)</span> : 
            Acting<span class="br0">(</span> <span class="st0">'Walk'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.WalkC'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">8</span><span class="br0">)</span> : 
            Acting<span class="br0">(</span> <span class="st0">'Run'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.WalkC'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">9</span><span class="br0">)</span> : 
            Acting<span class="br0">(</span> <span class="st0">'Landed'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.Thump'</span>, <span class="kw9">false</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">10</span><span class="br0">)</span> : 
            <span class="kw1">if</span> <span class="br0">(</span> Degree &lt; <span class="nu0">2</span> <span class="br0">)</span>
                Acting<span class="br0">(</span> <span class="st0">'TakeHit'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.cMoo1c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span> Degree == <span class="nu0">2</span> <span class="br0">)</span>
                Acting<span class="br0">(</span> <span class="st0">'TakeHit2'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.injurC1c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span> Degree == <span class="nu0">3</span> <span class="br0">)</span>
                Acting<span class="br0">(</span> <span class="st0">'BigHit'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.injurC2c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">11</span><span class="br0">)</span> : 
            <span class="kw1">if</span> <span class="br0">(</span> Degree &lt; <span class="nu0">2</span> <span class="br0">)</span>
                Acting<span class="br0">(</span> <span class="st0">'Dead'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.cMoo2c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span> Degree == <span class="nu0">2</span> <span class="br0">)</span>
                Acting<span class="br0">(</span> <span class="st0">'Dead2'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.DeathC1c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span> Degree == <span class="nu0">3</span> <span class="br0">)</span>
                Acting<span class="br0">(</span> <span class="st0">'Dead3'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.DeathC2c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">break</span>;
        <span class="kw1">default</span> : 
            Acting<span class="br0">(</span> <span class="st0">'Breath'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.ambCow'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
     <span class="br0">}</span>
<span class="br0">}</span>
 
<span class="co1">// Acting() loops the given animation sequence name and plays the given sound.</span>
<span class="co1">// For Replication purposes, animation is normally looped.  Sequences may be interupted each AnimEnd().</span>
<span class="kw5">function</span> Acting<span class="br0">(</span> <span class="kw4">name</span> Anim, <a href="/sound"><span class="kw10">sound</span></a> Soundname, <span class="kw4">bool</span> bLoop <span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">if</span> <span class="br0">(</span> bLoop <span class="br0">)</span>
        LoopAnim<span class="br0">(</span> Anim, <span class="nu0">1.0</span>, <span class="nu0">0.1</span> <span class="br0">)</span>;
    <span class="kw1">else</span>
        PlayAnim<span class="br0">(</span> Anim, <span class="nu0">1.0</span>, <span class="nu0">0.1</span> <span class="br0">)</span>;
    SimAnim.<span class="me1">AnimSequence</span> = Anim;
    SimAnim.<span class="me1">AnimRate</span> = <span class="nu0">1.0</span>;
    <span class="kw1">if</span> <span class="br0">(</span> bLoop <span class="br0">)</span>
        SimAnim.<span class="me1">bAnimLoop</span> = <span class="kw9">true</span>;
    <span class="kw1">else</span>
        SimAnim.<span class="me1">bAnimLoop</span> = <span class="kw9">false</span>;
        SimAnim.<span class="me1">TweenRate</span> = <span class="nu0">0.1</span>;
    PlaySound<span class="br0">(</span> Soundname, SLOT_Misc <span class="br0">)</span>;
<span class="br0">}</span>
</pre></div>
<p><a name="Navigation" id="Navigation"></a></p>
<h3><span class="mw-headline">Navigation</span></h3>
<p>This is our first decision-making code. We will need our AI to decide where to go and what to look at. Controllers use MoveTarget and ViewTarget by default. They are the Destination and Focus for the controller. We will simply alter those properties based on desires of self-preservation.</p>
<p>First, if we have reached our destination, we want to be able to select another one reasonably. Next, if another Actor has hurt our NPC, we want our AI to avoid it. So we will do checks to make sure the selected destination or focus is not the Actor that hurt our NPC. We will also avoid any Actor who Bumps or Touches our NPC, as if it had hurt it. If the NPC is Bumped, Touched or Triggered, we will have our NPC Walk away, or if already Walking, perhaps begin to Run. Finally, we want to know if our NPC is stuck, trying to reach a destination but not able to progress from it's current Location. We will do a simple check to ensure it makes progress when it Walks or Runs, and if not, we will select another destination.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">var</span>            <a href="/Actor"><span class="kw10">Actor</span></a>            HurtingActor;   <span class="co1">// An Actor to get away from.</span>
<span class="kw5">var</span>            <span class="kw4">vector</span>         OldLocation;    <span class="co1">// Used to determine if stuck.</span>
 
<span class="co1">// PostBeginPlay() is originally defined in Actor().</span>
<span class="co1">// We will use it to make sure an AIController is spawned for our NaliCow.</span>
<span class="kw5">event</span> PostBeginPlay<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw6">Super</span>.<span class="me1">PostBeginPlay</span><span class="br0">(</span><span class="br0">)</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> <span class="br0">(</span> ControllerClass != <span class="kw9">None</span> <span class="br0">)</span> &amp;&amp; <span class="br0">(</span> Controller == <span class="kw9">None</span> <span class="br0">)</span> <span class="br0">)</span>
                Controller = spawn<span class="br0">(</span> ControllerClass <span class="br0">)</span>;
        <span class="kw1">if</span> <span class="br0">(</span> Controller != <span class="kw9">None</span> <span class="br0">)</span>
                Controller.<span class="me1">Possess</span><span class="br0">(</span> <span class="kw8">self</span> <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// ReachedDestination() is originally defined in Pawn.</span>
<span class="co1">// MoveTarget and other relevant properties are defined in Controller.</span>
<span class="kw5">function</span> <span class="kw4">bool</span> ReachedDestination<span class="br0">(</span> <a href="/Actor"><span class="kw10">Actor</span></a> OldTarget <span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw5">local</span>   <a href="/Actor"><span class="kw10">Actor</span></a>   NewTarget, A;
    <span class="kw5">local</span>   NavigationPoint    NP;
 
    <span class="kw1">forEach</span> VisibleActors<span class="br0">(</span> <span class="kw5">class</span><span class="st0">'Actor'</span>, A <span class="br0">)</span>
        <span class="kw1">if</span> <span class="br0">(</span> A != OldTarget &amp;&amp; A != HurtingActor <span class="br0">)</span>
            NewTarget = A;
 
    <span class="kw1">if</span> <span class="br0">(</span> A == <span class="kw9">None</span> <span class="br0">)</span>
        <span class="kw1">forEach</span> RadiusActors<span class="br0">(</span> <span class="kw5">class</span><span class="st0">'NavigationPoint'</span>, NP, <span class="nu0">1024</span> <span class="br0">)</span>
            <span class="kw1">if</span> <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0.5</span> &amp;&amp; NP != OldTarget &amp;&amp; FastTrace<span class="br0">(</span> NP.<span class="me1">Location</span> <span class="br0">)</span> <span class="br0">)</span>
            <span class="br0">{</span>
                A = NP;
                NewTarget = A;
            <span class="br0">}</span>
 
    <span class="kw1">if</span> <span class="br0">(</span> A == <span class="kw9">None</span> <span class="br0">)</span>
        <span class="kw1">forEach</span> AllActors<span class="br0">(</span> <span class="kw5">class</span><span class="st0">'Actor'</span>, A <span class="br0">)</span>
            <span class="kw1">if</span> <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0.5</span> &amp;&amp; A != HurtingActor &amp;&amp; A != OldTarget &amp;&amp; A != <span class="kw8">self</span> &amp;&amp; !A.<span class="kw7">IsA</span><span class="br0">(</span><span class="st0">'Controller'</span><span class="br0">)</span> <span class="br0">)</span>
                NewTarget = A;
 
    <span class="kw1">if</span> <span class="br0">(</span> NewTarget != <span class="kw9">None</span> <span class="br0">)</span>
    <span class="br0">{</span>
        Controller.<span class="me1">MoveTarget</span> = NewTarget;
        Controller.<span class="me1">Destination</span> = NewTarget.<span class="me1">Location</span>;
        Controller.<span class="me1">FocalPoint</span> = NewTarget.<span class="me1">Location</span>;
        Controller.<span class="me1">Focus</span> = NewTarget;
    <span class="br0">}</span>
    <span class="kw1">else</span>
    <span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span> HurtingActor != <span class="kw9">None</span> <span class="br0">)</span>
        <span class="br0">{</span>
            Controller.<span class="me1">Destination</span> = <span class="br0">(</span> Location - HurtingActor.<span class="me1">Location</span> <span class="br0">)</span>;
            Controller.<span class="me1">FocalPoint</span> = Controller.<span class="me1">Destination</span>;
        <span class="br0">}</span>
        <span class="kw1">else</span>
        <span class="br0">{</span>
            Controller.<span class="me1">Destination</span> = <span class="kw4">vector</span><span class="br0">(</span> Rotation <span class="br0">)</span> * <span class="br0">(</span> <span class="nu0">512</span> * <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> + <span class="nu0">512</span> <span class="br0">)</span>;
            Controller.<span class="me1">FocalPoint</span> = Controller.<span class="me1">Destination</span>;
        <span class="br0">}</span>
    <span class="br0">}</span>
<span class="br0">}</span>
 
<span class="co1">// Trigger() is originally defined in Actor.</span>
<span class="kw5">function</span> Trigger<span class="br0">(</span> <a href="/Actor"><span class="kw10">Actor</span></a> Other, <a href="/Pawn"><span class="kw10">Pawn</span></a> EventInstigator <span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span> <span class="br0">)</span>
        <span class="kw1">return</span>;
        <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span> <span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span>;
                <span class="kw1">return</span>;
        <span class="br0">}</span>
        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// Touch() is originally defined in Actor.</span>
<span class="kw5">function</span> Touch<span class="br0">(</span> <a href="/Actor"><span class="kw10">Actor</span></a> Other <span class="br0">)</span>
<span class="br0">{</span>
    HurtingActor = Other;
    <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span> <span class="br0">)</span>
        <span class="kw1">return</span>;
        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// Bump() is originally defined in Actor.</span>
<span class="kw5">function</span> Bump<span class="br0">(</span> <a href="/Actor"><span class="kw10">Actor</span></a> Other <span class="br0">)</span>
<span class="br0">{</span>
    HurtingActor = Other;
    <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span> &amp;&amp; <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &lt; <span class="nu0">0.9</span> <span class="br0">)</span> <span class="br0">)</span>  <span class="co1">// Chance to calm.</span>
        <span class="kw1">return</span>;
        <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span> &amp;&amp; <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0.9</span> <span class="br0">)</span> <span class="br0">)</span>  <span class="co1">// Change due to startle.</span>
        <span class="br0">{</span>
                <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span>;
                <span class="kw1">return</span>;
        <span class="br0">}</span>
        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span>;
<span class="br0">}</span>
</pre></div>
<p>And then somewhere in during movement, we will perform checks to determine if the character has reached it's destination or if it's gotten stuck while traveling.</p>
<p><a name="Movement" id="Movement"></a></p>
<h3><span class="mw-headline">Movement</span></h3>
<p>We need our NPC NaliCow to travel to destinations. It's default Physics will be PHYS_Walking. So unless we find that the character should be falling, we're just going to concern ourselves with ground movement. Our checks determining if the NPCs destination is reached or if the NPC is stuck will also happen during movement. We also want the ability to halt all movement by defining a zero SpeedRatio, so that our character does not slide around while showing an animation with it's feet firmly planted. At this point, we will also introduce another property bStartled that will indicate the NaliCow has been recently hurt or otherwise made to react. We will take advantage of the fact that movement will be checked often and use it to make a few decisions about bStartle, either to react to it by Running or to calm back down. bStartled will be set to true during damage.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">var</span>            <span class="kw4">bool</span>           bStartled;              <span class="co1">// Recently startled.</span>
 
<span class="co1">// MoveCheck() deals with periodic checks for bStartled, DamageTaken and falling.</span>
<span class="co1">// Then moves the character in direction of Rotation and at speed of SpeedRatio.</span>
<span class="kw5">function</span> MoveCheck<span class="br0">(</span> <span class="kw4">float</span> SpeedRatio <span class="br0">)</span>
<span class="br0">{</span>
        DamageTaken = <span class="nu0">0</span>;  <span class="co1">// Reset most recent damage memory.</span>
 
        <span class="kw1">if</span> <span class="br0">(</span> Base == <span class="kw9">None</span> <span class="br0">)</span>  <span class="co1">// Should be falling.</span>
        <span class="br0">{</span>
                <span class="kw1">if</span> <span class="br0">(</span> Physics != PHYS_Falling <span class="br0">)</span>
                        SetPhysics<span class="br0">(</span> PHYS_Falling <span class="br0">)</span>;
                <span class="kw1">return</span>;
        <span class="br0">}</span>
 
        <span class="kw1">if</span> <span class="br0">(</span> Controller.<span class="me1">MoveTarget</span> == <span class="kw9">None</span> <span class="br0">)</span>
                ReachedDestination<span class="br0">(</span> <span class="kw8">self</span> <span class="br0">)</span>;
 
    <span class="kw1">if</span> <span class="br0">(</span> VSize<span class="br0">(</span> Controller.<span class="me1">MoveTarget</span>.<span class="me1">Location</span> - Location <span class="br0">)</span> &lt; <span class="nu0">64</span> <span class="br0">)</span>
            ReachedDestination<span class="br0">(</span> Controller.<span class="me1">MoveTarget</span> <span class="br0">)</span>;
 
    <span class="kw1">if</span> <span class="br0">(</span> VSize<span class="br0">(</span> OldLocation - Location <span class="br0">)</span> &lt; <span class="nu0">48</span> <span class="br0">)</span>
            ReachedDestination<span class="br0">(</span> Controller.<span class="me1">MoveTarget</span> <span class="br0">)</span>;
 
    OldLocation = Location;
 
    RotationRate.<span class="me1">Yaw</span> = SpeedRatio * <span class="nu0">20000</span>;
        Velocity = <span class="br0">(</span> SpeedRatio * GroundSpeed <span class="br0">)</span> * <span class="kw4">vector</span><span class="br0">(</span> Rotation <span class="br0">)</span>;
    Acceleration = Velocity;
 
        <span class="kw1">if</span> <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0.95</span> <span class="br0">)</span>  <span class="co1">// Chance to calm down.</span>
                bStartled = <span class="kw9">false</span>;
        <span class="kw1">if</span> <span class="br0">(</span> bStartled &amp;&amp; !<span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span> <span class="br0">)</span>
                <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span>;  <span class="co1">// React to startle.   </span>
<span class="br0">}</span>
</pre></div>
<p>During Walk and Run behaviors, we will want to update the character's movement, based on any changes to Rotation. The following code uses a Tick() function to constantly update the movement. We only need to do this during certain behaviors, so we will only use this code within a state designated for either Walk or Run. Normally, SetTimer() and Timer() functions set to activate every tenth of a second or so are used in place of Tick(), but this code is not particularly expensive.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">function</span> <span class="kw8">Tick</span><span class="br0">(</span> <span class="kw4">float</span> DeltaTime <span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span> Physics == PHYS_Walking &amp;&amp; DamageTaken == <span class="nu0">0</span> <span class="br0">)</span>
        <span class="br0">{</span>
            Velocity = <span class="br0">(</span> <span class="nu0">0.5</span> * GroundSpeed <span class="br0">)</span> * <span class="kw4">vector</span><span class="br0">(</span> Rotation <span class="br0">)</span>;
            Acceleration = Velocity;
        <span class="br0">}</span>
    <span class="br0">}</span>
</pre></div>
<p><a name="Damage" id="Damage"></a></p>
<h3><span class="mw-headline">Damage</span></h3>
<p>When our NPC gets hurt, we want to display specific behavior and effects. The effects needed here are blood puffs that emit from the character at the appropriate angle to which it was hurt. The behavior will be similar to those in Navigation, as the Instigator of the damage will automatically become the NPCs HurtingActor, the Actor to avoid. Any damage will cause our NPC to react by Running, unless it recieves enough damage to bring the Health down to zero. In that case, our NPC will switch to a Dying state. A new property, DamageTaken, is introduced to keep track of the most recent damage inflicted on our NaliCow. This will be used to determine the Degree to specify for our TakeHit and Dying behavior displays and it will serve to remind the NaliCow to Run away from danger.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">var</span>            <span class="kw4">int</span>                    DamageTaken;    <span class="co1">// Most recent damage amount.</span>
 
<span class="co1">// TakeDamage() is originally defined in Actor.</span>
<span class="kw5">function</span> TakeDamage<span class="br0">(</span><span class="kw4">int</span> Damage, <a href="/Pawn"><span class="kw10">Pawn</span></a> InstigatedBy, <span class="kw4">Vector</span> HitLocation, <span class="kw4">Vector</span> Momentum, class&lt;DamageType&gt; <a href="/DamageType"><span class="kw10">DamageType</span></a><span class="br0">)</span>
<span class="br0">{</span>
    HurtingActor = InstigatedBy;
        DamageTaken = Damage;
        bStartled = <span class="kw9">true</span>;
 
    <span class="kw6">Super</span>.<span class="me1">TakeDamage</span><span class="br0">(</span> Damage, InstigatedBy, HitLocation, Momentum, <a href="/DamageType"><span class="kw10">DamageType</span></a> <span class="br0">)</span>;
 
    <span class="kw1">if</span> <span class="br0">(</span> DamageTaken &gt; <span class="nu0">3</span> <span class="br0">)</span>
        spawn<span class="br0">(</span> <span class="kw5">class</span><span class="st0">'STR_green_blood_puff'</span>,,, HitLocation, <span class="kw4">Rotator</span><span class="br0">(</span> Momentum <span class="br0">)</span> <span class="br0">)</span>;
 
    <span class="kw1">if</span> <span class="br0">(</span> Controller != <span class="kw9">None</span> &amp;&amp; <span class="br0">(</span> Controller.<span class="me1">MoveTarget</span> == HurtingActor || Controller.<span class="me1">Focus</span> == HurtingActor <span class="br0">)</span> <span class="br0">)</span>
                ReachedDestination<span class="br0">(</span> HurtingActor <span class="br0">)</span>;  <span class="co1">// Do not approach HurtingActor.</span>
 
    <span class="kw1">if</span> <span class="br0">(</span> Health &gt; <span class="nu0">0</span> <span class="br0">)</span>
        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'TakeHit'</span><span class="br0">)</span>;
    <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span> !<span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Dying'</span><span class="br0">)</span> <span class="br0">)</span>
        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Dying'</span><span class="br0">)</span>;
<span class="br0">}</span>
</pre></div>
<p><a name="Death" id="Death"></a></p>
<h3><span class="mw-headline">Death</span></h3>
<p>When our NPC dies, it will be switched to a Dying state. Switching to a unique state will allow us to Ignore various functions, like Bump or Touch, which would cause further behavior. At the beginning of this state, our NPC should stop all animation. After displaying the appropriate Dying behavior, it should stay still for a short time before removing itself from the gameworld for the sake of garbage collection. The typical garbage collection method in Unreal involves a simple check for any player currently looking at the Actor, and if no player is, delete it. If a player happens to be watching our character at this time, we will DeRez it's Mesh, a typical function where the Skin is changed to a gently flashing texture before the Actor is deleted. It visually lets players know this Actor is about to be removed. On Clients, this function will be called by a TornOff() event, which signals the Client has been given control of this actor. We will use bTearOff to signal to Clients that this NaliCow is dead and should be removed. If not explicitly removed via Destroy(), this NPC will be automatically destroyed after a set time defined with Lifespan.</p>
<p>The following code shows the Dying behavior state.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">state</span> Dying
<span class="br0">{</span>
    <span class="kw6">Ignores</span> Trigger, Touch, Bump, Landed, Died;
 
    <span class="kw5">function</span> Timer<span class="br0">(</span><span class="br0">)</span>
    <span class="br0">{</span>
        SetPhysics<span class="br0">(</span> PHYS_None <span class="br0">)</span>;
        SetCollision<span class="br0">(</span> <span class="kw9">false</span>, <span class="kw9">false</span> <span class="br0">)</span>;
        Lifespan = <span class="nu0">3.0</span>;
        <span class="kw1">if</span> <span class="br0">(</span> PlayerCanSeeMe<span class="br0">(</span><span class="br0">)</span> <span class="br0">)</span>
            DeRez<span class="br0">(</span><span class="br0">)</span>;
        <span class="kw1">else</span>
            Destroy<span class="br0">(</span><span class="br0">)</span>;
    <span class="br0">}</span>
 
    <span class="kw5">event</span> AnimEnd<span class="br0">(</span> <span class="kw4">int</span> Channel <span class="br0">)</span>
    <span class="br0">{</span>
        SetTimer<span class="br0">(</span> <span class="nu0">4.0</span>, <span class="kw9">false</span> <span class="br0">)</span>;
    <span class="br0">}</span>
 
    Begin:
        StopAnimating<span class="br0">(</span><span class="br0">)</span>;
        DisplayBehavior<span class="br0">(</span> <span class="nu0">11</span>, <span class="kw7">Min</span><span class="br0">(</span> <span class="br0">(</span> DamageTaken / <span class="nu0">20</span> <span class="br0">)</span>, <span class="nu0">3</span> <span class="br0">)</span> <span class="br0">)</span>;
        MoveCheck<span class="br0">(</span> <span class="nu0">0.0</span> <span class="br0">)</span>;
        <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">Level</span>.<span class="kw8">NetMode</span> == <span class="kw9">NM_DedicatedServer</span> <span class="br0">)</span>
        <span class="br0">{</span>
            SetPhysics<span class="br0">(</span> PHYS_None <span class="br0">)</span>;
            SetCollision<span class="br0">(</span> <span class="kw9">false</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            LifeSpan = <span class="nu0">3.0</span>;
            bTearOff = <span class="kw9">true</span>;
        <span class="br0">}</span>
<span class="br0">}</span>
</pre></div>
<p>Our DeRez function is made available on Clients and can be called from a TornOff() event.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="co1">// TornOff() is originally defined in Actor.</span>
<span class="kw5">event</span> TornOff<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">if</span> <span class="br0">(</span> PlayerCanSeeMe<span class="br0">(</span><span class="br0">)</span> <span class="br0">)</span>
        DeRez<span class="br0">(</span><span class="br0">)</span>;
    <span class="kw1">else</span>
        Destroy<span class="br0">(</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// DeRez() will signal removal of the dead NaliCow.</span>
<span class="kw6">simulated</span> <span class="kw5">function</span> DeRez<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">Level</span>.<span class="kw8">NetMode</span> == <span class="kw9">NM_DedicatedServer</span> <span class="br0">)</span>
        <span class="kw1">return</span>;
 
    Skins.<span class="kw6">length</span> = <span class="nu0">0</span>;
    Skins<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> = <a href="/Material"><span class="kw10">Material</span></a><span class="st0">'DeRez.Shaders.DeRezFinalBody'</span>;  
<span class="br0">}</span>
</pre></div>
<p>Sometimes Pawns are asked to die automatically. The following function will catch any "automatic death" event, such as being crushed by a Mover or Telefragged.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="co1">// Died() is originally defined in Pawn.</span>
<span class="kw5">function</span> Died<span class="br0">(</span> Controller Killer, class&lt;DamageType&gt; <a href="/DamageType"><span class="kw10">DamageType</span></a>, <span class="kw4">vector</span> HitLocation <span class="br0">)</span>
<span class="br0">{</span>
        TakeDamage<span class="br0">(</span> Health, <span class="kw9">None</span>, Location, <span class="kw4">vect</span><span class="br0">(</span><span class="nu0">0</span>,<span class="nu0">0</span>,<span class="nu0">-1</span><span class="br0">)</span>, <span class="kw5">class</span><span class="st0">'Crushed'</span> <span class="br0">)</span>;
<span class="br0">}</span>
</pre></div>
<p><a name="Effects" id="Effects"></a></p>
<h3><span class="mw-headline">Effects</span></h3>
<p>Besides the blood puffs needed to indicate Damage, the only effect this NPC needs is it's poop. When it performs its Poop behavior, we will want a separate Actor, a Projectile, to spawn at the appropriate place and drop to the ground.</p>
<p>We will use this line during the Poop behavior to spawn the NaliCowPoop in the appropriate location and orientation; towards the back of the character and pointing down.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
spawn<span class="br0">(</span> <span class="kw5">class</span><span class="st0">'NaliCowPoop'</span>,, <span class="st0">'Poop'</span>, <span class="br0">(</span> Location + <span class="br0">(</span> <span class="kw4">vector</span><span class="br0">(</span>Rotation<span class="br0">)</span> * <span class="nu0">-24</span> <span class="br0">)</span> <span class="br0">)</span>, <span class="kw4">rotator</span><span class="br0">(</span> <span class="kw4">vect</span><span class="br0">(</span><span class="nu0">0</span>,<span class="nu0">0</span>,<span class="nu0">-1</span><span class="br0">)</span> <span class="br0">)</span> <span class="br0">)</span>;
</pre></div>
<p><a name="Class_Construction" id="Class_Construction"></a></p>
<h2><span class="mw-headline">Class Construction</span></h2>
<p>Our NPC mostly uses functions and methods already found in the Pawn class. Because this character is not meant to respawn, pickup <a href="../../../../articles/a/d/r/Legacy%7EAdrenaline_cd3b.html" title="Legacy:Adrenaline">Adrenaline</a>, carry <a href="../../../../articles/i/n/v/Legacy%7EInventory_cc1f.html" title="Legacy:Inventory">Inventory</a>, etc., a simple Pawn subclass can be used without a custom Controller. The AI can be coded into the custom Pawn class, NaliCow, and we can use the default AIController.</p>
<p>For the effects, the NaliCowPoop, we will use make a custom subclass from the Projectile class, BioGlob.</p>
<p><a name="NaliCow" id="NaliCow"></a></p>
<h3><span class="mw-headline">NaliCow</span></h3>
<p>With our code elements defined, we can simply begin to piece them together within a Pawn subclass called NaliCow. Along the way, we will make decisions about any further behaviors needed, such as a simple Turn behavior, where the Walk animation is played but the character only spins in place, or a redefinition of the Landed() event to make sure the character reacts appropriately if bStartled. We will also make decisions about the frequency and chance that any given behavior be initiated from any other. Most of the time, a simple random chance filtered through a switch statement will suffice.</p>
<p>A state will be defined for each behavior, allowing us to completely control the character, including it's movement and further behavior.</p>
<p>Putting together this NPC character requires the use of properties and methods, some will be custom, but most of which have been defined in the Pawn, Actor or Controller classes.</p>
<p><a name="Pawn_Default_Properties" id="Pawn_Default_Properties"></a></p>
<h4><span class="mw-headline">Pawn Default Properties</span></h4>
<dl>
<dt>(Advanced) float Lifespan&#160;</dt>
<dd>Pawn default is 0. We keep it there by default, but will be modifying it in game.</dd>
<dt>(Collision) int CollisionHeight&#160;</dt>
<dd>Pawn default is 74. Our default will be 34.</dd>
<dt>(Collision) SurfaceType&#160;</dt>
<dd>Pawn default is EST_Default. Our default will be EST_Flesh.</dd>
<dt>(Display) <a href="../../../../articles/m/e/s/Legacy%7EMesh_86f6.html" title="Legacy:Mesh">Mesh</a> Mesh&#160;</dt>
<dd>Our default is <tt>VertMesh'SkaarjPack_rc.NaliCow'</tt>.</dd>
<dt>(Movement) Physics&#160;</dt>
<dd>Pawn default is PHYS_None. Our default will be PHYS_Walking.</dd>
<dt>(Movement) rotator RotationRate&#160;</dt>
<dd>Pawn default RotationRate.Yaw is 20000. We keep it there by default, but will be modifying it in game.</dd>
<dt>(Movement) vector Velocity, Acceleration&#160;</dt>
<dd>These two properties are used during Movement.</dd>
<dt>(None) <a href="../../../../articles/c/o/n/Legacy%7EController_ee75.html" title="Legacy:Controller">Controller</a> Controller&#160;</dt>
<dd>By default Pawns automatically spawn a Controller of Pawn.ControllerClass during PreBeginPlay(). This will be our handle to the Controller.</dd>
<dt>(None) class&lt;<a href="../../../../articles/c/o/n/Legacy%7EController_ee75.html" title="Legacy:Controller">Controller</a>&gt; ControllerClass&#160;</dt>
<dd>Pawn default value is <a href="../../../../articles/a/i/c/Legacy%7EAIController_8307.html" title="Legacy:AIController">AIController</a>. We keep it there by default.</dd>
<dt>(None) int GroundSpeed&#160;</dt>
<dd>Pawn default value is 440. Our default value will be 100.</dd>
<dt>(None) int Health&#160;</dt>
<dd>Pawn default value is 100. We keep it there by default, but will be modifying it in game.</dd>
<dt>(None) bool bReplicateAnimations&#160;</dt>
<dd>Pawn default is false. Our default value will be true. For use with SimAnim struct.</dd>
<dt>(None) SimAnims&#160;</dt>
<dd>This struct is used for Animation Replication. Includes AnimSequence, bAnimLoop, etc.</dd>
<dt>(None) bool bTearOff&#160;</dt>
<dd>This property is used to make the Client the owner of the actor, making it "TornOff" and no longer replicated to new Clients. We will use this during Death only.</dd>
<dt>(Sound) bool bFullVolume&#160;</dt>
<dd>Pawn default is false. Our default value will be true.</dd>
<dt>(Sound) int SoundRadius&#160;</dt>
<dd>Pawn default is 160. Our default value will be 512.</dd>
</dl>
<p><a name="Pawn_Default_Methods" id="Pawn_Default_Methods"></a></p>
<h4><span class="mw-headline">Pawn Default Methods</span></h4>
<dl>
<dt>bool PlayAnim( name Sequence, optional float Rate, optional float TweenTime, optional int Channel )&#160;</dt>
<dd>This function is originally defined in Actor. It will allow an Anim Sequence to play.</dd>
<dt>bool LoopAnim( name Sequence, optional float Rate, optional float TweenTime, optional int Channel )&#160;</dt>
<dd>This function is originally defined in Actor. It will allow an Anim Sequence to loop.</dd>
<dt>StopAnimating()&#160;</dt>
<dd>This function is originally defined in Actor.</dd>
<dt>PlaySound( Sound Sound, optional ESoundSlot Slot, optional float Volume, optional bool bNoOverride, optional float Radius, optional float Pitch, optional bool Attenuate )&#160;</dt>
<dd>This function is originally defined in Actor. It will allow a Sound to play.</dd>
<dt>SetPhysics( EPhysics newPhysics )&#160;</dt>
<dd>This function is originally defined in Actor. We will use it when in a Dying state.</dd>
<dt>SetCollision( optional bool NewColActors, optional bool NewBlockActors, optional bool NewBlockPlayers )&#160;</dt>
<dd>This function is originally defined in Actor. We will use it when in a Dying state.</dd>
<dt>bool PlayerCanSeeMe()&#160;</dt>
<dd>This function is originally defined in Actor. It returns true when a player has a line of sight to this Actor. We will use it when in a Dying state.</dd>
<dt>AnimEnd( int Channel )&#160;</dt>
<dd>This event is originally defined in Actor. It is called when the current animation sequence has played through. This will allow us to switch from action to action at an appropriate time.</dd>
<dt>Landed( vector HitNormal )&#160;</dt>
<dd>This event is originally defined in Actor. It is called when the Actor has landed on a Base after falling.</dd>
<dt>TornOff()&#160;</dt>
<dd>This event is a signal that this actor is no longer being replicated to new Clients and is now set to <tt>Role == ROLE_Authority</tt> on the Clients. We will use this for removal of a dead NaliCow on Clients.</dd>
</dl>
<p><a name="AIController_Properties" id="AIController_Properties"></a></p>
<h4><span class="mw-headline">AIController Properties</span></h4>
<dl>
<dt>(None) Actor MoveTarget&#160;</dt>
<dd>Originally defined in Controller, this is the Actor to move toward.</dd>
<dt>(None) vector Destination&#160;</dt>
<dd>Originally defined in Controller, this is the vector (Location) to move toward. We will use this to set desired location.</dd>
<dt>(None) vector FocalPoint&#160;</dt>
<dd>Originally defined in Controller, this is the vector to look toward. We will use this to set desired rotation.</dd>
<dt>(None) Actor Focus</dt>
<dd>Originally defined in Controller, this is the Actor to look toward.</dd>
</dl>
<p><a name="Final_Source_Code" id="Final_Source_Code"></a></p>
<h4><span class="mw-headline">Final Source Code</span></h4>
<p>The following is the AI Source Code for a NaliCow NPC, using all the available animations and sounds to convey believable behavior.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="co1">//=============================================================================</span>
<span class="co1">// NaliCow.</span>
<span class="co1">// NaliCow Non-Player Character for UT2004.</span>
<span class="co1">// by SuperApe -- Dec 2005</span>
<span class="co1">// ( Based on Mesh animations and sounds from Epic Games )</span>
<span class="co1">//=============================================================================</span>
<span class="kw5">class</span> NaliCow <span class="kw5">extends</span> <a href="/Pawn"><span class="kw10">Pawn</span></a>
    <span class="kw6">placeable</span>;
 
<span class="kw5">var</span>     <a href="/Actor"><span class="kw10">Actor</span></a>       HurtingActor;   <span class="co1">// An Actor to get away from.</span>
<span class="kw5">var</span>     <span class="kw4">vector</span>      OldLocation;    <span class="co1">// Used to determine if stuck.</span>
<span class="kw5">var</span>            <span class="kw4">int</span>                    DamageTaken;    <span class="co1">// Most recent damage amount.</span>
<span class="kw5">var</span>            <span class="kw4">bool</span>           bStartled;              <span class="co1">// Recently startled.</span>
 
<span class="co1">// PostBeginPlay() is originally defined in Actor().</span>
<span class="co1">// We will use it to make sure an AIController is spawned for our NaliCow.</span>
<span class="kw5">event</span> PostBeginPlay<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw6">Super</span>.<span class="me1">PostBeginPlay</span><span class="br0">(</span><span class="br0">)</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> <span class="br0">(</span> ControllerClass != <span class="kw9">None</span> <span class="br0">)</span> &amp;&amp; <span class="br0">(</span> Controller == <span class="kw9">None</span> <span class="br0">)</span> <span class="br0">)</span>
                Controller = spawn<span class="br0">(</span> ControllerClass <span class="br0">)</span>;
        <span class="kw1">if</span> <span class="br0">(</span> Controller != <span class="kw9">None</span> <span class="br0">)</span>
                Controller.<span class="me1">Possess</span><span class="br0">(</span> <span class="kw8">self</span> <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// DisplayBehavior() takes a BehaviorIndex value and sets the appropriate animation and sound.</span>
<span class="co1">// Degrees of behavior will be taken into account via an optional arguement.</span>
<span class="kw5">function</span> DisplayBehavior<span class="br0">(</span> <span class="kw4">int</span> BehaviorIndex, <span class="kw6">optional</span> <span class="kw4">int</span> Degree <span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">switch</span><span class="br0">(</span> BehaviorIndex <span class="br0">)</span> <span class="br0">{</span>
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span> :
            Acting<span class="br0">(</span> <span class="st0">'Breath'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.ambCow'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span> : 
            Acting<span class="br0">(</span> <span class="st0">'root'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.munch1p'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span> : 
            Acting<span class="br0">(</span> <span class="st0">'Chew'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.munch1p'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span> : 
            <span class="kw1">if</span> <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0.5</span> <span class="br0">)</span>
                Acting<span class="br0">(</span> <span class="st0">'Poop'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.cMoo1c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">else</span>
                Acting<span class="br0">(</span> <span class="st0">'Poop'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.cMoo2c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">5</span><span class="br0">)</span> : 
            Acting<span class="br0">(</span> <span class="st0">'Shake'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.shakeC'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">6</span><span class="br0">)</span> : 
            Acting<span class="br0">(</span> <span class="st0">'Swish'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.swishC'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">7</span><span class="br0">)</span> : 
            Acting<span class="br0">(</span> <span class="st0">'Walk'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.WalkC'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">8</span><span class="br0">)</span> : 
            Acting<span class="br0">(</span> <span class="st0">'Run'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.WalkC'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">9</span><span class="br0">)</span> : 
            Acting<span class="br0">(</span> <span class="st0">'Landed'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.Thump'</span>, <span class="kw9">false</span> <span class="br0">)</span>; <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">10</span><span class="br0">)</span> : 
            <span class="kw1">if</span> <span class="br0">(</span> Degree &lt; <span class="nu0">2</span> <span class="br0">)</span>
                Acting<span class="br0">(</span> <span class="st0">'TakeHit'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.cMoo1c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span> Degree == <span class="nu0">2</span> <span class="br0">)</span>
                Acting<span class="br0">(</span> <span class="st0">'TakeHit2'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.injurC1c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span> Degree == <span class="nu0">3</span> <span class="br0">)</span>
                Acting<span class="br0">(</span> <span class="st0">'BigHit'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.injurC2c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">break</span>;
        <span class="kw1">case</span><span class="br0">(</span><span class="nu0">11</span><span class="br0">)</span> : 
            <span class="kw1">if</span> <span class="br0">(</span> Degree &lt; <span class="nu0">2</span> <span class="br0">)</span>
                Acting<span class="br0">(</span> <span class="st0">'Dead'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.cMoo2c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span> Degree == <span class="nu0">2</span> <span class="br0">)</span>
                Acting<span class="br0">(</span> <span class="st0">'Dead2'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.DeathC1c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span> Degree == <span class="nu0">3</span> <span class="br0">)</span>
                Acting<span class="br0">(</span> <span class="st0">'Dead3'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.DeathC2c'</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            <span class="kw1">break</span>;
        <span class="kw1">default</span> : 
            Acting<span class="br0">(</span> <span class="st0">'Breath'</span>, <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.ambCow'</span>, <span class="kw9">true</span> <span class="br0">)</span>; <span class="kw1">break</span>;
     <span class="br0">}</span>
<span class="br0">}</span>
 
<span class="co1">// Acting() loops the given animation sequence name and plays the given sound.</span>
<span class="co1">// For Replication purposes, animation is normally looped.  Sequences may be interupted each AnimEnd().</span>
<span class="kw5">function</span> Acting<span class="br0">(</span> <span class="kw4">name</span> Anim, <a href="/sound"><span class="kw10">sound</span></a> Soundname, <span class="kw4">bool</span> bLoop <span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">if</span> <span class="br0">(</span> bLoop <span class="br0">)</span>
        LoopAnim<span class="br0">(</span> Anim, <span class="nu0">1.0</span>, <span class="nu0">0.1</span> <span class="br0">)</span>;
    <span class="kw1">else</span>
                PlayAnim<span class="br0">(</span> Anim, <span class="nu0">1.0</span>, <span class="nu0">0.1</span> <span class="br0">)</span>;
    SimAnim.<span class="me1">AnimSequence</span> = Anim;
    SimAnim.<span class="me1">AnimRate</span> = <span class="nu0">1.0</span>;
    <span class="kw1">if</span> <span class="br0">(</span> bLoop <span class="br0">)</span>
        SimAnim.<span class="me1">bAnimLoop</span> = <span class="kw9">true</span>;
    <span class="kw1">else</span>
        SimAnim.<span class="me1">bAnimLoop</span> = <span class="kw9">false</span>;
    SimAnim.<span class="me1">TweenRate</span> = <span class="nu0">0.1</span>;
    PlaySound<span class="br0">(</span> Soundname, SLOT_Misc <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// MoveCheck() deals with periodic checks for bStartled, DamageTaken and falling.</span>
<span class="co1">// Then moves the character in direction of Rotation and at speed of SpeedRatio.</span>
<span class="kw5">function</span> MoveCheck<span class="br0">(</span> <span class="kw4">float</span> SpeedRatio <span class="br0">)</span>
<span class="br0">{</span>
        DamageTaken = <span class="nu0">0</span>;  <span class="co1">// Reset most recent damage memory.</span>
 
        <span class="kw1">if</span> <span class="br0">(</span> Base == <span class="kw9">None</span> <span class="br0">)</span>  <span class="co1">// Should be falling.</span>
        <span class="br0">{</span>
                <span class="kw1">if</span> <span class="br0">(</span> Physics != PHYS_Falling <span class="br0">)</span>
                        SetPhysics<span class="br0">(</span> PHYS_Falling <span class="br0">)</span>;
                <span class="kw1">return</span>;
        <span class="br0">}</span>
 
        <span class="kw1">if</span> <span class="br0">(</span> Controller.<span class="me1">MoveTarget</span> == <span class="kw9">None</span> <span class="br0">)</span>
                ReachedDestination<span class="br0">(</span> <span class="kw8">self</span> <span class="br0">)</span>;
 
    <span class="kw1">if</span> <span class="br0">(</span> VSize<span class="br0">(</span> Controller.<span class="me1">MoveTarget</span>.<span class="me1">Location</span> - Location <span class="br0">)</span> &lt; <span class="nu0">64</span> <span class="br0">)</span>
            ReachedDestination<span class="br0">(</span> Controller.<span class="me1">MoveTarget</span> <span class="br0">)</span>;
 
    <span class="kw1">if</span> <span class="br0">(</span> VSize<span class="br0">(</span> OldLocation - Location <span class="br0">)</span> &lt; <span class="nu0">48</span> <span class="br0">)</span>
            ReachedDestination<span class="br0">(</span> Controller.<span class="me1">MoveTarget</span> <span class="br0">)</span>;
 
    OldLocation = Location;
 
    RotationRate.<span class="me1">Yaw</span> = SpeedRatio * <span class="nu0">20000</span>;
        Velocity = <span class="br0">(</span> SpeedRatio * GroundSpeed <span class="br0">)</span> * <span class="kw4">vector</span><span class="br0">(</span> Rotation <span class="br0">)</span>;
    Acceleration = Velocity;
 
        <span class="kw1">if</span> <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0.95</span> <span class="br0">)</span>  <span class="co1">// Chance to calm down.</span>
                bStartled = <span class="kw9">false</span>;
        <span class="kw1">if</span> <span class="br0">(</span> bStartled &amp;&amp; !<span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span> <span class="br0">)</span>
                <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span>;  <span class="co1">// React to startle.   </span>
<span class="br0">}</span>
 
<span class="co1">// ReachedDestination() is originally defined in Pawn.</span>
<span class="co1">// MoveTarget and other relevant properties are defined in Controller.</span>
<span class="kw5">function</span> <span class="kw4">bool</span> ReachedDestination<span class="br0">(</span> <a href="/Actor"><span class="kw10">Actor</span></a> OldTarget <span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw5">local</span>   <a href="/Actor"><span class="kw10">Actor</span></a>   NewTarget, A;
    <span class="kw5">local</span>   NavigationPoint    NP;
 
    <span class="kw1">forEach</span> VisibleActors<span class="br0">(</span> <span class="kw5">class</span><span class="st0">'Actor'</span>, A <span class="br0">)</span>
        <span class="kw1">if</span> <span class="br0">(</span> A != OldTarget &amp;&amp; A != HurtingActor <span class="br0">)</span>
            NewTarget = A;
 
    <span class="kw1">if</span> <span class="br0">(</span> A == <span class="kw9">None</span> <span class="br0">)</span>
        <span class="kw1">forEach</span> RadiusActors<span class="br0">(</span> <span class="kw5">class</span><span class="st0">'NavigationPoint'</span>, NP, <span class="nu0">1024</span> <span class="br0">)</span>
            <span class="kw1">if</span> <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0.5</span> &amp;&amp; NP != OldTarget &amp;&amp; FastTrace<span class="br0">(</span> NP.<span class="me1">Location</span> <span class="br0">)</span> <span class="br0">)</span>
            <span class="br0">{</span>
                A = NP;
                NewTarget = A;
            <span class="br0">}</span>
 
    <span class="kw1">if</span> <span class="br0">(</span> A == <span class="kw9">None</span> <span class="br0">)</span>
        <span class="kw1">forEach</span> AllActors<span class="br0">(</span> <span class="kw5">class</span><span class="st0">'Actor'</span>, A <span class="br0">)</span>
            <span class="kw1">if</span> <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0.5</span> &amp;&amp; A != HurtingActor &amp;&amp; A != OldTarget &amp;&amp; A != <span class="kw8">self</span> &amp;&amp; !A.<span class="kw7">IsA</span><span class="br0">(</span><span class="st0">'Controller'</span><span class="br0">)</span> <span class="br0">)</span>
                NewTarget = A;
 
    <span class="kw1">if</span> <span class="br0">(</span> NewTarget != <span class="kw9">None</span> <span class="br0">)</span>
    <span class="br0">{</span>
        Controller.<span class="me1">MoveTarget</span> = NewTarget;
        Controller.<span class="me1">Destination</span> = NewTarget.<span class="me1">Location</span>;
        Controller.<span class="me1">FocalPoint</span> = NewTarget.<span class="me1">Location</span>;
        Controller.<span class="me1">Focus</span> = NewTarget;
    <span class="br0">}</span>
    <span class="kw1">else</span>
    <span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span> HurtingActor != <span class="kw9">None</span> <span class="br0">)</span>
        <span class="br0">{</span>
            Controller.<span class="me1">Destination</span> = <span class="br0">(</span> Location - HurtingActor.<span class="me1">Location</span> <span class="br0">)</span>;
            Controller.<span class="me1">FocalPoint</span> = Controller.<span class="me1">Destination</span>;
        <span class="br0">}</span>
        <span class="kw1">else</span>
        <span class="br0">{</span>
            Controller.<span class="me1">Destination</span> = <span class="kw4">vector</span><span class="br0">(</span> Rotation <span class="br0">)</span> * <span class="br0">(</span> <span class="nu0">512</span> * <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> + <span class="nu0">512</span> <span class="br0">)</span>;
            Controller.<span class="me1">FocalPoint</span> = Controller.<span class="me1">Destination</span>;
        <span class="br0">}</span>
    <span class="br0">}</span>
<span class="br0">}</span>
 
<span class="co1">// Trigger() is originally defined in Actor.</span>
<span class="kw5">function</span> Trigger<span class="br0">(</span> <a href="/Actor"><span class="kw10">Actor</span></a> Other, <a href="/Pawn"><span class="kw10">Pawn</span></a> EventInstigator <span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span> <span class="br0">)</span>
        <span class="kw1">return</span>;
        <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span> <span class="br0">)</span>
        <span class="br0">{</span>
                <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span>;
                <span class="kw1">return</span>;
        <span class="br0">}</span>
        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// Touch() is originally defined in Actor.</span>
<span class="kw5">function</span> Touch<span class="br0">(</span> <a href="/Actor"><span class="kw10">Actor</span></a> Other <span class="br0">)</span>
<span class="br0">{</span>
    HurtingActor = Other;
    <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span> <span class="br0">)</span>
        <span class="kw1">return</span>;
        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// Bump() is originally defined in Actor.</span>
<span class="kw5">function</span> Bump<span class="br0">(</span> <a href="/Actor"><span class="kw10">Actor</span></a> Other <span class="br0">)</span>
<span class="br0">{</span>
    HurtingActor = Other;
    <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span> &amp;&amp; <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &lt; <span class="nu0">0.9</span> <span class="br0">)</span> <span class="br0">)</span>  <span class="co1">// Chance to calm.</span>
        <span class="kw1">return</span>;
        <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span> &amp;&amp; <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0.9</span> <span class="br0">)</span> <span class="br0">)</span>  <span class="co1">// Change due to startle.</span>
        <span class="br0">{</span>
                <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span>;
                <span class="kw1">return</span>;
        <span class="br0">}</span>
        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// Landed() is originally defined in Actor.</span>
<span class="kw5">event</span> Landed<span class="br0">(</span> <span class="kw4">vector</span> HitNormal <span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw6">Super</span>.<span class="me1">Landed</span><span class="br0">(</span> HitNormal <span class="br0">)</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> Velocity.<span class="me1">Z</span> &gt; <span class="nu0">-200</span> <span class="br0">)</span>  <span class="co1">// Slow enough fall to forgive landing.</span>
                <span class="kw1">return</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> DamageTaken == <span class="nu0">0</span> <span class="br0">)</span>
                <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Land'</span><span class="br0">)</span>;
        <span class="kw1">else</span>
                <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'TakeHit'</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// TakeDamage() is originally defined in Actor.</span>
<span class="kw5">function</span> TakeDamage<span class="br0">(</span><span class="kw4">int</span> Damage, <a href="/Pawn"><span class="kw10">Pawn</span></a> InstigatedBy, <span class="kw4">Vector</span> HitLocation, <span class="kw4">Vector</span> Momentum, class&lt;DamageType&gt; <a href="/DamageType"><span class="kw10">DamageType</span></a><span class="br0">)</span>
<span class="br0">{</span>
    HurtingActor = InstigatedBy;
        DamageTaken = Damage;
        bStartled = <span class="kw9">true</span>;
 
    <span class="kw6">Super</span>.<span class="me1">TakeDamage</span><span class="br0">(</span> Damage, InstigatedBy, HitLocation, Momentum, <a href="/DamageType"><span class="kw10">DamageType</span></a> <span class="br0">)</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> DamageTaken &gt; <span class="nu0">3</span> <span class="br0">)</span>
            spawn<span class="br0">(</span> <span class="kw5">class</span><span class="st0">'STR_green_blood_puff'</span>,,, HitLocation, <span class="kw4">Rotator</span><span class="br0">(</span> Momentum <span class="br0">)</span> <span class="br0">)</span>;
 
    <span class="kw1">if</span> <span class="br0">(</span> Controller != <span class="kw9">None</span> &amp;&amp; <span class="br0">(</span> Controller.<span class="me1">MoveTarget</span> == HurtingActor || Controller.<span class="me1">Focus</span> == HurtingActor <span class="br0">)</span> <span class="br0">)</span>
                ReachedDestination<span class="br0">(</span> HurtingActor <span class="br0">)</span>;  <span class="co1">// Do not approach HurtingActor.</span>
 
    <span class="kw1">if</span> <span class="br0">(</span> Health &gt; <span class="nu0">0</span> <span class="br0">)</span>
        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'TakeHit'</span><span class="br0">)</span>;
    <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span> !<span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Dying'</span><span class="br0">)</span> <span class="br0">)</span>
        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Dying'</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// Died() is originally defined in Pawn.</span>
<span class="kw5">function</span> Died<span class="br0">(</span> Controller Killer, class&lt;DamageType&gt; <a href="/DamageType"><span class="kw10">DamageType</span></a>, <span class="kw4">vector</span> HitLocation <span class="br0">)</span>
<span class="br0">{</span>
        TakeDamage<span class="br0">(</span> Health, <span class="kw9">None</span>, Location, <span class="kw4">vect</span><span class="br0">(</span><span class="nu0">0</span>,<span class="nu0">0</span>,<span class="nu0">-1</span><span class="br0">)</span>, <span class="kw5">class</span><span class="st0">'Crushed'</span> <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// TornOff() is originally defined in Actor.</span>
<span class="kw5">event</span> TornOff<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">if</span> <span class="br0">(</span> PlayerCanSeeMe<span class="br0">(</span><span class="br0">)</span> <span class="br0">)</span>
        DeRez<span class="br0">(</span><span class="br0">)</span>;
    <span class="kw1">else</span>
        Destroy<span class="br0">(</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// DeRez() will signal removal of the dead NaliCow.</span>
<span class="kw6">simulated</span> <span class="kw5">function</span> DeRez<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">Level</span>.<span class="kw8">NetMode</span> == <span class="kw9">NM_DedicatedServer</span> <span class="br0">)</span>
        <span class="kw1">return</span>;
 
    Skins.<span class="kw6">length</span> = <span class="nu0">0</span>;
    Skins<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> = <a href="/Material"><span class="kw10">Material</span></a><span class="st0">'DeRez.Shaders.DeRezFinalBody'</span>;  
<span class="br0">}</span>
 
<span class="kw6">auto</span> <span class="kw5">state</span><span class="br0">(</span><span class="br0">)</span> Prone
<span class="br0">{</span>
    <span class="kw5">event</span> AnimEnd<span class="br0">(</span> <span class="kw4">int</span> Channel <span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw5">local</span>   <span class="kw4">int</span>     X;
 
        X = <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> * <span class="nu0">20</span>;
        <span class="kw1">switch</span> <span class="br0">(</span> X <span class="br0">)</span> <span class="br0">{</span>
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Turn'</span><span class="br0">)</span>;        <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Graze'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Poop'</span><span class="br0">)</span>;        <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Shake'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Swish'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">5</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span>;        <span class="kw1">break</span>;
            <span class="kw1">default</span> : DisplayBehavior<span class="br0">(</span> <span class="nu0">1</span> <span class="br0">)</span>;     <span class="kw1">break</span>;
        <span class="br0">}</span>
    <span class="br0">}</span>
 
    Begin:
        DisplayBehavior<span class="br0">(</span> <span class="nu0">1</span> <span class="br0">)</span>;
                MoveCheck<span class="br0">(</span> <span class="nu0">0.0</span> <span class="br0">)</span>;
        <span class="kw1">if</span> <span class="br0">(</span> HurtingActor != <span class="kw9">None</span> <span class="br0">)</span>
            <span class="kw1">if</span> <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0.95</span> <span class="br0">)</span>  <span class="co1">// Chance to forgive HurtingActor.</span>
                HurtingActor = <span class="kw9">None</span>;
<span class="br0">}</span>
 
<span class="kw5">state</span><span class="br0">(</span><span class="br0">)</span> Turn
<span class="br0">{</span>
    <span class="kw5">event</span> AnimEnd<span class="br0">(</span> <span class="kw4">int</span> Channel <span class="br0">)</span>
    <span class="br0">{</span>
        RotationRate.<span class="me1">Yaw</span> = <span class="nu0">0</span>;
        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Prone'</span><span class="br0">)</span>;
    <span class="br0">}</span>
 
    Begin:
                MoveCheck<span class="br0">(</span> <span class="nu0">0.0</span> <span class="br0">)</span>;
        <span class="kw1">if</span> <span class="br0">(</span> DesiredRotation != Rotation <span class="br0">)</span>
        <span class="br0">{</span>
            RotationRate.<span class="me1">Yaw</span> = <span class="nu0">10000</span>;
            DisplayBehavior<span class="br0">(</span> <span class="nu0">7</span> <span class="br0">)</span>;
        <span class="br0">}</span>
        <span class="kw1">else</span>
            <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Prone'</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw5">state</span><span class="br0">(</span><span class="br0">)</span> Graze
<span class="br0">{</span>
    <span class="kw5">event</span> AnimEnd<span class="br0">(</span> <span class="kw4">int</span> Channel <span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Chew'</span><span class="br0">)</span>;
    <span class="br0">}</span>
 
    Begin:
        DisplayBehavior<span class="br0">(</span> <span class="nu0">2</span> <span class="br0">)</span>;
                MoveCheck<span class="br0">(</span> <span class="nu0">0.0</span> <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw5">state</span><span class="br0">(</span><span class="br0">)</span> Chew
<span class="br0">{</span>
    <span class="kw5">event</span> AnimEnd<span class="br0">(</span> <span class="kw4">int</span> Channel <span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw5">local</span>   <span class="kw4">int</span>     X;
 
        X = <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> * <span class="nu0">15</span>;
        <span class="kw1">switch</span> <span class="br0">(</span> X <span class="br0">)</span> <span class="br0">{</span>
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Prone'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Graze'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Poop'</span><span class="br0">)</span>;        <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Shake'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Swish'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">5</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span>;        <span class="kw1">break</span>;
            <span class="kw1">default</span> : DisplayBehavior<span class="br0">(</span> <span class="nu0">3</span> <span class="br0">)</span>;     <span class="kw1">break</span>;
        <span class="br0">}</span>
    <span class="br0">}</span>
 
    Begin:
        DisplayBehavior<span class="br0">(</span> <span class="nu0">3</span> <span class="br0">)</span>;
                MoveCheck<span class="br0">(</span> <span class="nu0">0.0</span> <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw5">state</span> Poop
<span class="br0">{</span>
    <span class="kw5">function</span> Timer<span class="br0">(</span><span class="br0">)</span>
    <span class="br0">{</span>
        spawn<span class="br0">(</span> <span class="kw5">class</span><span class="st0">'NaliCowPoop'</span>,, <span class="st0">'Poop'</span>, <span class="br0">(</span> Location + <span class="br0">(</span> <span class="kw4">vector</span><span class="br0">(</span>Rotation<span class="br0">)</span> * <span class="nu0">-24</span> <span class="br0">)</span> <span class="br0">)</span>, <span class="kw4">rotator</span><span class="br0">(</span> <span class="kw4">vect</span><span class="br0">(</span><span class="nu0">0</span>,<span class="nu0">0</span>,<span class="nu0">-1</span><span class="br0">)</span> <span class="br0">)</span> <span class="br0">)</span>;
    <span class="br0">}</span>
 
    <span class="kw5">event</span> AnimEnd<span class="br0">(</span> <span class="kw4">int</span> Channel <span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw5">local</span>   <span class="kw4">int</span>     X;
 
        X = <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> * <span class="nu0">20</span>;
        <span class="kw1">switch</span> <span class="br0">(</span> X <span class="br0">)</span> <span class="br0">{</span>
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Graze'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Shake'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Swish'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span>;        <span class="kw1">break</span>;
            <span class="kw1">default</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Prone'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
        <span class="br0">}</span>
    <span class="br0">}</span>
 
    Begin:
        DisplayBehavior<span class="br0">(</span> <span class="nu0">4</span> <span class="br0">)</span>;
                MoveCheck<span class="br0">(</span> <span class="nu0">0.0</span> <span class="br0">)</span>;
        SetTimer<span class="br0">(</span> <span class="nu0">1.0</span>, <span class="kw9">false</span> <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw5">state</span><span class="br0">(</span><span class="br0">)</span> Shake
<span class="br0">{</span>
    <span class="kw5">event</span> AnimEnd<span class="br0">(</span> <span class="kw4">int</span> Channel <span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw5">local</span>   <span class="kw4">int</span>     X;
 
        X = <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> * <span class="nu0">20</span>;
        <span class="kw1">switch</span> <span class="br0">(</span> X <span class="br0">)</span> <span class="br0">{</span>
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Graze'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Poop'</span><span class="br0">)</span>;        <span class="kw1">break</span>;
 
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span> : DisplayBehavior<span class="br0">(</span> <span class="nu0">5</span> <span class="br0">)</span>;     <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Swish'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span>;        <span class="kw1">break</span>;
            <span class="kw1">default</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Prone'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
        <span class="br0">}</span>
    <span class="br0">}</span>
 
    Begin:
        DisplayBehavior<span class="br0">(</span> <span class="nu0">5</span> <span class="br0">)</span>;
                MoveCheck<span class="br0">(</span> <span class="nu0">0.0</span> <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw5">state</span> Swish
<span class="br0">{</span>
    <span class="kw5">event</span> AnimEnd<span class="br0">(</span> <span class="kw4">int</span> Channel <span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw5">local</span>   <span class="kw4">int</span>     X;
 
        X = <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> * <span class="nu0">20</span>;
        <span class="kw1">switch</span> <span class="br0">(</span> X <span class="br0">)</span> <span class="br0">{</span>
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Graze'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Poop'</span><span class="br0">)</span>;        <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Shake'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span> : DisplayBehavior<span class="br0">(</span> <span class="nu0">6</span> <span class="br0">)</span>;     <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span>;        <span class="kw1">break</span>;
            <span class="kw1">default</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Prone'</span><span class="br0">)</span>;       <span class="kw1">break</span>;
        <span class="br0">}</span>
    <span class="br0">}</span>
 
    Begin:
        DisplayBehavior<span class="br0">(</span> <span class="nu0">6</span> <span class="br0">)</span>;
                MoveCheck<span class="br0">(</span> <span class="nu0">0.0</span> <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw5">state</span> Walk
<span class="br0">{</span>
    <span class="kw5">function</span> <span class="kw8">Tick</span><span class="br0">(</span> <span class="kw4">float</span> DeltaTime <span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span> Physics == PHYS_Walking &amp;&amp; DamageTaken == <span class="nu0">0</span> <span class="br0">)</span>
        <span class="br0">{</span>
            Velocity = <span class="br0">(</span> <span class="nu0">0.5</span> * GroundSpeed <span class="br0">)</span> * <span class="kw4">vector</span><span class="br0">(</span> Rotation <span class="br0">)</span>;
            Acceleration = Velocity;
        <span class="br0">}</span>
    <span class="br0">}</span>
 
    <span class="kw5">event</span> AnimEnd<span class="br0">(</span> <span class="kw4">int</span> Channel <span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw5">local</span>   <span class="kw4">int</span>     X;
 
        X = <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> * <span class="nu0">20</span>;
        <span class="kw1">switch</span> <span class="br0">(</span> X <span class="br0">)</span> <span class="br0">{</span>
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Prone'</span><span class="br0">)</span>;                                                  <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Turn'</span><span class="br0">)</span>;                                                   <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Graze'</span><span class="br0">)</span>;                                                  <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Poop'</span><span class="br0">)</span>;                                                   <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Shake'</span><span class="br0">)</span>;                                                  <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Swish'</span><span class="br0">)</span>;                                                  <span class="kw1">break</span>;
            <span class="kw1">default</span> : DisplayBehavior<span class="br0">(</span> <span class="nu0">7</span> <span class="br0">)</span>; MoveCheck<span class="br0">(</span> <span class="nu0">0.5</span> <span class="br0">)</span>;               <span class="kw1">break</span>;
        <span class="br0">}</span>
    <span class="br0">}</span>
 
    Begin:
        DisplayBehavior<span class="br0">(</span> <span class="nu0">7</span> <span class="br0">)</span>;
                MoveCheck<span class="br0">(</span> <span class="nu0">0.5</span> <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw5">state</span> Run
<span class="br0">{</span>
    <span class="kw5">function</span> <span class="kw8">Tick</span><span class="br0">(</span> <span class="kw4">float</span> DeltaTime <span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span> Physics == PHYS_Walking &amp;&amp; DamageTaken == <span class="nu0">0</span> <span class="br0">)</span>
        <span class="br0">{</span>
            Velocity = <span class="br0">(</span> GroundSpeed <span class="br0">)</span> * <span class="kw4">vector</span><span class="br0">(</span> Rotation <span class="br0">)</span>;
            Acceleration = Velocity;
        <span class="br0">}</span>
    <span class="br0">}</span>
 
    <span class="kw5">event</span> AnimEnd<span class="br0">(</span> <span class="kw4">int</span> Channel <span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw5">local</span>   <span class="kw4">int</span>     X;
 
        X = <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> * <span class="nu0">10</span>;
        <span class="kw1">switch</span> <span class="br0">(</span> X <span class="br0">)</span> <span class="br0">{</span>
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span>;                                                   <span class="kw1">break</span>;
            <span class="kw1">default</span> : DisplayBehavior<span class="br0">(</span> <span class="nu0">8</span> <span class="br0">)</span>; MoveCheck<span class="br0">(</span> <span class="nu0">1.0</span> <span class="br0">)</span>;               <span class="kw1">break</span>;
        <span class="br0">}</span>
    <span class="br0">}</span>
 
    Begin:
        DisplayBehavior<span class="br0">(</span> <span class="nu0">8</span> <span class="br0">)</span>;
                MoveCheck<span class="br0">(</span> <span class="nu0">1.0</span> <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw5">state</span> Land
<span class="br0">{</span>
    <span class="kw5">function</span> Timer<span class="br0">(</span><span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw5">local</span>   <span class="kw4">int</span>     X;
 
                <span class="kw1">if</span> <span class="br0">(</span> bStartled <span class="br0">)</span>  <span class="co1">// Always run if startled.</span>
                <span class="br0">{</span>
                        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span>;
                        <span class="kw1">return</span>;
                <span class="br0">}</span>
 
        X = <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> * <span class="nu0">10</span>;
        <span class="kw1">switch</span> <span class="br0">(</span> X <span class="br0">)</span> <span class="br0">{</span>
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Prone'</span><span class="br0">)</span>;   <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Turn'</span><span class="br0">)</span>;    <span class="kw1">break</span>;
            <span class="kw1">case</span><span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Shake'</span><span class="br0">)</span>;   <span class="kw1">break</span>;
            <span class="kw1">default</span> : <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Walk'</span><span class="br0">)</span>;    <span class="kw1">break</span>;
        <span class="br0">}</span>
    <span class="br0">}</span>
 
    <span class="kw5">event</span> AnimEnd<span class="br0">(</span> <span class="kw4">int</span> Channel <span class="br0">)</span>
    <span class="br0">{</span>
        SetTimer<span class="br0">(</span> <span class="nu0">0.2</span>, <span class="kw9">false</span> <span class="br0">)</span>;
    <span class="br0">}</span>
 
    Begin:
        DisplayBehavior<span class="br0">(</span> <span class="nu0">9</span> <span class="br0">)</span>;
                MoveCheck<span class="br0">(</span> <span class="nu0">0.0</span> <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw5">state</span> TakeHit
<span class="br0">{</span>
    <span class="kw5">function</span> Timer<span class="br0">(</span><span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span>;
    <span class="br0">}</span>
 
    <span class="kw5">event</span> AnimEnd<span class="br0">(</span> <span class="kw4">int</span> Channel <span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span> Health &lt; <span class="nu0">1</span> <span class="br0">)</span>
            <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Dying'</span><span class="br0">)</span>;
        <span class="kw1">else</span>
            SetTimer<span class="br0">(</span> <span class="nu0">0.2</span>, <span class="kw9">false</span> <span class="br0">)</span>;
    <span class="br0">}</span>
 
    Begin:
        DisplayBehavior<span class="br0">(</span> <span class="nu0">10</span>, <span class="kw7">Min</span><span class="br0">(</span> <span class="br0">(</span> DamageTaken / <span class="nu0">15</span> <span class="br0">)</span>, <span class="nu0">3</span> <span class="br0">)</span> <span class="br0">)</span>;
        MoveCheck<span class="br0">(</span> <span class="nu0">0.0</span> <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw5">state</span> Dying
<span class="br0">{</span>
    <span class="kw6">Ignores</span> Trigger, Touch, Bump, Landed, Died;
 
    <span class="kw5">function</span> Timer<span class="br0">(</span><span class="br0">)</span>
    <span class="br0">{</span>
        SetPhysics<span class="br0">(</span> PHYS_None <span class="br0">)</span>;
        SetCollision<span class="br0">(</span> <span class="kw9">false</span>, <span class="kw9">false</span> <span class="br0">)</span>;
        Lifespan = <span class="nu0">3.0</span>;
        <span class="kw1">if</span> <span class="br0">(</span> PlayerCanSeeMe<span class="br0">(</span><span class="br0">)</span> <span class="br0">)</span>
            DeRez<span class="br0">(</span><span class="br0">)</span>;
        <span class="kw1">else</span>
            Destroy<span class="br0">(</span><span class="br0">)</span>;
    <span class="br0">}</span>
 
    <span class="kw5">event</span> AnimEnd<span class="br0">(</span> <span class="kw4">int</span> Channel <span class="br0">)</span>
    <span class="br0">{</span>
        SetTimer<span class="br0">(</span> <span class="nu0">4.0</span>, <span class="kw9">false</span> <span class="br0">)</span>;
    <span class="br0">}</span>
 
    Begin:
        StopAnimating<span class="br0">(</span><span class="br0">)</span>;
        DisplayBehavior<span class="br0">(</span> <span class="nu0">11</span>, <span class="kw7">Min</span><span class="br0">(</span> <span class="br0">(</span> DamageTaken / <span class="nu0">20</span> <span class="br0">)</span>, <span class="nu0">3</span> <span class="br0">)</span> <span class="br0">)</span>;
        MoveCheck<span class="br0">(</span> <span class="nu0">0.0</span> <span class="br0">)</span>;
        <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">Level</span>.<span class="kw8">NetMode</span> == <span class="kw9">NM_DedicatedServer</span> <span class="br0">)</span>
        <span class="br0">{</span>
            SetPhysics<span class="br0">(</span> PHYS_None <span class="br0">)</span>;
            SetCollision<span class="br0">(</span> <span class="kw9">false</span>, <span class="kw9">false</span> <span class="br0">)</span>;
            LifeSpan = <span class="nu0">3.0</span>;
            bTearOff = <span class="kw9">true</span>;
        <span class="br0">}</span>
<span class="br0">}</span>
 
<span class="kw1">defaultProperties</span> 
<span class="br0">{</span>
    CollisionHeight=<span class="nu0">34</span>
    SurfaceType=EST_Flesh
    Mesh=VertMesh<span class="st0">'SkaarjPack_rc.NaliCow'</span>
    Physics=PHYS_Walking
    GroundSpeed=<span class="nu0">100</span>
    bReplicateAnimations=<span class="kw9">true</span>
    bFullVolume=<span class="kw9">true</span>
    SoundRadius=<span class="nu0">512</span>
<span class="br0">}</span>
</pre></div>
<p><a name="NaliCowPoop" id="NaliCowPoop"></a></p>
<h3><span class="mw-headline">NaliCowPoop</span></h3>
<p>An obvious Projectile to use for this NaliCowPoop Actor is the BioRifle's Projectile, BioGlob. It uses a Mesh that automatically drips, jiggles and splats like our desired NaliCowPoop should. We will need to make a custom subclass of BioGlob, change its Texture, Lighting and alter some of it's default code to prevent it from causing Damage.</p>
<p><a name="BioGlob_Default_Properties" id="BioGlob_Default_Properties"></a></p>
<h4><span class="mw-headline">BioGlob Default Properties</span></h4>
<dl>
<dt>(Display) Skins&#160;</dt>
<dd>It's default Skins are set for BioRifle ammo. We will set it to <tt>Texture'XEffectMat.goop.SlimeSkin'</tt>.</dd>
<dt>(Movement) vector Velocity&#160;</dt>
<dd>The BioGlob starts with a lot of velocity by default, we will set it to vect(0,0,0) during PostBeginPlay().</dd>
<dt>(Lighting) int AmbientGlow&#160;</dt>
<dd>BioGlobs have an AmbientGlow by default. We will set this to zero.</dd>
<dt>(Lighting) bool bUnlit&#160;</dt>
<dd>BioGlobs are unlit by default. We will set this to false.</dd>
<dt>(Lighting) bool bDynamicLight&#160;</dt>
<dd>BioGlobs glow by default. We will set this to false.</dd>
<dt>(Lighting) LightType&#160;</dt>
<dd>We will set this to LT_None.</dd>
<dt>float RestTime&#160;</dt>
<dd>This property is originally defined in BioGlob. It determines how long the BioGlob sits before it calls BlowUp(). We will set this value to 10.0.</dd>
<dt>int BaseDamage&#160;</dt>
<dd>This property is originally defined in BioGlob. We will make sure this doesn't cause damage by setting it to 0.</dd>
</dl>
<p><a name="BioGlob_Default_Methods" id="BioGlob_Default_Methods"></a></p>
<h4><span class="mw-headline">BioGlob Default Methods</span></h4>
<dl>
<dt>BlowUp( vector HitLocation )&#160;</dt>
<dd>This function is originally defined in BioGlob. We will modify it to not cause damage and instead switch to a Shriveling state, which shrinks the BioGlob and "pops" it.</dd>
</dl>
<p><a name="Final_Source_Code_2" id="Final_Source_Code_2"></a></p>
<h4><span class="mw-headline">Final Source Code</span></h4>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="co1">//=============================================================================</span>
<span class="co1">// NaliCowPoop.</span>
<span class="co1">// The effects result of the NaliCow Poop behavior.</span>
<span class="co1">// by SuperApe -- Dec 2005</span>
<span class="co1">//=============================================================================</span>
<span class="kw5">class</span> NaliCowPoop <span class="kw5">extends</span> BioGlob;
 
<span class="kw5">function</span> PostBeginPlay<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw6">Super</span>.<span class="me1">PostBeginPlay</span><span class="br0">(</span><span class="br0">)</span>;
 
        Velocity = <span class="kw4">vect</span><span class="br0">(</span><span class="nu0">0</span>,<span class="nu0">0</span>,<span class="nu0">0</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// BlowUp() is originally defined in BioGlob.</span>
<span class="kw5">function</span> BlowUp<span class="br0">(</span> <span class="kw4">vector</span> HitLocation <span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Shriveling'</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw1">defaultProperties</span>
<span class="br0">{</span>
        Skins<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<a href="/Texture"><span class="kw10">Texture</span></a><span class="st0">'XEffectMat.goop.SlimeSkin'</span>
        AmbientGlow=<span class="nu0">0</span>
        bUnlit=<span class="kw9">false</span>
        bDynamicLight=<span class="kw9">false</span>
        LightType=LT_None
        RestTime=<span class="nu0">10.0</span>
        BaseDamage=<span class="nu0">0</span>
<span class="br0">}</span>
</pre></div>
<p><a name="Testing_and_Implementation" id="Testing_and_Implementation"></a></p>
<h2><span class="mw-headline">Testing and Implementation</span></h2>
<p>The new NPC character should be tested thoroughly to ensure it is behaving reliably both as a character and as a game object.</p>
<p><a name="Compiling" id="Compiling"></a></p>
<h3><span class="mw-headline">Compiling</span></h3>
<p>If you're familiar with <a href="../../../../articles/c/o/m/Legacy%7ECompiling_With_UCC_0337.html" title="Legacy:Compiling With UCC">Compiling With UCC</a>, then you can skip this section.</p>
<p>The steps for compiling our NPC code are as follows:</p>
<ol>
<li>Find your UT2004 base directory. This is usually <tt>C:/UT2004/</tt>. We will refer to this as <tt>.../UT2004/</tt> from this point on.</li>
<li>Create a subdirectory there for our NaliCow code, <tt>.../UT2004/NaliCow/</tt>, and create a subdirectory within that for our Classes, <tt>.../UT2004/NaliCow/Classes</tt></li>
<li>Within that Classes subdirectory, create a simple (text) file with a .uc extention called, "NaliCow.uc", and another called, "NaliCowPoop.uc".</li>
<li>Copy the above final source code for the NaliCow and paste it into the .uc file. Do the same for the NaliCowPoop code.</li>
<li>Find your <tt>.../UT2004/System/UT2004.ini</tt> file and edit it with a text editor. Find the <tt>EditPackages=</tt> block and add <tt>EditPackages=NaliCow</tt> to the end of the block. This will make sure the compiling application knows which subdirectory to look for things to compile.</li>
<li>In Windows, use StartMenu -&gt; Run... to launch <tt>.../UT2004/System/ucc make</tt>.</li>
<li>If there were no errors, you will now have a <tt>.../UT2004/System/NaliCow.u</tt> package file. (Note that to <i>re-compile</i> a package, you must remove it from the <tt>.../UT2004/System/</tt> subdirectory, or else the compiling application will skip it.)</li>
<li>If there were errors, they are in the ucc log file, <tt>.../UT2004/System/ucc.txt</tt>, and will tell you which line number the error came from.</li>
</ol>
<p><a name="Implementation" id="Implementation"></a></p>
<h3><span class="mw-headline">Implementation</span></h3>
<p>Now, we will bring our NPC into the game environment to test and debug.</p>
<ol>
<li>Within Ued, open a map suitable for testing our NPC.</li>
<li>In the <a href="../../../../articles/a/c/t/Legacy%7EActor_Browser_2eb9.html" class="mw-redirect" title="Legacy:Actor Browser">Actor Browser</a>, go to File -&gt; Open... and select our <tt>NaliCow.u</tt> package file.</li>
<li>Add an Actor -&gt; Pawn -&gt; NaliCow to the map.</li>
<li>Configure the desired properties, if any.</li>
<li>Hit the Playtest ("Joystick") button on the <a href="../../../../articles/t/o/o/Legacy%7EToolbar_96d5.html" title="Legacy:Toolbar">Toolbar</a>.</li>
</ol>
<p>Now you have the ability to test it's behaviors under a variety of situations. This is a good idea to do with any new AI construct. Be vigilant and thorough in your testing to find all the possible bugs.</p>
<p>Some helpful <a href="../../../../articles/c/o/n/Legacy%7EConsole_Commands_af01.html" title="Legacy:Console Commands">Console Commands</a> to use during testing are:</p>
<dl>
<dt>summon NaliCow.NaliCow&#160;</dt>
<dd>This spawns a default NaliCow, placed directly in front of your view.</dd>
<dt>addbots &lt;int NumberOfBots&gt;&#160;</dt>
<dd>This adds bots to the map.</dd>
<dt>killall &lt;class KillClass&gt;&#160;</dt>
<dd>This destroys all objects of the given KillClass.</dd>
<dt>allweapons&#160;</dt>
<dd>Gives all weapons and default ammo.</dd>
<dt>map &lt;name MapName&gt;&#160;</dt>
<dd>Starts a new match within the MapName provided. Note that <b>map autoplay</b> will re-start the current map within Ued's memory.</dd>
</dl>
<p><a name="Replication" id="Replication"></a></p>
<h3><span class="mw-headline">Replication</span></h3>
<p>If you know how to <a href="../../../../articles/l/a/u/Legacy%7ELaunch_A_Local_Netgame_df6b.html" title="Legacy:Launch A Local Netgame">Launch a Local Netgame</a>, you may skip this section.</p>
<p>Testing Replication is important to ensure that what you have made offline will work just as well online.</p>
<ol>
<li>Save a map with at least a few NaliCows in it, different settings, etc. Save it to the <tt>.../UT2004/Maps/</tt> subdirectory with a valid <a href="../../../../articles/m/a/p/Legacy%7EMap_File_Prefix_a7b0.html" title="Legacy:Map File Prefix">Map File Prefix</a>.</li>
<li>Launch UT2004 and Host a game. Pick your custom map and click on <b>Dedicated</b>. The menu window will disappear and a server log window will open as the game launches in the background.</li>
<li>Launch UT2004 again. Bring down the console and type, <tt>map 127.0.0.1</tt>, to join the local server you just started.</li>
<li>Once there for the first time, bring up the menu by hitting Esc and save this local server as one of your "Favs" for easier Joining in the future.</li>
</ol>
<p>Now, you're seeing what a slow Dial-Up client player sees. There will be some lag due to your machine handling both the Server and Client at the same time. However, this is important to see what imformation is being Replicated properly and what isn't.</p>
<p>For pinpointing the problems, it's useful to use Logs to be called either on the DedicatedServer or not. See also <a href="../../../../articles/n/e/t/Legacy%7ENetcode_Idioms_42a0.html" title="Legacy:Netcode Idioms">Netcode Idioms</a>. The Logs are found at <tt>.../UT2004/System/Server.txt</tt> for the Server and <tt>.../UT2004/System/UT2004.txt</tt> for the Client.</p>
<p><a name="Further_Development" id="Further_Development"></a></p>
<h2><span class="mw-headline">Further Development</span></h2>
<p>Beyond this basic NaliCow NPC, more can be done to improve behavior, realism, gameplay or ease of use.</p>
<p><a name="DrawScale_Adjustments" id="DrawScale_Adjustments"></a></p>
<h3><span class="mw-headline">DrawScale Adjustments</span></h3>
<p>Based on the DrawScale property, several adjustments can be made during PostBeginPlay() to make sure the NaliCow behaves, moves and sounds properly. The result is a simple one-property adjustment that can be made to make a small, fast baby cow or a big, slow older cow. We will use a separate function that can be called from PostBeginPlay(), AdjustForSize(). Before the adjustments are made, we can make sure the DrawScale is within a reasonable size range.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="co1">// PostBeginPlay() is originally defined in Actor().</span>
<span class="co1">// We will use it to make sure an AIController is spawned for our NaliCow.</span>
<span class="kw5">event</span> PostBeginPlay<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw6">Super</span>.<span class="me1">PostBeginPlay</span><span class="br0">(</span><span class="br0">)</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> <span class="br0">(</span> ControllerClass != <span class="kw9">None</span> <span class="br0">)</span> &amp;&amp; <span class="br0">(</span> Controller == <span class="kw9">None</span> <span class="br0">)</span> <span class="br0">)</span>
                Controller = spawn<span class="br0">(</span> ControllerClass <span class="br0">)</span>;
        <span class="kw1">if</span> <span class="br0">(</span> Controller != <span class="kw9">None</span> <span class="br0">)</span>
                Controller.<span class="me1">Possess</span><span class="br0">(</span> <span class="kw8">self</span> <span class="br0">)</span>;
 
        AdjustForSize<span class="br0">(</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// AdjustForSize() will make various adjustments according to DrawScale.</span>
<span class="kw5">function</span> AdjustForSize<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span> DrawScale &gt; <span class="nu0">3.0</span> || DrawScale &lt; <span class="nu0">0.5</span> <span class="br0">)</span>
                SetDrawScale<span class="br0">(</span> <span class="kw7">FClamp</span><span class="br0">(</span> DrawScale, <span class="nu0">3.0</span>, <span class="nu0">0.5</span> <span class="br0">)</span> <span class="br0">)</span>;
        SetCollisionSize<span class="br0">(</span> <span class="nu0">34</span> * DrawScale, <span class="nu0">34</span> * DrawScale <span class="br0">)</span>;
        Mass = <span class="nu0">100</span> * DrawScale;
        Health = <span class="nu0">100</span> * DrawScale;
        SoundRadius = <span class="nu0">512</span> * DrawScale;
        SoundPitch = <span class="nu0">128</span> / DrawScale;
        <span class="kw1">if</span> <span class="br0">(</span> DrawScale &gt; <span class="nu0">1.5</span> <span class="br0">)</span>
                bCanBeBaseForPawns = <span class="kw9">true</span>;
<span class="br0">}</span>
</pre></div>
<p>Other functions and elements will also have to be changed based on DrawScale. Changes to the AnimationRate, RotationRate, SoundVolume, SoundPitch, NaliCowPoop DrawScale and RestTime, etc. can all be made to reflect the size of the NaliCow. For example, the Acting() function can be altered to look like this:</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="co1">// Acting() loops the given animation sequence name and plays the given sound.</span>
<span class="co1">// For Replication purposes, animation is normally looped.  Sequences may be interupted each AnimEnd().</span>
<span class="kw5">function</span> Acting<span class="br0">(</span> <span class="kw4">name</span> Anim, <a href="/sound"><span class="kw10">sound</span></a> Soundname, <span class="kw4">bool</span> bLoop <span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">if</span> <span class="br0">(</span> bLoop <span class="br0">)</span>
        LoopAnim<span class="br0">(</span> Anim, <span class="br0">(</span> <span class="nu0">1.0</span> / DrawScale <span class="br0">)</span>, <span class="br0">(</span> <span class="nu0">1.0</span> / DrawScale <span class="br0">)</span>/<span class="nu0">10</span> <span class="br0">)</span>;
    <span class="kw1">else</span>
                PlayAnim<span class="br0">(</span> Anim, <span class="br0">(</span> <span class="nu0">1.0</span> / DrawScale <span class="br0">)</span>, <span class="br0">(</span> <span class="nu0">1.0</span> / DrawScale <span class="br0">)</span>/<span class="nu0">10</span> <span class="br0">)</span>;
    SimAnim.<span class="me1">AnimSequence</span> = Anim;
    SimAnim.<span class="me1">AnimRate</span> = <span class="br0">(</span> <span class="nu0">1.0</span> / DrawScale <span class="br0">)</span>;
    <span class="kw1">if</span> <span class="br0">(</span> bLoop <span class="br0">)</span>
        SimAnim.<span class="me1">bAnimLoop</span> = <span class="kw9">true</span>;
    <span class="kw1">else</span>
        SimAnim.<span class="me1">bAnimLoop</span> = <span class="kw9">false</span>;
        SimAnim.<span class="me1">TweenRate</span> = <span class="br0">(</span> <span class="nu0">1.0</span> / DrawScale <span class="br0">)</span>/<span class="nu0">10</span>;
    PlaySound<span class="br0">(</span> Soundname, SLOT_Misc, <span class="br0">(</span> DrawScale * <span class="nu0">2</span> <span class="br0">)</span>,,, <span class="br0">(</span> SoundPitch / <span class="nu0">128</span> <span class="br0">)</span> <span class="br0">)</span>;
<span class="br0">}</span>
</pre></div>
<p><a name="Cow_and_Baby_Relationships" id="Cow_and_Baby_Relationships"></a></p>
<h3><span class="mw-headline">Cow and Baby Relationships</span></h3>
<p>The original <a href="../../../../articles/c/o/w/Legacy%7ECow_6533.html" title="Legacy:Cow">Cow</a> and BabyCow UT creatures had properties to define their relationships. These can be reproduced with our NaliCow to perform the same behaviors.</p>
<p><a name="bHasBaby_and_BabyCow" id="bHasBaby_and_BabyCow"></a></p>
<h4><span class="mw-headline">bHasBaby and BabyCow</span></h4>
<p>In UT, the property bHasBaby was meant to automatically spawn a BabyCow (a smaller version) for this Cow. BabyCows were not meant to be explicitly placed in maps. A simple modification to PostBeginPlay() should allow us to use our new DrawScale adjustments to do this easily.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>                <span class="kw4">bool</span>           bHasBaby;               <span class="co1">// This NaliCow will spawn a smaller "Baby" at map start.</span>
<span class="kw5">var</span>            NaliCow         Mama;                   <span class="co1">// This NaliCow is a "Baby" and should stay close to "Mama".</span>
 
<span class="kw5">event</span> PostBeginPlay<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw5">local</span>  NaliCow         Baby;
 
        <span class="kw6">Super</span>.<span class="me1">PostBeginPlay</span><span class="br0">(</span><span class="br0">)</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> <span class="br0">(</span> ControllerClass != <span class="kw9">None</span> <span class="br0">)</span> &amp;&amp; <span class="br0">(</span> Controller == <span class="kw9">None</span> <span class="br0">)</span> <span class="br0">)</span>
                Controller = spawn<span class="br0">(</span> ControllerClass <span class="br0">)</span>;
        <span class="kw1">if</span> <span class="br0">(</span> Controller != <span class="kw9">None</span> <span class="br0">)</span>
                Controller.<span class="me1">Possess</span><span class="br0">(</span> <span class="kw8">self</span> <span class="br0">)</span>;
 
        AdjustForSize<span class="br0">(</span><span class="br0">)</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> bHasBaby <span class="br0">)</span>
                <span class="kw1">while</span> <span class="br0">(</span> Baby == <span class="kw9">None</span> <span class="br0">)</span>
                <span class="br0">{</span>
                        Baby = spawn<span class="br0">(</span> <span class="kw5">class</span><span class="st0">'NaliCow'</span>, <span class="kw8">self</span>,, Location + <span class="br0">(</span> VRand<span class="br0">(</span><span class="br0">)</span> * <span class="br0">(</span> <span class="nu0">64</span> + CollisionRadius <span class="br0">)</span> <span class="br0">)</span>, Rotation <span class="br0">)</span>;
                        <span class="kw1">if</span> <span class="br0">(</span> Baby != <span class="kw9">None</span> <span class="br0">)</span>
                        <span class="br0">{</span>
                                Baby.<span class="me1">Mama</span> = <span class="kw8">self</span>;
                                Baby.<span class="me1">SetDrawScale</span><span class="br0">(</span> DrawScale / <span class="nu0">2</span> <span class="br0">)</span>;
                                Baby.<span class="me1">AdjustForSize</span><span class="br0">(</span><span class="br0">)</span>;
                        <span class="br0">}</span>
                <span class="br0">}</span>
<span class="br0">}</span>
</pre></div>
<p>Also, we should encourage the BabyCow to stay close to its "Mama". We will do this with a modification to ReachedDestination(). The following code will be added to ReachedDestination() just before NewTarget is assigned to the Controller attributes.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw1">if</span> <span class="br0">(</span> Mama != <span class="kw9">None</span> <span class="br0">)</span>
                NewTarget = Mama;
</pre></div>
<p><a name="bStayClose_and_WanderRadius" id="bStayClose_and_WanderRadius"></a></p>
<h4><span class="mw-headline">bStayClose and WanderRadius</span></h4>
<p>bStayClose modified the behavior of the Cow so that it's Movement destinations were never more than WanderRadius UU away from it's starting Location. <i>Note: Although there is a <b>home</b> property defined in Controller, it is defined as a NavigationPoint and won't serve this purpose.</i></p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>                <span class="kw4">bool</span>           bStayClose;             <span class="co1">// This NaliCow will only select MoveTargets within WanderRadius.</span>
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>                <span class="kw4">int</span>            WanderRadius;   <span class="co1">// The radius from Home that MoveTargets will be selected.</span>
<span class="kw5">var</span>            <span class="kw4">vector</span>         Home;                   <span class="co1">// The Location this NaliCow started at.</span>
</pre></div>
<p>And the following code will be added to the end of ReachedDestination().</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw1">if</span> <span class="br0">(</span> bStayClose &amp;&amp; WanderRadius &gt; <span class="nu0">0</span> &amp;&amp; 
                <span class="br0">(</span> VSize<span class="br0">(</span> NewTarget.<span class="me1">Location</span> - Home <span class="br0">)</span> &gt; WanderRadius || 
                        VSize<span class="br0">(</span> Controller.<span class="me1">Destination</span> - Home <span class="br0">)</span> &gt; WanderRadius <span class="br0">)</span> <span class="br0">)</span>
        <span class="br0">{</span>
                Controller.<span class="me1">Destination</span> = Home + <span class="br0">(</span> VRand<span class="br0">(</span><span class="br0">)</span> * <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> * WanderRadius <span class="br0">)</span> <span class="br0">)</span>;
                Controller.<span class="me1">FocalPoint</span> = Controller.<span class="me1">Destination</span>;
        <span class="br0">}</span>
</pre></div>
<p><a name="Ridable_NaliCows" id="Ridable_NaliCows"></a></p>
<h3><span class="mw-headline">Ridable NaliCows</span></h3>
<p>An extra gameplay feature could be to have players be able to ride and loosely steer larger NaliCows. You may have noticed the <tt>bCanBeBaseForPawns</tt> property set during AdjustForSize() in the section above. This will allow larger cows to support and carry Pawns. Once a player has managed to get on top of one, a simple UsedBy() function can enable them to press Use and become a special Pawn to the NaliCow.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw5">var</span>            <a href="/Pawn"><span class="kw10">Pawn</span></a>              Rider;                  <span class="co1">// PlayerPawn riding this cow.</span>
 
<span class="co1">// UsedBy() is originally defined in Actor.</span>
<span class="kw5">function</span> UsedBy<span class="br0">(</span> <a href="/Pawn"><span class="kw10">Pawn</span></a> P <span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span> !bCanBeBaseForPawns <span class="br0">)</span>
                <span class="kw1">return</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> Rider == <span class="kw9">None</span> <span class="br0">)</span>
        <span class="br0">{</span>
                Rider = P;
                <span class="kw1">if</span> <span class="br0">(</span> PlayerController<span class="br0">(</span> Rider.<span class="me1">Controller</span> <span class="br0">)</span> != <span class="kw9">None</span> <span class="br0">)</span>
                        PlayerController<span class="br0">(</span> Rider.<span class="me1">Controller</span> <span class="br0">)</span>.<span class="me1">bBehindView</span> = <span class="kw9">true</span>;
        <span class="br0">}</span>
 
        <span class="kw1">if</span> <span class="br0">(</span> P == Rider <span class="br0">)</span>
        <span class="br0">{</span>
                Controller.<span class="me1">Destination</span> = Location + <span class="br0">(</span> <span class="kw4">vector</span><span class="br0">(</span> rot<span class="br0">(</span><span class="nu0">0</span>,<span class="nu0">1</span>,<span class="nu0">0</span><span class="br0">)</span> * Rider.<span class="me1">Controller</span>.<span class="me1">Rotation</span>.<span class="me1">Yaw</span> <span class="br0">)</span> * <span class="nu0">1024</span> <span class="br0">)</span>;
                Controller.<span class="me1">FocalPoint</span> = Controller.<span class="me1">Destination</span>;
                <span class="kw1">if</span> <span class="br0">(</span> !<span class="kw8">self</span>.<span class="kw7">IsInState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span> <span class="br0">)</span>
                        <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Run'</span><span class="br0">)</span>;
                <span class="kw1">else</span>
                        PlaySound<span class="br0">(</span> <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.injurC1c'</span>, SLOT_Misc, <span class="br0">(</span> DrawScale * <span class="nu0">2</span> <span class="br0">)</span>,,, <span class="br0">(</span> SoundPitch / <span class="nu0">128</span> <span class="br0">)</span> <span class="br0">)</span>;
        <span class="br0">}</span>
<span class="br0">}</span>
</pre></div>
<p>Once the player has become a Rider to the NaliCow, the NaliCow's Controller's Destinations are subject to the whims of the Rider.Controller. The Rider.Controller also is automatically set to bBehindView to give a visual cue that the change has taken place. By pressing the Use key, the NaliCow is urged to keep Running. When the NaliCow reaches it's Destinations, we'll keep the player in control by adding a little code to the top of ReachedDestination().</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="kw1">if</span> <span class="br0">(</span> Rider != <span class="kw9">None</span> <span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span> VSize<span class="br0">(</span> Rider.<span class="me1">Location</span> - Location <span class="br0">)</span> &gt; <span class="br0">(</span> CollisionHeight + Rider.<span class="me1">CollisionHeight</span> <span class="br0">)</span> <span class="br0">)</span>
        <span class="br0">{</span>
            <span class="kw1">if</span> <span class="br0">(</span> PlayerController<span class="br0">(</span> Rider.<span class="me1">Controller</span> <span class="br0">)</span> != <span class="kw9">None</span> <span class="br0">)</span>
                PlayerController<span class="br0">(</span> Rider.<span class="me1">Controller</span> <span class="br0">)</span>.<span class="me1">bBehindView</span> = <span class="kw9">false</span>;
            Rider = <span class="kw9">None</span>;  <span class="co1">// Rider has left.</span>
        <span class="br0">}</span>
        <span class="kw1">else</span>
        <span class="br0">{</span>
            Controller.<span class="me1">Destination</span> = Location + <span class="br0">(</span> <span class="kw4">vector</span><span class="br0">(</span> rot<span class="br0">(</span><span class="nu0">0</span>,<span class="nu0">1</span>,<span class="nu0">0</span><span class="br0">)</span> * Rider.<span class="me1">Controller</span>.<span class="me1">Rotation</span>.<span class="me1">Yaw</span> <span class="br0">)</span> * <span class="nu0">1024</span> <span class="br0">)</span>;
            Controller.<span class="me1">FocalPoint</span> = Controller.<span class="me1">Destination</span>;
            <span class="kw1">return</span> <span class="kw9">true</span>;
        <span class="br0">}</span>
    <span class="br0">}</span>
</pre></div>
<p>To stop being a Rider, the player can simply move off the NaliCow. The bBehindView setting will return after the NaliCow has reached it's next Destination.</p>
<p><a name="External_Links" id="External_Links"></a></p>
<h2><span class="mw-headline">External Links</span></h2>
<p>Other links to basic AI scripting tutorials should be listed here:</p>
<ul>
<li><a href="http://www.langsuyar.com/articles/u2_tutorialsmain.html" class="external text" title="http://www.langsuyar.com/articles/u2_tutorialsmain.html" rel="nofollow">Mattias Worch's Unreal 2 Tutorials</a> <b>(broken)</b>&#160;:</li>
</ul>
<dl>
<dd>Mattias Worch worked on the Unreal 2 team and has written a few useful tutorials on AI scripting. The tutorials on this page directly relating to AI scripting are "Set up Dialog and AI Scripting for a Level," and "Create a Basic AI Script." Please note that the copyright on these tutorials allows us to link to them, but not to "wikify" the tutorials and place them here. If you would like to have a tutorial on the Wiki, I'm sure that everyone would appreciate if someone were to read over these tutorials and experiment with AI scripting until they had a complete enough understanding to place an original tutorial here.</dd>
</dl>
<p><a name="Related_Topics" id="Related_Topics"></a></p>
<h2><span class="mw-headline">Related Topics</span></h2>
<ul>
<li><a href="../../../../articles/a/r/t/Legacy%7EArtificial_Intelligence_63c0.html" title="Legacy:Artificial Intelligence">Artificial Intelligence</a> – A super topic on all AI (bots, Monsters, NPCs, etc.)
<ul>
<li><a href="../../../../articles/b/o/t/Legacy%7EBot_Support_c519.html" title="Legacy:Bot Support">Bot Support</a></li>
<li><a href="../../../../articles/m/o/n/Legacy%7EMonster_Support_c874.html" title="Legacy:Monster Support">Monster Support</a></li>
<li><a href="../../../../articles/n/p/c/Legacy%7ENPC_Support_b02e.html" title="Legacy:NPC Support">NPC Support</a></li>
</ul>
</li>
<li><a href="../../../../articles/m/a/k/Legacy%7EMaking_Mods_187d.html" title="Legacy:Making Mods">Making Mods</a> and <a href="../../../../articles/m/u/t/Legacy%7EMutator_Topics_c760.html" title="Legacy:Mutator Topics">Mutator Topics</a></li>
<li><a href="../../../../articles/u/n/r/Legacy%7EUnrealScript_a9c5.html" title="Legacy:UnrealScript">UnrealScript</a></li>
</ul>
<p><a name="Discussion" id="Discussion"></a></p>
<h2><span class="mw-headline">Discussion</span></h2>
<p><b>Tarquin:</b> Link to documentation wiki pages, if they exist, or start writing them! That's a good way to start.</p>
<p><b>Foxpaw:</b> I actually don't have any experience with AI scripting myself, I was just using the random page function and thought this page could use a bit of refactoring.</p>
<p><b>SuperApe:</b> The above link is dead. Yes, we need links or some tuts on the wiki itself.</p>
<p><b>SuperApe:</b> I will most likely take over this page and revive it. Linking to <a href="../../../../articles/n/p/c/Legacy%7ENPC_Support_b02e.html" title="Legacy:NPC Support">NPC Support</a> and others. My thought is to take the Mesh for the NaliCow and re-construct it's AI coding as an NPC for UT2004. (I never had UT, so this will be a from scratch effort that I look forward to) Tutorial outlined. Working...</p>
<p><b>SuperApe:</b> This is a tutorial on UScripting a custom AI. Comments welcome.</p>
<p><b>Solid Snake:</b> Hmmm, I don't really like some of the code in here as I think it could be a lot better.</p>
<p><b>SuperApe:</b> I'll do my best to take that as constructive criticism, but it would really help if you could elaborate. I guess, <b>This page is under construction.</b></p>
<p><b>SuperApe:</b> After spending some time with <a href="../../../../articles/m/o/n/Legacy%7EMonster_d9bb.html" title="Legacy:Monster">Monsters</a>, I see a much easier way to do this. I will redo this tutorial, taking advantage of the all Pawn functions, instead of "re-inventing the wheel", like I do above. This will make sounds and animation play better. The code will be much smaller. However, I will need to build a custom Controller, as MonsterController does not have a "pacifist" setting.&#160;;) Other than that, it should be much more generalized and applicable to other people's projects. Working...</p>
<p><b>SuperApe:</b> Something like this, plus a new MonsterController to favor Wandering, avoid Hunting, Attacking, StakeOut, etc.</p>
<div dir="ltr" style="text-align: left;" class="highlighted-source">
<pre class="source-uscript">
<span class="co1">//=============================================================================</span>
<span class="co1">// NaliCow.</span>
<span class="co1">// Recreation of UT NaliCow.</span>
<span class="co1">// by SuperApe -- Jan 2006</span>
<span class="co1">//=============================================================================</span>
<span class="kw5">class</span> NaliCow <span class="kw5">extends</span> Monster
        <span class="kw6">placeable</span>;
 
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        <span class="kw4">bool</span>        bHasBaby;       <span class="co1">// Spawns a smaller "Baby" at map start.</span>
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        <span class="kw4">bool</span>        bStayClose;     <span class="co1">// Only select MoveTargets within WanderRadius.</span>
<span class="kw5">var</span><span class="br0">(</span><span class="br0">)</span>        <span class="kw4">int</span>         WanderRadius;   <span class="co1">// The radius from Home that MoveTargets will be selected.</span>
 
<span class="kw5">var</span>            <span class="kw4">name</span>           DeathAnim<span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span>;  <span class="co1">// Death animations.</span>
<span class="kw5">var</span>            <span class="kw4">name</span>           InjureAnim<span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span>;  <span class="co1">// Injury animations.</span>
 
<span class="kw5">var</span>            <span class="kw4">name</span>           IdleAnim<span class="br0">[</span><span class="nu0">6</span><span class="br0">]</span>;  <span class="co1">// Idle animations.</span>
<span class="kw5">var</span>            <a href="/sound"><span class="kw10">sound</span></a>            IdleSounds<span class="br0">[</span><span class="nu0">6</span><span class="br0">]</span>;  <span class="co1">// Idle sounds.</span>
 
<span class="kw5">function</span> PostBeginPlay<span class="br0">(</span><span class="br0">)</span>
 
<span class="br0">{</span>
        <span class="kw6">Super</span>.<span class="me1">PostBeginPlay</span><span class="br0">(</span><span class="br0">)</span>;
 
        <span class="co1">// FIXME: Make attitude ignore, friendly or fear players only.</span>
<span class="br0">}</span>
 
<span class="co1">// This stand-alone creature should avoid being placed in a roster.  Skip UnrealPawn's PostNetBeginPlay().</span>
<span class="kw6">simulated</span> <span class="kw5">function</span> PostBeginNetPlay<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        <span class="co1">// Do Pawn's PostNetBeginPlay()</span>
        <span class="kw5">local</span> playercontroller P;
 
        <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">Level</span>.<span class="me1">bDropDetail</span> || <span class="br0">(</span><span class="kw8">Level</span>.<span class="me1">DetailMode</span> == DM_Low<span class="br0">)</span> <span class="br0">)</span>
                MaxLights = <span class="kw7">Min</span><span class="br0">(</span><span class="nu0">4</span>,MaxLights<span class="br0">)</span>;
        <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">Role</span> == <span class="kw9">ROLE_Authority</span> <span class="br0">)</span>
                <span class="kw1">return</span>;
        <span class="kw1">if</span> <span class="br0">(</span> <span class="br0">(</span>Controller != <span class="kw9">None</span><span class="br0">)</span> &amp;&amp; <span class="br0">(</span>Controller.<a href="/Pawn"><span class="kw10">Pawn</span></a> == <span class="kw9">None</span><span class="br0">)</span> <span class="br0">)</span>
        <span class="br0">{</span>
                Controller.<a href="/Pawn"><span class="kw10">Pawn</span></a> = <span class="kw8">self</span>;
                <span class="kw1">if</span> <span class="br0">(</span> <span class="br0">(</span>PlayerController<span class="br0">(</span>Controller<span class="br0">)</span> != <span class="kw9">None</span><span class="br0">)</span>
                        &amp;&amp; <span class="br0">(</span>PlayerController<span class="br0">(</span>Controller<span class="br0">)</span>.<span class="me1">ViewTarget</span> == Controller<span class="br0">)</span> <span class="br0">)</span>
                        PlayerController<span class="br0">(</span>Controller<span class="br0">)</span>.<span class="me1">SetViewTarget</span><span class="br0">(</span><span class="kw8">self</span><span class="br0">)</span>;
        <span class="br0">}</span>
 
        <span class="kw1">if</span> <span class="br0">(</span> <span class="kw8">Role</span> == <span class="kw9">ROLE_AutonomousProxy</span> <span class="br0">)</span>
                bUpdateEyeHeight = <span class="kw9">true</span>;
 
        <span class="kw1">if</span> <span class="br0">(</span> <span class="br0">(</span>PlayerReplicationInfo != <span class="kw9">None</span><span class="br0">)</span>
                &amp;&amp; <span class="br0">(</span>PlayerReplicationInfo.<span class="me1">Owner</span> == <span class="kw9">None</span><span class="br0">)</span> <span class="br0">)</span>
        <span class="br0">{</span>
                PlayerReplicationInfo.<span class="me1">SetOwner</span><span class="br0">(</span>Controller<span class="br0">)</span>;
                <span class="kw1">if</span> <span class="br0">(</span> <span class="kw7">left</span><span class="br0">(</span>PlayerReplicationInfo.<span class="me1">PlayerName</span>, <span class="nu0">5</span><span class="br0">)</span> ~= <span class="st0">"PRESS"</span> <span class="br0">)</span>
                <span class="br0">{</span>
                        P = <span class="kw8">Level</span>.<span class="me1">GetLocalPlayerController</span><span class="br0">(</span><span class="br0">)</span>;
                        <span class="kw1">if</span> <span class="br0">(</span> <span class="br0">(</span>P.<span class="me1">PlayerReplicationInfo</span> != <span class="kw9">None</span><span class="br0">)</span> &amp;&amp; !<span class="br0">(</span><span class="kw7">left</span><span class="br0">(</span>PlayerReplicationInfo.<span class="me1">PlayerName</span>, <span class="nu0">5</span><span class="br0">)</span> ~= <span class="st0">"PRESS"</span><span class="br0">)</span> <span class="br0">)</span>
                                bScriptPostRender = <span class="kw9">true</span>;
                <span class="br0">}</span>
        <span class="br0">}</span>
        PlayWaiting<span class="br0">(</span><span class="br0">)</span>;
 
        <span class="co1">// Do xPawn's PostNetBeginPlay()</span>
        MultiJumpRemaining = MaxMultiJump;
        bCanDoubleJump = CanMultiJump<span class="br0">(</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw5">function</span> Step<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
        PlaySound<span class="br0">(</span><a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.WalkC'</span>, SLOT_Interact<span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw6">simulated</span> <span class="kw5">function</span> AnimEnd<span class="br0">(</span><span class="kw4">int</span> Channel<span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw5">local</span>  <span class="kw4">name</span>   Anim, <span class="kw6">New</span>;
        <span class="kw5">local</span>  <span class="kw4">float</span>  frame, rate;
        <span class="kw5">local</span>  <span class="kw4">int</span>            n;
        <span class="kw5">local</span>  BioGlob B;
 
    <span class="kw1">if</span><span class="br0">(</span> <span class="kw8">Level</span>.<span class="me1">TimeSeconds</span> - LastPainSound &lt; MinTimeBetweenPainSounds <span class="br0">)</span>
        <span class="kw1">return</span>;  <span class="co1">// Allow pain to play through.</span>
 
        <span class="kw1">if</span> <span class="br0">(</span> Channel == <span class="nu0">0</span> <span class="br0">)</span>
        <span class="br0">{</span>
                GetAnimParams<span class="br0">(</span><span class="nu0">0</span>, Anim,frame,rate<span class="br0">)</span>;
                <span class="kw1">if</span> <span class="br0">(</span> Anim == <span class="st0">'Swish'</span> || Anim == <span class="st0">'Shake'</span> || Anim == <span class="st0">'Poop'</span> <span class="br0">)</span>
                        n = <span class="kw4">int</span><span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> * <span class="nu0">6</span> <span class="br0">)</span>;          
                <span class="kw1">if</span> <span class="br0">(</span> <span class="br0">(</span> Anim != <span class="st0">'Breath'</span> || Anim != <span class="st0">'Chew'</span> <span class="br0">)</span> &amp;&amp; Anim == IdleAnim<span class="br0">[</span>n<span class="br0">]</span> <span class="br0">)</span>
                        n = <span class="kw4">int</span><span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> * <span class="nu0">6</span> <span class="br0">)</span>;
 
                <span class="kw1">if</span> <span class="br0">(</span> Anim == <span class="st0">'Poop'</span> <span class="br0">)</span>
                <span class="br0">{</span>
                        B = spawn<span class="br0">(</span> <span class="kw5">class</span><span class="st0">'BioGlob'</span>, <span class="kw8">self</span>,, Location - <span class="br0">(</span> <span class="kw4">vector</span><span class="br0">(</span> Rotation <span class="br0">)</span> * <span class="nu0">24</span> <span class="br0">)</span> <span class="br0">)</span>;
                        B.<span class="me1">Velocity</span> = <span class="kw4">vect</span><span class="br0">(</span><span class="nu0">0</span>,<span class="nu0">0</span>,<span class="nu0">0</span><span class="br0">)</span>;
                        B.<span class="me1">bDynamicLight</span> = <span class="kw9">false</span>;
                        B.<span class="me1">AmbientGlow</span> = <span class="nu0">0</span>;
                        B.<span class="me1">RestTime</span> *= <span class="nu0">2.0</span>;
                        B.<span class="me1">BaseDamage</span> = <span class="nu0">0</span>;
                        B.<span class="me1">Damage</span> = <span class="nu0">0</span>;
                        B.<span class="me1">Skins</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> = <a href="/Texture"><span class="kw10">Texture</span></a><span class="st0">'XEffectMat.goop.SlimeSkin'</span>;
                        <span class="kw1">if</span> <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0.5</span> <span class="br0">)</span>
                                IdleSounds<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span> = <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.cMoo1c'</span>;
                        <span class="kw1">else</span>
                                IdleSounds<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span> = <a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.cMoo2c'</span>;
                <span class="br0">}</span>
                <span class="kw1">if</span> <span class="br0">(</span> Anim == <span class="st0">'root'</span> <span class="br0">)</span>
                        n = <span class="nu0">2</span>;
                <span class="kw1">if</span> <span class="br0">(</span> <span class="kw7">FRand</span><span class="br0">(</span><span class="br0">)</span> &gt; <span class="nu0">0.8</span> <span class="br0">)</span>
                        n = <span class="nu0">0</span>;
 
                IdleWeaponAnim = IdleAnim<span class="br0">[</span>n<span class="br0">]</span>;
                PlayAnim<span class="br0">(</span> IdleAnim<span class="br0">[</span>n<span class="br0">]</span> <span class="br0">)</span>;
                PlaySound<span class="br0">(</span> IdleSounds<span class="br0">[</span>n<span class="br0">]</span> <span class="br0">)</span>;
        <span class="br0">}</span>
        <span class="kw6">Super</span>.<span class="me1">AnimEnd</span><span class="br0">(</span>Channel<span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw5">function</span> PlayTakeHit<span class="br0">(</span><span class="kw4">vector</span> HitLocation, <span class="kw4">int</span> Damage, class&lt;DamageType&gt; <a href="/DamageType"><span class="kw10">DamageType</span></a><span class="br0">)</span>
<span class="br0">{</span>
        <span class="kw5">local</span>  <span class="kw4">int</span>            i;
 
    <span class="kw1">if</span><span class="br0">(</span> <span class="kw8">Level</span>.<span class="me1">TimeSeconds</span> - LastPainSound &lt; MinTimeBetweenPainSounds <span class="br0">)</span>
        <span class="kw1">return</span>;
 
        i = <span class="kw7">Clamp</span><span class="br0">(</span> <span class="br0">(</span> Damage / <span class="nu0">15</span> <span class="br0">)</span>, <span class="nu0">0</span>, <span class="nu0">3</span> <span class="br0">)</span>;
        PlayAnim<span class="br0">(</span> InjureAnim<span class="br0">[</span>i<span class="br0">]</span> <span class="br0">)</span>;
 
    LastPainSound = <span class="kw8">Level</span>.<span class="me1">TimeSeconds</span>;
        <span class="kw1">if</span> <span class="br0">(</span> i == <span class="nu0">1</span> <span class="br0">)</span>
                PlaySound<span class="br0">(</span><a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.cMoo1c'</span>, SLOT_Pain, <span class="nu0">2</span>*TransientSoundVolume,, <span class="nu0">200</span><span class="br0">)</span>;
        <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span> i == <span class="nu0">2</span> <span class="br0">)</span>
                PlaySound<span class="br0">(</span><a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.injurC1c'</span>, SLOT_Pain, <span class="nu0">2</span>*TransientSoundVolume,, <span class="nu0">200</span><span class="br0">)</span>;
        <span class="kw1">else</span>
                PlaySound<span class="br0">(</span><a href="/sound"><span class="kw10">sound</span></a><span class="st0">'SkaarjPack_rc.injurC2c'</span>, SLOT_Pain, <span class="nu0">2</span>*TransientSoundVolume,, <span class="nu0">200</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw6">simulated</span> <span class="kw5">function</span> PlayDying<span class="br0">(</span>class&lt;DamageType&gt; <a href="/DamageType"><span class="kw10">DamageType</span></a>, <span class="kw4">vector</span> HitLoc<span class="br0">)</span>
<span class="br0">{</span>
        AmbientSound = <span class="kw9">None</span>;
    bCanTeleport = <span class="kw9">false</span>; 
    bReplicateMovement = <span class="kw9">false</span>;
    bTearOff = <span class="kw9">true</span>;
    bPlayedDeath = <span class="kw9">true</span>;
 
        HitDamageType = <a href="/DamageType"><span class="kw10">DamageType</span></a>; <span class="co1">// these are replicated to other clients</span>
    TakeHitLocation = HitLoc;
        LifeSpan = RagdollLifeSpan;
 
    <span class="kw7">GotoState</span><span class="br0">(</span><span class="st0">'Dying'</span><span class="br0">)</span>;
 
        Velocity += TearOffMomentum;
    BaseEyeHeight = <span class="kw1">Default</span>.<span class="me1">BaseEyeHeight</span>;
    SetPhysics<span class="br0">(</span>PHYS_Falling<span class="br0">)</span>;
 
        PlayAnim<span class="br0">(</span>DeathAnim<span class="br0">[</span><span class="kw7">Rand</span><span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span><span class="br0">]</span>,<span class="nu0">1.2</span>,<span class="nu0">0.05</span><span class="br0">)</span>;                
<span class="br0">}</span>
 
<span class="kw1">defaultproperties</span>
<span class="br0">{</span>
     DeathAnim<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Dead"</span>
     DeathAnim<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Dead2"</span>
     DeathAnim<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Dead3"</span>
     DeathAnim<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Dead3"</span>
     InjureAnim<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"TakeHit"</span>
     InjureAnim<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"TakeHit2"</span>
     InjureAnim<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"BigHit"</span>
     InjureAnim<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"BigHit"</span>
     IdleAnim<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Breath"</span>
     IdleAnim<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"root"</span>
     IdleAnim<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Chew"</span>
     IdleAnim<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Poop"</span>
     IdleAnim<span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span>=<span class="st0">"Shake"</span>
     IdleAnim<span class="br0">(</span><span class="nu0">5</span><span class="br0">)</span>=<span class="st0">"Swish"</span>
     IdleSounds<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<a href="/sound"><span class="kw10">Sound</span></a><span class="st0">'SkaarjPack_rc.Cow.ambCow'</span>
     IdleSounds<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<a href="/sound"><span class="kw10">Sound</span></a><span class="st0">'SkaarjPack_rc.Pupae.munch1p'</span>
     IdleSounds<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<a href="/sound"><span class="kw10">Sound</span></a><span class="st0">'SkaarjPack_rc.Pupae.munch1p'</span>
     IdleSounds<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<a href="/sound"><span class="kw10">Sound</span></a><span class="st0">'SkaarjPack_rc.Cow.cMoo2c'</span>
     IdleSounds<span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span>=<a href="/sound"><span class="kw10">Sound</span></a><span class="st0">'SkaarjPack_rc.Cow.shakeC'</span>
     IdleSounds<span class="br0">(</span><span class="nu0">5</span><span class="br0">)</span>=<a href="/sound"><span class="kw10">Sound</span></a><span class="st0">'SkaarjPack_rc.Cow.swishC'</span>
     StartingAnim=<span class="st0">"Breath"</span>
     bMeleeFighter=<span class="kw9">False</span>
     bCanDodge=<span class="kw9">False</span>
     HitSound<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<a href="/sound"><span class="kw10">Sound</span></a><span class="st0">'SkaarjPack_rc.Cow.injurC1c'</span>
     HitSound<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<a href="/sound"><span class="kw10">Sound</span></a><span class="st0">'SkaarjPack_rc.Cow.injurC2c'</span>
     HitSound<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<a href="/sound"><span class="kw10">Sound</span></a><span class="st0">'SkaarjPack_rc.Cow.injurC1c'</span>
     HitSound<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<a href="/sound"><span class="kw10">Sound</span></a><span class="st0">'SkaarjPack_rc.Cow.injurC2c'</span>
     DeathSound<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<a href="/sound"><span class="kw10">Sound</span></a><span class="st0">'SkaarjPack_rc.Cow.cMoo2c'</span>
     DeathSound<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<a href="/sound"><span class="kw10">Sound</span></a><span class="st0">'SkaarjPack_rc.Cow.DeathC1c'</span>
     DeathSound<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<a href="/sound"><span class="kw10">Sound</span></a><span class="st0">'SkaarjPack_rc.Cow.DeathC2c'</span>
     DeathSound<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<a href="/sound"><span class="kw10">Sound</span></a><span class="st0">'SkaarjPack_rc.Cow.DeathC2c'</span>
     bCanDodgeDoubleJump=<span class="kw9">False</span>
     WallDodgeAnims<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     WallDodgeAnims<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     WallDodgeAnims<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     WallDodgeAnims<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     IdleHeavyAnim=<span class="st0">"Breath"</span>
     IdleRifleAnim=<span class="st0">"Breath"</span>
     bCanJump=<span class="kw9">False</span>
     bCanClimbLadders=<span class="kw9">False</span>
     bCanStrafe=<span class="kw9">False</span>
     bCanDoubleJump=<span class="kw9">False</span>
     bCanUse=<span class="kw9">False</span>
     MeleeRange=<span class="nu0">80.000000</span>
     GroundSpeed=<span class="nu0">100.000000</span>
     WaterSpeed=<span class="nu0">75.000000</span>
     JumpZ=<span class="nu0">75.000000</span>
     ControllerClass=<span class="kw5">Class</span><span class="st0">'MonsterController'</span>
     MovementAnims<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Run"</span>
     MovementAnims<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Run"</span>
     MovementAnims<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Run"</span>
     MovementAnims<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Run"</span>
     TurnLeftAnim=<span class="st0">"Walk"</span>
     TurnRightAnim=<span class="st0">"Walk"</span>
     SwimAnims<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Run"</span>
     SwimAnims<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Run"</span>
     SwimAnims<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Run"</span>
     SwimAnims<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Run"</span>
     WalkAnims<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Walk"</span>
     WalkAnims<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Walk"</span>
     WalkAnims<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Walk"</span>
     WalkAnims<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Walk"</span>
     AirAnims<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     AirAnims<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     AirAnims<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     AirAnims<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     TakeoffAnims<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     TakeoffAnims<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     TakeoffAnims<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     TakeoffAnims<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     LandAnims<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     LandAnims<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     LandAnims<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     LandAnims<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     DoubleJumpAnims<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     DoubleJumpAnims<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     DoubleJumpAnims<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     DoubleJumpAnims<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     DodgeAnims<span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     DodgeAnims<span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     DodgeAnims<span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     DodgeAnims<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>=<span class="st0">"Landed"</span>
     AirStillAnim=<span class="st0">"Landed"</span>
     TakeoffStillAnim=<span class="st0">"Landed"</span>
     IdleCrouchAnim=<span class="st0">"Breath"</span>
     IdleSwimAnim=<span class="st0">"Walk"</span>
     IdleWeaponAnim=<span class="st0">"Breath"</span>
     IdleRestAnim=<span class="st0">"Breath"</span>
     Mesh=VertMesh<span class="st0">'SkaarjPack_rc.NaliCow'</span>
     PrePivot=<span class="br0">(</span>Z=<span class="nu0">0.000000</span><span class="br0">)</span>
     CollisionRadius=<span class="nu0">34.000000</span>
     CollisionHeight=<span class="nu0">34.000000</span>
<span class="br0">}</span>
</pre></div>

<!-- 
NewPP limit report
Preprocessor node count: 141/1000000
Post-expand include size: 27/2097152 bytes
Template argument size: 0/2097152 bytes
#ifexist count: 0/100
-->
<div class="printfooter">
</div>
	    <div id="catlinks"><p class='catlinks'><a href="../../../../articles/c/a/t/Special%7ECategories_101d.html" title="Special:Categories">Category</a>: <span dir='ltr'><a href="../../../../articles/l/e/g/Category%7ELegacy_Tutorial_261e.html" title="Category:Legacy Tutorial">Legacy Tutorial</a></span></p></div>	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-legacy"
	       class="selected"	       ><a href="../../../../articles/b/a/s/Legacy%7EBasic_AI_Scripting_Tutorial_74ba.html">Legacy</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../../articles/b/a/s/Legacy_talk%7EBasic_AI_Scripting_Tutorial_6fb9.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://wiki.beyondunreal.com/Legacy:Basic_AI_Scripting_Tutorial">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../../misc/uewiki.png);"
	    href="../../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-mainpage"><a href="../../../../index.html">Main Page</a></li>
	     	      <li id="n-portal"><a href="../../../../articles/c/o/m/Unreal_Wiki%7ECommunity_Portal_3311.html">Community portal</a></li>
	     	      <li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>	<div id="f-copyrightico"><a href="../../../../../COPYING.html"><img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" alt='Attribution-Noncommercial-Share Alike 3.0' /></a></div>	<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 03:20, 4 February 2006 by Anonymous user(s) of Unreal Wiki. </li>	  <li id="f-copyright">Licensed as <a href="../../../../articles/c/o/p/Unreal_Wiki%7ECopyrights_e561.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>	  <li id="f-about"><a href="../../../../articles/a/b/o/Unreal_Wiki%7EAbout_9ce6.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>	  <li id="f-disclaimer"><a href="../../../../articles/g/e/n/Unreal_Wiki%7EGeneral_disclaimer_a0a2.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
